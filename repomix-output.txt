This file is a merged representation of the entire codebase, combining all repository files into a single document.
Generated by Repomix on: 2024-12-11T18:15:36.963Z

================================================================
File Summary
================================================================

Purpose:
--------
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.

File Format:
------------
The content is organized as follows:
1. This summary section
2. Repository information
3. Repository structure
4. Multiple file entries, each consisting of:
  a. A separator line (================)
  b. The file path (File: path/to/file)
  c. Another separator line
  d. The full contents of the file
  e. A blank line

Usage Guidelines:
-----------------
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.

Notes:
------
- Some files may have been excluded based on .gitignore rules and Repomix's
  configuration.
- Binary files are not included in this packed representation. Please refer to
  the Repository Structure section for a complete list of file paths, including
  binary files.

Additional Info:
----------------

For more information about Repomix, visit: https://github.com/yamadashy/repomix

================================================================
Repository Structure
================================================================
app/
  admin/
    auth/
      login/
        page.tsx
      layout.tsx
    charter-editor/
      components/
        controls/
          ChartControls.tsx
          EditorToolbar.tsx
          MarketingControls.tsx
        editors/
          BaggageInfoEditor.tsx
          InfoEditor.tsx
          PriceEditor.tsx
        sheets/
          PriceSheet.tsx
        ui/
          button.tsx
          card.tsx
          ConfirmationDialog.tsx
          input.tsx
          label.tsx
          PriceDisplay.tsx
          select.tsx
          textarea.tsx
          TimeSelector.tsx
          toast.tsx
      constants/
        defaults.ts
      data/
        airportCodes.ts
        charterData.ts
      lib/
        utils.ts
      styles/
        globals.css
      types/
        index.ts
      utils/
        storage.ts
    components/
      ui/
        button.tsx
        card.tsx
        index.ts
        input.tsx
        label.tsx
        select.tsx
        textarea.tsx
        toast.tsx
      widget-editors/
        AnnouncementEditor.tsx
        PriceChartEditor.tsx
        PromotionImageEditor.tsx
      AnnouncementsManager.tsx
      ChartersManager.tsx
      DashboardStats.tsx
      FlightTabsManager.tsx
      PromotionsMagager.tsx
      ServicesManager.tsx
      TabContentEditor.tsx
      WidgetEditor.tsx
    dashboard/
      page.tsx
    layout.tsx
    page.tsx
  components/
    flight-section/
      Announcements.tsx
      FlightTabContent.tsx
      PriceChart.tsx
    flights/
      DestinationTabs.tsx
      FlightTabContent.tsx
      PriceDisplay.tsx
    layout/
      Footer.tsx
      Header.tsx
    services/
      ServiceTabs.tsx
    ui/
      button.tsx
      toast.tsx
    widgets/
      AnnouncementCard.tsx
      PriceChart.tsx
      PromotionCard.tsx
    DestinationTabs.tsx
    FlightCard.tsx
    FlightFilters.tsx
    FlightSearch.tsx
    FlightSort.tsx
    Navigation.tsx
    ServiceTabs.tsx
  dashboard/
    page.tsx
  login/
    page.tsx
  search/
    page.tsx
  signup/
    page.tsx
  globals.css
  layout.tsx
  page.tsx
backup-repo.git/
  hooks/
    applypatch-msg.sample
    commit-msg.sample
    fsmonitor-watchman.sample
    post-update.sample
    pre-applypatch.sample
    pre-commit.sample
    pre-merge-commit.sample
    pre-push.sample
    pre-rebase.sample
    pre-receive.sample
    prepare-commit-msg.sample
    push-to-checkout.sample
    update.sample
  info/
    exclude
  config
  description
  HEAD
  packed-refs
constants/
  defaults.ts
contexts/
  AuthContext.tsx
data/
  airportCodes.ts
  charterData.ts
functions/
  .eslintrc.js
  .gitignore
  .prettierrc
  index.js
  package.json
hooks/
  useAuth.ts
lib/
  config/
    xael-config.ts
  services/
    sessionService.ts
    xael-service.ts
  firebase.ts
  firebaseAdmin.ts
  firebaseConfig.ts
  firestore-setup.ts
  firestore-utils.ts
  flight-service.ts
  utils.ts
  verifyToken.js
public/
  file.svg
  globe.svg
  next.svg
  vercel.svg
  window.svg
scripts/
  init-firestore.js
  init-firestore.ts
  set-admin.ts
types/
  admin.ts
  charter.ts
  dashboard.ts
  firebase.ts
  flight.ts
  index.ts
.eslintrc.json
.firebaserc
.gitignore
.prettierrc
commands.txt
firebase.json
firestore.rules
middleware.ts
next.config.js
next.config.ts
package.json
postcss.config.js
postcss.config.mjs
README.md
setCustomClaims.js
tailwind.config.js
tailwind.config.ts
tsconfig.json

================================================================
Repository Files
================================================================

================
File: app/admin/auth/login/page.tsx
================
'use client'

import { useState } from 'react'
import { useRouter } from 'next/navigation'
import { signInWithEmailAndPassword } from 'firebase/auth'
import { auth } from '@/lib/firebaseConfig'
import { SessionService } from '@/lib/services/sessionService'
import Link from 'next/link'

const LOGIN_ATTEMPTS_KEY = 'loginAttempts'
const MAX_LOGIN_ATTEMPTS = 5
const LOCKOUT_DURATION = 15 * 60 * 1000 // 15 minutes

export default function AdminLoginPage() {
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [error, setError] = useState('')
  const [loading, setLoading] = useState(false)
  const router = useRouter()
  const sessionService = SessionService.getInstance()

  const checkLoginAttempts = (): boolean => {
    const attempts = JSON.parse(
      localStorage.getItem(LOGIN_ATTEMPTS_KEY) || '{"count": 0}'
    )
    const now = Date.now()

    if (attempts.lockUntil && now < attempts.lockUntil) {
      const remainingMinutes = Math.ceil((attempts.lockUntil - now) / 60000)
      setError(
        `Too many failed attempts. Please try again in ${remainingMinutes} minutes.`
      )
      return false
    }

    if (attempts.lockUntil && now >= attempts.lockUntil) {
      // Reset if lockout period is over
      localStorage.setItem(LOGIN_ATTEMPTS_KEY, JSON.stringify({ count: 0 }))
      return true
    }

    return attempts.count < MAX_LOGIN_ATTEMPTS
  }

  const updateLoginAttempts = (success: boolean) => {
    const attempts = JSON.parse(
      localStorage.getItem(LOGIN_ATTEMPTS_KEY) || '{"count": 0}'
    )

    if (success) {
      localStorage.setItem(LOGIN_ATTEMPTS_KEY, JSON.stringify({ count: 0 }))
      return
    }

    const newCount = attempts.count + 1
    if (newCount >= MAX_LOGIN_ATTEMPTS) {
      localStorage.setItem(
        LOGIN_ATTEMPTS_KEY,
        JSON.stringify({
          count: newCount,
          lockUntil: Date.now() + LOCKOUT_DURATION,
        })
      )
    } else {
      localStorage.setItem(
        LOGIN_ATTEMPTS_KEY,
        JSON.stringify({ count: newCount })
      )
    }
  }

  const handleAdminLogin = async (e: React.FormEvent<HTMLFormElement>) => {
    e.preventDefault()

    if (!checkLoginAttempts()) {
      return
    }

    setLoading(true)
    setError('')

    try {
      const userCredential = await signInWithEmailAndPassword(
        auth,
        email,
        password
      )
      const idTokenResult = await userCredential.user.getIdTokenResult()

      // Check if user has admin claim
      if (!idTokenResult.claims.admin) {
        throw new Error('Access denied: Admin privileges required')
      }

      // Create session
      await sessionService.createSession(userCredential.user)

      updateLoginAttempts(true)
      router.push('/admin/dashboard')
    } catch (err: any) {
      updateLoginAttempts(false)
      if (err.message === 'Access denied: Admin privileges required') {
        setError('Access denied: Admin privileges required')
      } else {
        setError('Invalid email or password')
      }
      console.error('Login error:', err)
    } finally {
      setLoading(false)
    }
  }

  if (loading) {
    return (
      <div className="flex justify-center items-center min-h-screen bg-gradient-to-br from-indigo-600 to-purple-800">
        <div className="text-xl text-white">Loading...</div>
      </div>
    )
  }

  return (
    <div className="flex justify-center items-center min-h-screen bg-gradient-to-br from-indigo-600 to-purple-800">
      <div className="bg-white p-8 rounded-lg shadow-lg w-96">
        <Link
          href="/"
          className="block text-sm text-indigo-600 hover:underline mb-6"
        >
          ← Back to Home
        </Link>

        <h1 className="text-2xl font-bold mb-6 text-center text-gray-800">
          Admin Login
        </h1>

        <form onSubmit={handleAdminLogin} className="space-y-4">
          <div>
            <label
              htmlFor="email"
              className="block text-sm font-medium text-gray-700"
            >
              Email
            </label>
            <input
              type="email"
              id="email"
              value={email}
              onChange={(e) => setEmail(e.target.value)}
              className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
              required
            />
          </div>

          <div>
            <label
              htmlFor="password"
              className="block text-sm font-medium text-gray-700"
            >
              Password
            </label>
            <input
              type="password"
              id="password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
              className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
              required
            />
          </div>

          {error && <div className="text-red-500 text-sm mt-2">{error}</div>}

          <button
            type="submit"
            disabled={loading}
            className="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50"
          >
            {loading ? 'Logging in...' : 'Login'}
          </button>
        </form>

        <div className="mt-6 flex items-center justify-between">
          <Link
            href="/login"
            className="text-sm text-indigo-600 hover:underline"
          >
            Regular User Login
          </Link>
          <Link
            href="/contact"
            className="text-sm text-indigo-600 hover:underline"
          >
            Need Help?
          </Link>
        </div>

        <div className="mt-6 text-xs text-gray-500 text-center">
          This login is for administrators only. Multiple failed attempts will
          result in a temporary lockout. If you need access, please contact the
          system administrator.
        </div>
      </div>
    </div>
  )
}

================
File: app/admin/auth/layout.tsx
================
'use client'

export default function AdminAuthLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return <>{children}</>
}

================
File: app/admin/charter-editor/components/controls/ChartControls.tsx
================
// src/components/controls/ChartControls.tsx
import React from 'react'
import { Button } from '@/components/ui/button'
import { Input } from '@/components/ui/input'
import { Label } from '@/components/ui/label'
import { Card, CardContent } from '@/components/ui/card'
import { GlobalProfit } from '@/types'
import { FaSave, FaDownload } from 'react-icons/fa' // Import save and load icons

interface ChartControlsProps {
  onDownload: () => void
  onSave: () => void
  onLoad: () => void
  globalProfit: GlobalProfit
  onGlobalProfitChange: (profit: GlobalProfit) => void
}

const ChartControls: React.FC<ChartControlsProps> = ({
  onDownload,
  onSave,
  onLoad,
  globalProfit,
  onGlobalProfitChange,
}) => {
  const handleProfitChange = (type: keyof GlobalProfit, value: string) => {
    onGlobalProfitChange({
      ...globalProfit,
      [type]: parseFloat(value) || 0,
    })
  }

  return (
    <Card className="mb-4">
      <CardContent className="pt-6">
        {/* Added Section Header */}
        <h2 className="text-xl font-bold mb-4">Controles Generales</h2>
        <div className="grid grid-cols-2 gap-4 mb-4">
          <div>
            <Label htmlFor="globalProfitRT">Ganancia R/T ($)</Label>
            <Input
              id="globalProfitRT"
              type="number"
              value={globalProfit.rt}
              onChange={(e) => handleProfitChange('rt', e.target.value)}
              className="mt-1"
            />
          </div>
          <div>
            <Label htmlFor="globalProfitOW">Ganancia O/W ($)</Label>
            <Input
              id="globalProfitOW"
              type="number"
              value={globalProfit.ow}
              onChange={(e) => handleProfitChange('ow', e.target.value)}
              className="mt-1"
            />
          </div>
        </div>

        {/* Updated Buttons with Icons and Labels */}
        <div className="flex gap-2">
          <Button
            onClick={onDownload}
            className="flex-1 flex items-center justify-center"
            title="Descargar"
          >
            <FaDownload className="mr-2" />
          </Button>
          <Button
            onClick={onSave}
            variant="outline"
            className="flex-1 flex items-center justify-center"
            title="Guardar Datos"
          >
            <FaSave className="mr-2" />
          </Button>
          <Button
            onClick={onLoad}
            variant="outline"
            className="flex-1 flex items-center justify-center"
            title="Cargar Datos"
          >
            <FaDownload className="mr-2 transform rotate-180" />
          </Button>
        </div>
      </CardContent>
    </Card>
  )
}

export default ChartControls

================
File: app/admin/charter-editor/components/controls/EditorToolbar.tsx
================
// src/components/controls/EditorToolbar.tsx

import React, { useRef, useMemo } from 'react'
import { Button } from '@/components/ui/button'
import { Input } from '@/components/ui/input'
import { Label } from '@/components/ui/label'
import Select from '@/components/ui/select'
import PriceEditor from '../editors/PriceEditor'
import type { CharterData, GlobalProfit, DestinationData } from '@/types'
import { FaSave, FaDownload, FaUpload } from 'react-icons/fa'

interface EditorToolbarProps {
  charters: CharterData[]
  globalProfit: GlobalProfit
  onCharterUpdate: (charters: CharterData[]) => void
  onGlobalProfitChange: (profit: GlobalProfit) => void
  onDownload: () => void
  onSave: () => void
  onLoad: () => void
  onAgencyLogoChange: (logo: string) => void
  onPromotionalImageChange: (image: string) => void
  selectedDestination: string
  onDestinationChange: (destination: string) => void
  selectedCharterIndex: number
  onSelectCharter: (index: number) => void
}

const EditorToolbar: React.FC<EditorToolbarProps> = ({
  charters,
  globalProfit,
  onCharterUpdate,
  onGlobalProfitChange,
  onDownload,
  onSave,
  onLoad,
  onAgencyLogoChange,
  onPromotionalImageChange,
  selectedDestination,
  onDestinationChange,
  selectedCharterIndex,
  onSelectCharter,
}) => {
  const agencyLogoInputRef = useRef<HTMLInputElement>(null)
  const promotionalImageInputRef = useRef<HTMLInputElement>(null)

  // Get all unique destinations across all charters
  const allDestinations = useMemo(() => {
    const destinations = new Set<string>()
    charters.forEach((charter) => {
      charter.destinations.forEach((dest) => {
        destinations.add(dest.destination)
      })
    })
    return Array.from(destinations).sort((a, b) => {
      if (a === 'MIA-HAV') return -1
      if (b === 'MIA-HAV') return 1
      return a.localeCompare(b)
    })
  }, [charters])

  // Get available charters for selected destination
  const availableCharters = useMemo(() => {
    if (!selectedDestination) return []
    return charters.filter((charter) =>
      charter.destinations.some(
        (dest) => dest.destination === selectedDestination
      )
    )
  }, [charters, selectedDestination])

  // Get current destination data
  const currentDestinationData = useMemo(() => {
    if (selectedCharterIndex < 0 || !selectedDestination) return undefined
    const charter = charters[selectedCharterIndex]
    return charter?.destinations.find(
      (dest) => dest.destination === selectedDestination
    )
  }, [charters, selectedCharterIndex, selectedDestination])

  // File upload handler
  const handleFileUpload = (
    event: React.ChangeEvent<HTMLInputElement>,
    callback: (result: string) => void
  ) => {
    const file = event.target.files?.[0]
    if (file) {
      const reader = new FileReader()
      reader.onload = () => {
        if (reader.result) {
          callback(reader.result as string)
        }
      }
      reader.readAsDataURL(file)
    }
  }

  // Destination update handler
  const handleDestinationUpdate = (updatedDestData: DestinationData) => {
    if (!selectedDestination || selectedCharterIndex < 0) return

    // Create a copy of the charters array
    const updatedCharters = [...charters]

    // Create a copy of the selected charter
    const charter = { ...updatedCharters[selectedCharterIndex] }

    // Create a copy of the destinations array
    charter.destinations = [...charter.destinations]

    // Update the charter in the updatedCharters array
    updatedCharters[selectedCharterIndex] = charter

    // Find the index of the destination to update
    const destIndex = charter.destinations.findIndex(
      (dest) => dest.destination === selectedDestination
    )

    if (destIndex >= 0) {
      // Create a copy of the updated destination data
      const updatedDestination = { ...updatedDestData }

      // Update the destination
      charter.destinations[destIndex] = updatedDestination

      // Update the state with the new charters array
      onCharterUpdate(updatedCharters)
    }
  }

  return (
    <div className="space-y-6 bg-gray-800 p-6 rounded-lg shadow-md text-white">
      {/* Destination Selector - First */}
      <div className="bg-gray-700 p-4 rounded-lg">
        <Label
          htmlFor="destinationSelect"
          className="text-xl font-semibold mb-2 text-white"
        >
          Seleccionar Destino
        </Label>
        <Select
          id="destinationSelect"
          value={selectedDestination}
          onChange={(e) => onDestinationChange(e.target.value)}
          className="bg-gray-600 text-white"
        >
          <option value="">Seleccionar destino...</option>
          {allDestinations.map((destination) => (
            <option key={destination} value={destination}>
              {destination}
            </option>
          ))}
        </Select>
      </div>

      {/* Global Profit Settings */}
      <div className="bg-gray-700 p-4 rounded-lg">
        <Label className="text-xl font-semibold mb-2 text-white">
          Ganancia Global
        </Label>
        <div className="grid grid-cols-2 gap-4">
          <div>
            <Label htmlFor="globalProfitRT" className="text-white">
              Ganancia R/T ($)
            </Label>
            <Input
              id="globalProfitRT"
              type="number"
              value={globalProfit.rt}
              onChange={(e) =>
                onGlobalProfitChange({
                  ...globalProfit,
                  rt: parseFloat(e.target.value) || 0,
                })
              }
              className="mt-1 bg-gray-600 text-white"
              min="0"
              step="1"
            />
          </div>
          <div>
            <Label htmlFor="globalProfitOW" className="text-white">
              Ganancia O/W ($)
            </Label>
            <Input
              id="globalProfitOW"
              type="number"
              value={globalProfit.ow}
              onChange={(e) =>
                onGlobalProfitChange({
                  ...globalProfit,
                  ow: parseFloat(e.target.value) || 0,
                })
              }
              className="mt-1 bg-gray-600 text-white"
              min="0"
              step="1"
            />
          </div>
        </div>
      </div>

      {/* Charter Selector - Only show if destination is selected */}
      {selectedDestination && availableCharters.length > 0 && (
        <div className="bg-gray-700 p-4 rounded-lg">
          <Label
            htmlFor="charterSelect"
            className="text-xl font-semibold mb-2 text-white"
          >
            Charters disponibles para {selectedDestination}
          </Label>
          <Select
            id="charterSelect"
            value={selectedCharterIndex}
            onChange={(e) => onSelectCharter(Number(e.target.value))}
            className="bg-gray-600 text-white"
          >
            <option value={-1}>Seleccionar charter...</option>
            {availableCharters.map((charter) => (
              <option key={charter.name} value={charters.indexOf(charter)}>
                {charter.name}
              </option>
            ))}
          </Select>
        </div>
      )}

      {/* Image Upload Section */}
      <div className="bg-gray-700 p-4 rounded-lg">
        <Label className="text-xl font-semibold mb-4 text-white">
          Logos e Imágenes
        </Label>
        <div className="space-y-4">
          {/* Agency Logo Upload */}
          <div>
            <Label htmlFor="agencyLogoUpload" className="text-white">
              Logo de la Agencia
            </Label>
            <Input
              id="agencyLogoUpload"
              type="file"
              accept="image/*"
              onChange={(e) => handleFileUpload(e, onAgencyLogoChange)}
              ref={agencyLogoInputRef}
              className="hidden"
            />
            <Button
              onClick={() => agencyLogoInputRef.current?.click()}
              variant="outline"
              className="w-full mt-2 flex items-center justify-center text-white bg-gray-600 hover:bg-gray-500"
            >
              <FaUpload className="mr-2" />
              Subir Logo
            </Button>
          </div>

          {/* Promotional Image Upload */}
          <div>
            <Label htmlFor="promotionalImageUpload" className="text-white">
              Imagen Promocional
            </Label>
            <Input
              id="promotionalImageUpload"
              type="file"
              accept="image/*"
              onChange={(e) => handleFileUpload(e, onPromotionalImageChange)}
              ref={promotionalImageInputRef}
              className="hidden"
            />
            <Button
              onClick={() => promotionalImageInputRef.current?.click()}
              variant="outline"
              className="w-full mt-2 flex items-center justify-center text-white bg-gray-600 hover:bg-gray-500"
            >
              <FaUpload className="mr-2" />
              Subir Imagen Promocional
            </Button>
          </div>
        </div>
      </div>

      {/* Action Buttons */}
      <div className="flex space-x-4">
        <Button
          onClick={onDownload}
          className="flex-1 flex items-center justify-center bg-blue-500 hover:bg-blue-600 text-white"
        >
          <FaDownload className="mr-2" />
          Descargar
        </Button>
        <Button
          onClick={onSave}
          className="flex-1 flex items-center justify-center bg-green-500 hover:bg-green-600 text-white"
        >
          <FaSave className="mr-2" />
          Guardar
        </Button>
        <Button
          onClick={onLoad}
          className="flex-1 flex items-center justify-center bg-purple-500 hover:bg-purple-600 text-white"
        >
          <FaUpload className="mr-2 transform rotate-180" />
          Cargar
        </Button>
      </div>

      {/* Editors - Only show if both destination and charter are selected */}
      {currentDestinationData && selectedCharterIndex >= 0 && (
        <>
          <PriceEditor
            destinationData={currentDestinationData}
            globalProfit={globalProfit}
            onDestinationUpdate={handleDestinationUpdate}
          />
        </>
      )}
    </div>
  )
}

export default EditorToolbar

================
File: app/admin/charter-editor/components/controls/MarketingControls.tsx
================
// src/components/controls/MarketingControls.tsx
import React from 'react'
import { Card, CardContent } from '@/components/ui/card'
import { Label } from '@/components/ui/label'
import { Button } from '@/components/ui/button'

interface MarketingControlsProps {
  onLogoUpload: (image: string) => void
  onPromotionalImageUpload: (image: string) => void
}

export const MarketingControls: React.FC<MarketingControlsProps> = ({
  onLogoUpload,
  onPromotionalImageUpload,
}) => {
  const handleImageUpload = (
    event: React.ChangeEvent<HTMLInputElement>,
    type: 'logo' | 'promo'
  ) => {
    const file = event.target.files?.[0]
    if (file) {
      const reader = new FileReader()
      reader.onload = (e) => {
        const result = e.target?.result as string
        if (type === 'logo') {
          onLogoUpload(result)
        } else {
          onPromotionalImageUpload(result)
        }
      }
      reader.readAsDataURL(file)
    }
  }

  return (
    <Card className="mb-4">
      <CardContent className="pt-6">
        {/* Added Section Header */}
        <h2 className="text-xl font-bold mb-4">Marketing</h2>
        <div className="space-y-4">
          <div>
            <Label htmlFor="logoUpload">Logo de la Agencia</Label>
            <input
              id="logoUpload"
              type="file"
              accept="image/*"
              onChange={(e) => handleImageUpload(e, 'logo')}
              className="hidden"
            />
            <Button
              onClick={() => document.getElementById('logoUpload')?.click()}
              variant="outline"
              className="w-full mt-2"
            >
              Subir Logo
            </Button>
          </div>

          <div>
            <Label htmlFor="promoUpload">Imagen Promocional</Label>
            <input
              id="promoUpload"
              type="file"
              accept="image/*"
              onChange={(e) => handleImageUpload(e, 'promo')}
              className="hidden"
            />
            <Button
              onClick={() => document.getElementById('promoUpload')?.click()}
              variant="outline"
              className="w-full mt-2"
            >
              Subir Imagen Promocional
            </Button>
          </div>
        </div>
      </CardContent>
    </Card>
  )
}

================
File: app/admin/charter-editor/components/editors/BaggageInfoEditor.tsx
================
// src/components/editors/BaggageInfoEditor.tsx

import { FC, ChangeEvent, useState } from 'react'
import { Card, CardContent } from '@/components/ui/card'
import { Label } from '@/components/ui/label'
import { Textarea } from '@/components/ui/textarea'
import { Button } from '@/components/ui/button'
import { Input } from '@/components/ui/input'
import Select from '@/components/ui/select'
import Toast from '@/components/ui/toast'
import { FaPlus, FaTrash } from 'react-icons/fa'
import type { DestinationData } from '@/types'

interface BaggageInfoEditorProps {
  destinationData: DestinationData
  onBaggageInfoUpdate: (newInfo: string[]) => void
}

// Template options for different baggage information presets
const baggageTemplates = {
  standard: [
    'Equipaje de mano hasta 25lb gratis',
    'Primera maleta 50lb incluida',
    'Maletas adicionales $2/lb',
    'Cargo por chequeo $25',
  ],
  light: [
    'Equipaje de mano hasta 15lb gratis',
    'Maletas adicionales $3/lb',
    'No incluye equipaje documentado',
  ],
  heavy: [
    'Equipaje de mano hasta 30lb gratis',
    'Dos maletas de 50lb incluidas',
    'Maletas adicionales $1.50/lb',
    'Cargo por sobrepeso $4/lb',
  ],
}

const BaggageInfoEditor: FC<BaggageInfoEditorProps> = ({
  destinationData,
  onBaggageInfoUpdate,
}) => {
  // State management
  const [notification, setNotification] = useState<{
    type: 'success' | 'error'
    message: string
  } | null>(null)
  const [editMode, setEditMode] = useState<'list' | 'text'>('list')

  // Constants
  const characterLimit = 300
  const lineLimit = 6
  const currentInfo = destinationData.baggageInfo || []
  const currentLength = currentInfo.join('\n').length

  const showNotification = (type: 'success' | 'error', message: string) => {
    setNotification({ type, message })
    setTimeout(() => setNotification(null), 3000)
  }

  const handleInfoChange = (event: ChangeEvent<HTMLTextAreaElement>) => {
    const value = event.target.value

    if (value.length <= characterLimit) {
      const lines = value.split('\n').slice(0, lineLimit)
      updateInfo(lines)
    } else {
      showNotification('error', 'Límite de caracteres alcanzado')
    }
  }

  const handleLineChange = (index: number, value: string) => {
    const updatedInfo = [...currentInfo]
    updatedInfo[index] = value
    updateInfo(updatedInfo)
  }

  const handleAddLine = () => {
    if (currentInfo.length >= lineLimit) {
      showNotification('error', 'Límite de líneas alcanzado')
      return
    }

    const updatedInfo = [...currentInfo, '']
    updateInfo(updatedInfo)
  }

  const handleRemoveLine = (index: number) => {
    const updatedInfo = currentInfo.filter((_, i) => i !== index)
    updateInfo(updatedInfo)
  }

  const handleTemplateSelect = (event: ChangeEvent<HTMLSelectElement>) => {
    const templateKey = event.target.value as keyof typeof baggageTemplates
    if (templateKey && baggageTemplates[templateKey]) {
      updateInfo(baggageTemplates[templateKey])
      showNotification('success', 'Plantilla aplicada')
    }
  }

  const updateInfo = (newInfo: string[]) => {
    onBaggageInfoUpdate(newInfo)
    showNotification('success', 'Cambios guardados')
  }

  return (
    <Card className="bg-gray-700 p-4 rounded-lg">
      <CardContent>
        {notification && (
          <Toast
            type={notification.type}
            message={notification.message}
            onClose={() => setNotification(null)}
          />
        )}

        <div className="flex flex-col gap-4">
          {/* Header with Controls */}
          <div className="flex justify-between items-center">
            <Label className="text-lg font-semibold text-white flex-grow whitespace-nowrap">
              Equipaje - {destinationData.destination} &nbsp;
            </Label>
            <div className="flex gap-2">
              <Button
                onClick={() =>
                  setEditMode(editMode === 'list' ? 'text' : 'list')
                }
                variant="outline"
                size="sm"
                className="bg-gray-600 hover:bg-gray-500 text-white"
              >
                {editMode === 'list' ? 'Modo Texto' : 'Modo Lista'}
              </Button>
            </div>
          </div>

          {/* Template Selector */}
          <Select
            onChange={handleTemplateSelect}
            defaultValue=""
            className="w-full bg-gray-600 text-white"
          >
            <option value="" disabled>
              Seleccionar plantilla...
            </option>
            <option value="standard">Equipaje Estándar</option>
            <option value="light">Equipaje Ligero</option>
            <option value="heavy">Equipaje Pesado</option>
          </Select>

          {/* Editor Area */}
          {editMode === 'text' ? (
            <Textarea
              value={currentInfo.join('\n')}
              onChange={handleInfoChange}
              placeholder="Ingrese la información de equipaje (una línea por ítem)"
              className="min-h-[150px] font-mono bg-gray-600 text-white"
              style={{
                resize: 'vertical',
                lineHeight: '1.5',
                whiteSpace: 'pre-wrap',
              }}
              spellCheck="false"
            />
          ) : (
            <div className="space-y-2">
              {currentInfo.map((info, index) => (
                <div key={index} className="flex gap-2">
                  <Input
                    value={info}
                    onChange={(e: React.ChangeEvent<HTMLInputElement>) =>
                      handleLineChange(index, e.target.value)
                    }
                    className="flex-grow bg-gray-600 text-white"
                    placeholder={`Información ${index + 1}`}
                  />
                  <Button
                    onClick={() => handleRemoveLine(index)}
                    variant="ghost"
                    size="sm"
                    className="text-red-400 hover:text-red-300"
                  >
                    <FaTrash />
                  </Button>
                </div>
              ))}
              {currentInfo.length < lineLimit && (
                <Button
                  onClick={handleAddLine}
                  variant="outline"
                  size="sm"
                  className="w-full mt-2 bg-gray-600 hover:bg-gray-500 text-white"
                >
                  <FaPlus className="mr-2" />
                  Agregar Línea
                </Button>
              )}
            </div>
          )}

          {/* Character Count */}
          <div className="flex justify-between items-center text-sm text-gray-300">
            <div>Máximo {lineLimit} líneas</div>
            <div>
              {currentLength}/{characterLimit} caracteres
            </div>
          </div>
        </div>
      </CardContent>
    </Card>
  )
}

export default BaggageInfoEditor

================
File: app/admin/charter-editor/components/editors/InfoEditor.tsx
================
// src/components/editors/InfoEditor.tsx

import { FC, ChangeEvent, useState } from 'react'
import { Card, CardContent } from '@/components/ui/card'
import { Label } from '@/components/ui/label'
import { Textarea } from '@/components/ui/textarea'
import { Button } from '@/components/ui/button'
import { Input } from '@/components/ui/input'
import Select from '@/components/ui/select'
import Toast from '@/components/ui/toast'
import { FaPlus, FaTrash } from 'react-icons/fa'
import type { DestinationData } from '@/types'

interface InfoEditorProps {
  destinationData: DestinationData
  onInfoUpdate: (newInfo: string[]) => void
}

// Template options for different information presets
const infoTemplates = {
  standard: [
    'Impuestos USA incluidos',
    'Tasa de salida: $27',
    'Tasa sanitaria: $35',
    'Cargo por reserva: $9',
    'Recarga de combustible: $25',
  ],
  holiday: [
    'Precios especiales de temporada',
    'Equipaje limitado a 40lb',
    'Check-in 3 horas antes',
    'Cargo adicional: $35/lb',
  ],
  baggage: [
    'Equipaje de mano hasta 25lb gratis',
    'Primera maleta 50lb incluida',
    'Maletas adicionales $2/lb',
    'Cargo por chequeo $25',
  ],
  havana: [
    'Impuestos USA incluidos',
    'Tasa de salida HAV: $27',
    'Tasa sanitaria HAV: $35',
    'VIP lounge disponible por $25',
    'Tiempo de check-in: 3 horas',
  ],
  santaClara: [
    'Impuestos USA incluidos',
    'Tasa de salida SNU: $27',
    'Tasa sanitaria SNU: $35',
    'Documentación adicional requerida',
    'Tiempo de check-in: 4 horas',
  ],
}

const InfoEditor: FC<InfoEditorProps> = ({ destinationData, onInfoUpdate }) => {
  // State management
  const [notification, setNotification] = useState<{
    type: 'success' | 'error'
    message: string
  } | null>(null)
  const [editMode, setEditMode] = useState<'list' | 'text'>('list')

  // Constants
  const characterLimit = 500
  const lineLimit = 10
  const currentInfo = destinationData.additionalInfo
  const currentLength = currentInfo.join('\n').length

  const showNotification = (type: 'success' | 'error', message: string) => {
    setNotification({ type, message })
    setTimeout(() => setNotification(null), 3000)
  }

  const handleInfoChange = (event: ChangeEvent<HTMLTextAreaElement>) => {
    const value = event.target.value

    if (value.length <= characterLimit) {
      const lines = value.split('\n').slice(0, lineLimit)
      updateInfo(lines)
    } else {
      showNotification('error', 'Límite de caracteres alcanzado')
    }
  }

  const handleLineChange = (index: number, value: string) => {
    const updatedInfo = [...currentInfo]
    updatedInfo[index] = value
    updateInfo(updatedInfo)
  }

  const handleAddLine = () => {
    if (currentInfo.length >= lineLimit) {
      showNotification('error', 'Límite de líneas alcanzado')
      return
    }

    const updatedInfo = [...currentInfo, '']
    updateInfo(updatedInfo)
  }

  const handleRemoveLine = (index: number) => {
    const updatedInfo = currentInfo.filter((_, i) => i !== index)
    updateInfo(updatedInfo)
  }

  const handleTemplateSelect = (event: ChangeEvent<HTMLSelectElement>) => {
    const templateKey = event.target.value as keyof typeof infoTemplates
    if (templateKey && infoTemplates[templateKey]) {
      updateInfo(infoTemplates[templateKey])
      showNotification('success', 'Plantilla aplicada')
    }
  }

  const updateInfo = (newInfo: string[]) => {
    onInfoUpdate(newInfo)
    showNotification('success', 'Cambios guardados')
  }

  return (
    <Card className="bg-gray-700 p-4 rounded-lg">
      <CardContent>
        {notification && (
          <Toast
            type={notification.type}
            message={notification.message}
            onClose={() => setNotification(null)}
          />
        )}

        <div className="flex flex-col gap-4">
          {/* Header with Controls */}
          <div className="flex justify-between items-center">
            <Label className="text-lg font-semibold text-white flex-grow whitespace-nowrap">
              Informacion - {destinationData.destination} &nbsp;
            </Label>
            <div className="flex gap-2">
              <Button
                onClick={() =>
                  setEditMode(editMode === 'list' ? 'text' : 'list')
                }
                variant="outline"
                size="sm"
                className="bg-gray-600 hover:bg-gray-500 text-white"
              >
                {editMode === 'list' ? 'Modo Texto' : 'Modo Lista'}
              </Button>
            </div>
          </div>

          {/* Template Selector */}
          <Select
            onChange={handleTemplateSelect}
            defaultValue=""
            className="w-full bg-gray-600 text-white"
          >
            <option value="" disabled>
              Seleccionar plantilla...
            </option>
            <option value="standard">Información Estándar</option>
            <option value="holiday">Temporada Alta</option>
            <option value="baggage">Política de Equipaje</option>
            <option value="havana">Específico HAV</option>
            <option value="santaClara">Específico SNU</option>
          </Select>

          {/* Editor Area */}
          {editMode === 'text' ? (
            <Textarea
              value={currentInfo.join('\n')}
              onChange={handleInfoChange}
              placeholder="Ingrese la información adicional (una línea por ítem)"
              className="min-h-[200px] font-mono bg-gray-600 text-white"
              style={{
                resize: 'vertical',
                lineHeight: '1.5',
                whiteSpace: 'pre-wrap',
              }}
              spellCheck="false"
            />
          ) : (
            <div className="space-y-2">
              {currentInfo.map((info, index) => (
                <div key={index} className="flex gap-2">
                  <Input
                    value={info}
                    onChange={(e: React.ChangeEvent<HTMLInputElement>) =>
                      handleLineChange(index, e.target.value)
                    }
                    className="flex-grow bg-gray-600 text-white"
                    placeholder={`Información ${index + 1}`}
                  />
                  <Button
                    onClick={() => handleRemoveLine(index)}
                    variant="ghost"
                    size="sm"
                    className="text-red-400 hover:text-red-300"
                  >
                    <FaTrash />
                  </Button>
                </div>
              ))}
              {currentInfo.length < lineLimit && (
                <Button
                  onClick={handleAddLine}
                  variant="outline"
                  size="sm"
                  className="w-full mt-2 bg-gray-600 hover:bg-gray-500 text-white"
                >
                  <FaPlus className="mr-2" />
                  Agregar Línea
                </Button>
              )}
            </div>
          )}

          {/* Character Count */}
          <div className="flex justify-between items-center text-sm text-gray-300">
            <div>Máximo {lineLimit} líneas</div>
            <div>
              {currentLength}/{characterLimit} caracteres
            </div>
          </div>
        </div>
      </CardContent>
    </Card>
  )
}

export default InfoEditor

================
File: app/admin/charter-editor/components/editors/PriceEditor.tsx
================
// src/components/editors/PriceEditor.tsx

import React, { useState, useEffect } from 'react'
import { Card, CardContent } from '@/components/ui/card'
import { Input } from '@/components/ui/input'
import { Label } from '@/components/ui/label'
import { Button } from '@/components/ui/button'
import TimeSelector from '../ui/TimeSelector'
import type { DestinationData, GlobalProfit } from '@/types'
import { FaTrash, FaPlus } from 'react-icons/fa'
import BaggageInfoEditor from './BaggageInfoEditor'
import InfoEditor from './InfoEditor'

interface PriceEditorProps {
  destinationData: DestinationData
  globalProfit: GlobalProfit
  onDestinationUpdate: (updatedData: DestinationData) => void
}

const PriceEditor: React.FC<PriceEditorProps> = ({
  destinationData,
  globalProfit,
  onDestinationUpdate,
}) => {
  // Create a local copy for editing
  const [localData, setLocalData] = useState<DestinationData>(destinationData)

  // Reset localData when destinationData changes
  useEffect(() => {
    setLocalData(destinationData)
  }, [destinationData])

  // Apply updates and notify parent
  const applyUpdates = (updatedData: DestinationData) => {
    setLocalData(updatedData)
    onDestinationUpdate(updatedData)
  }

  // Flight Schedule Handlers
  const handleFlightDayChange = (dayIndex: number, value: string) => {
    const updatedData = { ...localData }
    updatedData.flightDays = [...updatedData.flightDays]
    updatedData.flightDays[dayIndex] = value
    applyUpdates(updatedData)
  }

  const handleAddFlightTime = () => {
    const updatedData = { ...localData }
    updatedData.flightTimes = [
      ...updatedData.flightTimes,
      { ida: '00:00', regreso: '00:00' },
    ]
    updatedData.flightDays = [...updatedData.flightDays, '']
    applyUpdates(updatedData)
  }

  const handleRemoveFlightTime = (index: number) => {
    const updatedData = { ...localData }
    updatedData.flightTimes = updatedData.flightTimes.filter(
      (_, i) => i !== index
    )
    updatedData.flightDays = updatedData.flightDays.filter(
      (_, i) => i !== index
    )
    applyUpdates(updatedData)
  }

  // Price Period Handlers
  const handleAddPeriod = () => {
    const updatedData = { ...localData }
    updatedData.periods = [
      ...updatedData.periods,
      {
        label: 'Nuevo Periodo',
        rt: undefined,
        ow: undefined,
        profitOverride: {},
      },
    ]
    applyUpdates(updatedData)
  }

  const handleRemovePeriod = (index: number) => {
    const updatedData = { ...localData }
    updatedData.periods = updatedData.periods.filter((_, i) => i !== index)
    applyUpdates(updatedData)
  }

  const handlePeriodChange = (
    periodIndex: number,
    field: 'label' | 'rt' | 'ow',
    value: string
  ) => {
    const updatedData = { ...localData }
    updatedData.periods = updatedData.periods.map((period, idx) =>
      idx === periodIndex
        ? {
            ...period,
            [field]: field === 'label' ? value : parseFloat(value) || undefined,
          }
        : period
    )
    applyUpdates(updatedData)
  }

  const handleProfitOverrideChange = (
    periodIndex: number,
    field: 'rt' | 'ow',
    value: string
  ) => {
    const updatedData = { ...localData }
    updatedData.periods = updatedData.periods.map((period, idx) => {
      if (idx === periodIndex) {
        const profitOverride = {
          ...period.profitOverride,
          [field]: parseFloat(value) || undefined,
        }
        return { ...period, profitOverride }
      }
      return period
    })
    applyUpdates(updatedData)
  }

  // Baggage Info Update Handler
  const handleBaggageInfoUpdate = (newInfo: string[]) => {
    const updatedData = { ...localData, baggageInfo: newInfo }
    applyUpdates(updatedData)
  }

  // Additional Info Update Handler
  const handleAdditionalInfoUpdate = (newInfo: string[]) => {
    const updatedData = { ...localData, additionalInfo: newInfo }
    applyUpdates(updatedData)
  }

  // Flight Time Handlers
  const handleFlightTimeChange = (
    index: number,
    type: 'ida' | 'regreso',
    newTime: string
  ) => {
    const updatedData = { ...localData }
    updatedData.flightTimes = updatedData.flightTimes.map((time, idx) =>
      idx === index ? { ...time, [type]: newTime } : time
    )
    applyUpdates(updatedData)
  }

  return (
    <div className="bg-gray-700 p-4 rounded-lg space-y-6">
      <h2 className="text-xl font-semibold text-white mb-4">
        Editor de {destinationData.destination}
      </h2>

      {/* Flight Schedule Section */}
      <div className="space-y-4">
        <div className="flex justify-between items-center">
          <Label className="text-lg font-semibold text-white">
            Horarios de Vuelo
          </Label>
          <Button
            onClick={handleAddFlightTime}
            variant="outline"
            size="sm"
            className="bg-blue-500 hover:bg-blue-600 text-white"
          >
            <FaPlus className="mr-2" />
            Agregar Horario
          </Button>
        </div>

        {localData.flightTimes.map((time, index) => (
          <Card key={index} className="bg-gray-800 border-gray-600">
            <CardContent className="p-4">
              <div className="flex justify-between items-center mb-4">
                <Label className="text-md font-medium text-white">
                  Horario {index + 1}
                </Label>
                <Button
                  onClick={() => handleRemoveFlightTime(index)}
                  variant="ghost"
                  size="sm"
                  className="text-red-400 hover:text-red-300 hover:bg-red-900/20"
                >
                  <FaTrash className="mr-2" />
                  Eliminar
                </Button>
              </div>

              <div className="space-y-4">
                <div>
                  <Label className="text-white">Día de Vuelo</Label>
                  <Input
                    value={localData.flightDays[index] || ''}
                    onChange={(e) =>
                      handleFlightDayChange(index, e.target.value)
                    }
                    placeholder="Ej: Lunes y Jueves"
                    className="mt-1 bg-gray-700 text-white border-gray-600"
                  />
                </div>

                <TimeSelector
                  label="Horarios"
                  idaValue={time.ida}
                  regresoValue={time.regreso}
                  onIdaChange={(newTime) =>
                    handleFlightTimeChange(index, 'ida', newTime)
                  }
                  onRegresoChange={(newTime) =>
                    handleFlightTimeChange(index, 'regreso', newTime)
                  }
                />
              </div>
            </CardContent>
          </Card>
        ))}
      </div>

      {/* Price Periods Section */}
      <div className="space-y-4">
        <div className="flex justify-between items-center">
          <Label className="text-lg font-semibold text-white">
            Periodos de Precios
          </Label>
          <Button
            onClick={handleAddPeriod}
            variant="outline"
            size="sm"
            className="bg-green-500 hover:bg-green-600 text-white"
          >
            <FaPlus className="mr-2" />
            Agregar Periodo
          </Button>
        </div>

        {localData.periods.map((period, index) => (
          <Card key={index} className="bg-gray-800 border-gray-600">
            <CardContent className="p-4">
              <div className="flex justify-between items-center mb-4">
                <Input
                  value={period.label}
                  onChange={(e) =>
                    handlePeriodChange(index, 'label', e.target.value)
                  }
                  placeholder="Nombre del Periodo"
                  className="flex-grow mr-2 bg-gray-700 text-white border-gray-600"
                />
                <Button
                  onClick={() => handleRemovePeriod(index)}
                  variant="ghost"
                  size="sm"
                  className="text-red-400 hover:text-red-300 hover:bg-red-900/20"
                >
                  <FaTrash className="mr-2" />
                  Eliminar
                </Button>
              </div>

              <div className="grid grid-cols-2 gap-4">
                {/* Base Prices */}
                <div className="space-y-2">
                  <Label className="text-white">Precio Base R/T</Label>
                  <Input
                    type="number"
                    value={period.rt ?? ''}
                    onChange={(e) =>
                      handlePeriodChange(index, 'rt', e.target.value)
                    }
                    placeholder="Precio R/T"
                    className="bg-gray-700 text-white border-gray-600"
                    min="0"
                    step="0.01"
                  />
                </div>
                <div className="space-y-2">
                  <Label className="text-white">Precio Base O/W</Label>
                  <Input
                    type="number"
                    value={period.ow ?? ''}
                    onChange={(e) =>
                      handlePeriodChange(index, 'ow', e.target.value)
                    }
                    placeholder="Precio O/W"
                    className="bg-gray-700 text-white border-gray-600"
                    min="0"
                    step="0.01"
                  />
                </div>

                {/* Profit Overrides */}
                <div className="space-y-2">
                  <Label className="text-white">Ganancia R/T (Override)</Label>
                  <Input
                    type="number"
                    value={period.profitOverride?.rt ?? ''}
                    onChange={(e) =>
                      handleProfitOverrideChange(index, 'rt', e.target.value)
                    }
                    placeholder={`Global: +$${globalProfit.rt}`}
                    className="bg-gray-700 text-white border-gray-600"
                    min="0"
                    step="0.01"
                  />
                </div>
                <div className="space-y-2">
                  <Label className="text-white">Ganancia O/W (Override)</Label>
                  <Input
                    type="number"
                    value={period.profitOverride?.ow ?? ''}
                    onChange={(e) =>
                      handleProfitOverrideChange(index, 'ow', e.target.value)
                    }
                    placeholder={`Global: +$${globalProfit.ow}`}
                    className="bg-gray-700 text-white border-gray-600"
                    min="0"
                    step="0.01"
                  />
                </div>
              </div>
            </CardContent>
          </Card>
        ))}
      </div>

      {/* Baggage Information Section */}
      <BaggageInfoEditor
        destinationData={localData}
        onBaggageInfoUpdate={handleBaggageInfoUpdate}
      />

      {/* Additional Information Section */}
      <InfoEditor
        destinationData={localData}
        onInfoUpdate={handleAdditionalInfoUpdate}
      />
    </div>
  )
}

export default PriceEditor

================
File: app/admin/charter-editor/components/sheets/PriceSheet.tsx
================
// src/components/sheets/PriceSheet.tsx

import React from 'react'
import type { CharterData, GlobalProfit } from '@/types'
import { airportNames } from '@/data/airportCodes'
import { FaPhone, FaEnvelope, FaWhatsapp } from 'react-icons/fa'
import PriceDisplay from '@/components/ui/PriceDisplay'

interface PriceSheetProps {
  charters: CharterData[]
  globalProfit: GlobalProfit
  agencyLogo?: string
  promotionalImage?: string
  selectedDestination: string
}

const PriceSheet: React.FC<PriceSheetProps> = ({
  charters,
  globalProfit,
  agencyLogo,
  promotionalImage,
  selectedDestination,
}) => {
  const currentDate = new Date().toLocaleDateString('es', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
  })

  const getFullRouteName = (routeCode: string) => {
    const [fromCode, toCode] = routeCode.split('-')
    const fromName = airportNames[fromCode] || fromCode
    const toName = airportNames[toCode] || toCode
    return `${fromName} (${fromCode}) - ${toName} (${toCode})`
  }

  // Convert 24h time to 12h format
  const formatTime = (time24: string) => {
    const [hours, minutes] = time24.split(':')
    const hour = parseInt(hours)
    const period = hour >= 12 ? 'PM' : 'AM'
    let hour12 = hour % 12
    hour12 = hour12 === 0 ? 12 : hour12
    return `${hour12}:${minutes} ${period}`
  }

  // Filter charters that have the selected destination
  const filteredCharters = charters.filter((charter) =>
    charter.destinations.some(
      (dest) => dest.destination === selectedDestination
    )
  )

  return (
    <div className="w-[800px] bg-gradient-to-b from-gray-800 to-gray-900 p-4 text-white">
      {/* Header Section */}
      <div className="flex justify-between items-center mb-4">
        {/* Logo Section */}
        <div className="flex items-center gap-4">
          {agencyLogo ? (
            <img
              src={agencyLogo}
              alt="Logo de la Agencia"
              width={48}
              height={48}
              className="rounded-full"
            />
          ) : (
            <div className="w-12 h-12 rounded-full bg-blue-900 flex items-center justify-center border-2 border-yellow-400">
              <span className="text-2xl">✈️</span>
            </div>
          )}
          <h2 className="text-xl font-bold">CaribeFly</h2>
        </div>

        {/* Date and Route Section */}
        <div className="text-center">
          <div className="text-sm text-gray-300">{currentDate}</div>
          <div className="text-xl font-bold text-yellow-400">
            {selectedDestination
              ? getFullRouteName(selectedDestination)
              : getFullRouteName('MIA-HAV')}
          </div>
        </div>

        {/* Contact Section */}
        <div className="text-right">
          <div className="text-yellow-400 text-xs mb-1">
            Consultas y Reservas:
          </div>
          <div className="space-y-1">
            <div className="flex items-center justify-end gap-2 text-lg font-bold">
              <FaPhone className="text-base" />
              <span>(305) 333-7457</span>
            </div>
            <div className="flex items-center justify-end gap-2 text-lg font-bold">
              <FaWhatsapp className="text-base" />
              <span>(305) 333-7458</span>
            </div>
            <div className="flex items-center justify-end gap-2 text-lg font-bold">
              <FaEnvelope className="text-base" />
              <span>ventas@caribefly.com</span>
            </div>
          </div>
        </div>
      </div>

      {/* Charters Grid */}
      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
        {filteredCharters.length > 0 ? (
          filteredCharters.map((charter, index) => {
            // Get the destination data for the selected destination
            const destinationData = charter.destinations.find(
              (dest) => dest.destination === selectedDestination
            )

            // Skip if the charter doesn't have data for the selected destination
            if (!destinationData) return null

            return (
              <div
                key={`${charter.name}-${index}`}
                className="bg-gray-800/90 rounded-lg shadow-md overflow-hidden"
              >
                {/* Charter Name */}
                <div className="bg-yellow-400 text-black py-1 px-2 text-center font-bold">
                  {charter.name}
                </div>

                <div className="p-4 space-y-4">
                  {/* Flight Schedule */}
                  <div>
                    <div className="bg-[#5C6C87] px-2 py-1 rounded-t text-center">
                      <div className="text-yellow-400 text-xs font-medium">
                        Días y Horarios
                      </div>
                    </div>
                    <div className="bg-gray-700/90 p-2 rounded-b">
                      {destinationData.flightDays.map((day, idx) => (
                        <div
                          key={`${day}-${idx}`}
                          className="flex justify-between items-center py-1"
                        >
                          <span className="text-blue-300 font-medium">
                            {day || 'N/A'}
                          </span>
                          <span className="text-gray-300">
                            {destinationData.flightTimes[idx] ? (
                              <>
                                Ida:{' '}
                                {formatTime(
                                  destinationData.flightTimes[idx].ida
                                )}{' '}
                                / Regreso:{' '}
                                {formatTime(
                                  destinationData.flightTimes[idx].regreso
                                )}
                              </>
                            ) : (
                              'N/A'
                            )}
                          </span>
                        </div>
                      ))}
                    </div>
                  </div>

                  {/* Price Periods */}
                  <div className="grid grid-cols-2 gap-2">
                    {destinationData.periods.map((period, idx) => (
                      <PriceDisplay
                        key={`${period.label}-${idx}`}
                        period={period}
                        globalProfit={globalProfit}
                      />
                    ))}
                  </div>

                  {/* Additional Info */}
                  <div className="grid grid-cols-2 gap-4 text-xs mt-4">
                    {/* Baggage Info */}
                    {destinationData.baggageInfo &&
                      destinationData.baggageInfo.length > 0 && (
                        <div>
                          <div className="text-yellow-400 font-medium mb-1">
                            Equipaje:
                          </div>
                          {destinationData.baggageInfo.map((line, idx) => (
                            <div
                              key={`baggage-${idx}`}
                              className="text-gray-300"
                            >
                              • {line}
                            </div>
                          ))}
                        </div>
                      )}

                    {/* Important Info */}
                    {destinationData.additionalInfo &&
                      destinationData.additionalInfo.length > 0 && (
                        <div>
                          <div className="text-yellow-400 font-medium mb-1">
                            Información Importante:
                          </div>
                          {destinationData.additionalInfo.map((info, idx) => (
                            <div
                              key={`info-${idx}`}
                              className="flex items-start text-gray-300"
                            >
                              <span className="text-yellow-400 mr-1">•</span>
                              <span>{info}</span>
                            </div>
                          ))}
                        </div>
                      )}
                  </div>
                </div>
              </div>
            )
          })
        ) : (
          <div className="col-span-2 text-center text-gray-400 py-8">
            No hay charters disponibles para el destino seleccionado.
          </div>
        )}

        {/* Promotional Card */}
        <div className="bg-gray-800/90 rounded-lg shadow-md overflow-hidden">
          <div className="bg-blue-600 py-1 text-center font-bold">
            CONTACTO Y SERVICIOS
          </div>
          {promotionalImage ? (
            <img
              src={promotionalImage}
              alt="Promoción"
              className="w-full h-48 object-cover rounded-b-lg"
            />
          ) : (
            <div className="h-48 flex flex-col items-center justify-center text-gray-400 p-4">
              <p className="text-center">
                Imagen promocional recomendada
                <br />
                Dimensiones: 600px × 400px
              </p>
            </div>
          )}
        </div>
      </div>
    </div>
  )
}

export default PriceSheet

================
File: app/admin/charter-editor/components/ui/button.tsx
================
import * as React from 'react'
import { Slot } from '@radix-ui/react-slot'
import { cva, type VariantProps } from 'class-variance-authority'

import { cn } from '@/lib/utils'

const buttonVariants = cva(
  'inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0',
  {
    variants: {
      variant: {
        default: 'bg-primary text-primary-foreground hover:bg-primary/90',
        destructive:
          'bg-destructive text-destructive-foreground hover:bg-destructive/90',
        outline:
          'border border-input bg-background hover:bg-accent hover:text-accent-foreground',
        secondary:
          'bg-secondary text-secondary-foreground hover:bg-secondary/80',
        ghost: 'hover:bg-accent hover:text-accent-foreground',
        link: 'text-primary underline-offset-4 hover:underline',
      },
      size: {
        default: 'h-10 px-4 py-2',
        sm: 'h-9 rounded-md px-3',
        lg: 'h-11 rounded-md px-8',
        icon: 'h-10 w-10',
      },
    },
    defaultVariants: {
      variant: 'default',
      size: 'default',
    },
  }
)

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : 'button'
    return (
      <Comp
        className={cn(buttonVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    )
  }
)
Button.displayName = 'Button'

export { Button, buttonVariants }

================
File: app/admin/charter-editor/components/ui/card.tsx
================
import * as React from 'react'

import { cn } from '@/lib/utils'

const Card = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn(
      'rounded-lg border bg-card text-card-foreground shadow-sm',
      className
    )}
    {...props}
  />
))
Card.displayName = 'Card'

const CardHeader = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn('flex flex-col space-y-1.5 p-6', className)}
    {...props}
  />
))
CardHeader.displayName = 'CardHeader'

const CardTitle = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn(
      'text-2xl font-semibold leading-none tracking-tight',
      className
    )}
    {...props}
  />
))
CardTitle.displayName = 'CardTitle'

const CardDescription = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
))
CardDescription.displayName = 'CardDescription'

const CardContent = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn('p-6 pt-0', className)} {...props} />
))
CardContent.displayName = 'CardContent'

const CardFooter = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn('flex items-center p-6 pt-0', className)}
    {...props}
  />
))
CardFooter.displayName = 'CardFooter'

export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }

================
File: app/admin/charter-editor/components/ui/ConfirmationDialog.tsx
================
// src/components/ui/ConfirmationDialog.tsx

import React from 'react'
import { Button } from './button'

interface ConfirmationDialogProps {
  isOpen: boolean
  onClose: () => void
  onConfirm: () => void
  title: string
  message: string
  confirmText?: string
  cancelText?: string
  type?: 'danger' | 'warning' | 'info'
}

const ConfirmationDialog: React.FC<ConfirmationDialogProps> = ({
  isOpen,
  onClose,
  onConfirm,
  title,
  message,
  confirmText = 'Confirmar',
  cancelText = 'Cancelar',
  type = 'warning',
}) => {
  if (!isOpen) return null

  const getButtonStyle = () => {
    switch (type) {
      case 'danger':
        return 'bg-red-500 hover:bg-red-600'
      case 'warning':
        return 'bg-yellow-500 hover:bg-yellow-600'
      default:
        return 'bg-blue-500 hover:bg-blue-600'
    }
  }

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center">
      <div className="fixed inset-0 bg-black/50" onClick={onClose} />
      <div className="relative bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-md">
        <h2 className="text-xl font-semibold text-white mb-4">{title}</h2>
        <p className="text-gray-300 mb-6">{message}</p>

        <div className="flex justify-end gap-4">
          <Button
            variant="outline"
            onClick={onClose}
            className="bg-gray-700 hover:bg-gray-600 text-white"
          >
            {cancelText}
          </Button>
          <Button
            onClick={() => {
              onConfirm()
              onClose()
            }}
            className={`text-white ${getButtonStyle()}`}
          >
            {confirmText}
          </Button>
        </div>
      </div>
    </div>
  )
}

export default ConfirmationDialog

================
File: app/admin/charter-editor/components/ui/input.tsx
================
// src/components/ui/input.tsx
import * as React from 'react'
import { cn } from '@/lib/utils'

const Input = React.forwardRef<
  HTMLInputElement,
  React.InputHTMLAttributes<HTMLInputElement>
>(({ className, type, ...props }, ref) => {
  const handleKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {
    if (props.onKeyDown) {
      props.onKeyDown(event)
    }
    // Prevent form submission on Enter for number inputs
    if (event.key === 'Enter' && type === 'number') {
      event.preventDefault()
    }
  }

  return (
    <input
      type={type}
      className={cn(
        'flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50',
        className
      )}
      ref={ref}
      onKeyDown={handleKeyDown}
      {...props}
    />
  )
})

Input.displayName = 'Input'

export { Input }

================
File: app/admin/charter-editor/components/ui/label.tsx
================
import * as React from 'react'
import * as LabelPrimitive from '@radix-ui/react-label'
import { cva, type VariantProps } from 'class-variance-authority'

import { cn } from '@/lib/utils'

const labelVariants = cva(
  'text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70'
)

const Label = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &
    VariantProps<typeof labelVariants>
>(({ className, ...props }, ref) => (
  <LabelPrimitive.Root
    ref={ref}
    className={cn(labelVariants(), className)}
    {...props}
  />
))
Label.displayName = LabelPrimitive.Root.displayName

export { Label }

================
File: app/admin/charter-editor/components/ui/PriceDisplay.tsx
================
// src/components/ui/PriceDisplay.tsx

import React from 'react'
import type { PeriodData, GlobalProfit } from '@/types'

interface PriceDisplayProps {
  period: PeriodData
  globalProfit: GlobalProfit
  showBase?: boolean
  className?: string
}

const PriceDisplay: React.FC<PriceDisplayProps> = ({
  period,
  globalProfit,
  showBase = false,
  className = '',
}) => {
  const calculateFinalPrice = (
    base: number | undefined,
    type: keyof GlobalProfit
  ) => {
    if (base === undefined) return null
    const profit = period.profitOverride?.[type] ?? globalProfit[type]
    return base + profit
  }

  const formatPrice = (price: number | null) => {
    if (price === null) return 'N/A'
    return price.toLocaleString('en-US', {
      minimumFractionDigits: 2,
      maximumFractionDigits: 2,
    })
  }

  return (
    <div className={`bg-gray-700/90 p-2 rounded-lg ${className}`}>
      {/* Period Label */}
      <div className="bg-gray-800/50 px-2 py-1 rounded-t text-center mb-2">
        <span className="text-yellow-400 text-sm font-medium">
          {period.label}
        </span>
      </div>

      {/* Round Trip Price */}
      {period.rt !== undefined && (
        <div className="flex justify-between items-center px-2 py-1">
          <span className="text-blue-300 font-medium">R/T:</span>
          <div className="text-right">
            {showBase && (
              <div className="text-xs text-gray-400">
                Base: ${period.rt.toFixed(2)}
              </div>
            )}
            <span className="font-bold text-white">
              ${formatPrice(calculateFinalPrice(period.rt, 'rt'))}
            </span>
          </div>
        </div>
      )}

      {/* One Way Price */}
      {period.ow !== undefined && (
        <div className="flex justify-between items-center px-2 py-1">
          <span className="text-green-300 font-medium">O/W:</span>
          <div className="text-right">
            {showBase && (
              <div className="text-xs text-gray-400">
                Base: ${period.ow.toFixed(2)}
              </div>
            )}
            <span className="font-bold text-white">
              ${formatPrice(calculateFinalPrice(period.ow, 'ow'))}
            </span>
          </div>
        </div>
      )}

      {/* Profit Override Indicators */}
      {(period.profitOverride?.rt !== undefined ||
        period.profitOverride?.ow !== undefined) && (
        <div className="mt-1 pt-1 border-t border-gray-600/50 text-xs text-gray-400">
          {period.profitOverride.rt !== undefined && (
            <div className="flex justify-between">
              <span>Ganancia R/T:</span>
              <span>+${period.profitOverride.rt}</span>
            </div>
          )}
          {period.profitOverride.ow !== undefined && (
            <div className="flex justify-between">
              <span>Ganancia O/W:</span>
              <span>+${period.profitOverride.ow}</span>
            </div>
          )}
        </div>
      )}
    </div>
  )
}

export default PriceDisplay

================
File: app/admin/charter-editor/components/ui/select.tsx
================
// src/components/ui/select.tsx
import * as React from 'react'
import { cn } from '@/lib/utils'

interface SelectProps extends React.ComponentPropsWithoutRef<'select'> {
  className?: string
}

const Select = React.forwardRef<HTMLSelectElement, SelectProps>(
  ({ className, ...props }, ref) => (
    <select
      className={cn(
        'flex h-10 w-full rounded-md border border-input bg-background px-2 py-1 text-base ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 text-foreground appearance-none',
        className
      )}
      ref={ref}
      {...props}
    />
  )
)

Select.displayName = 'Select'

export default Select

================
File: app/admin/charter-editor/components/ui/textarea.tsx
================
// src/components/ui/textarea.tsx
import * as React from 'react'
import { cn } from '@/lib/utils'

const Textarea = React.forwardRef<
  HTMLTextAreaElement,
  React.TextareaHTMLAttributes<HTMLTextAreaElement>
>(({ className, onChange, ...props }, ref) => {
  const handleChange = (event: React.ChangeEvent<HTMLTextAreaElement>) => {
    if (onChange) {
      onChange(event)
    }
  }

  return (
    <textarea
      className={cn(
        'flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 whitespace-pre-wrap',
        className
      )}
      ref={ref}
      onChange={handleChange}
      style={{
        resize: 'vertical',
        lineHeight: '1.5',
        whiteSpace: 'pre-wrap',
        ...props.style,
      }}
      spellCheck="false"
      {...props}
    />
  )
})

Textarea.displayName = 'Textarea'

export { Textarea }

================
File: app/admin/charter-editor/components/ui/TimeSelector.tsx
================
// src/components/ui/TimeSelector.tsx

import React from 'react'
import Select from '@/components/ui/select'
import { Label } from '@/components/ui/label'

interface TimeSelectorProps {
  label: string
  idaValue: string
  regresoValue: string
  onIdaChange: (value: string) => void
  onRegresoChange: (value: string) => void
}

const TimeSelector: React.FC<TimeSelectorProps> = ({
  label,
  idaValue,
  regresoValue,
  onIdaChange,
  onRegresoChange,
}) => {
  // Convert 24h to 12h format
  const to12Hour = (hour24: string) => {
    const hour = parseInt(hour24)
    if (hour === 0) return { hour: '12', period: 'AM' }
    if (hour === 12) return { hour: '12', period: 'PM' }
    if (hour > 12)
      return { hour: (hour - 12).toString().padStart(2, '0'), period: 'PM' }
    return { hour: hour.toString().padStart(2, '0'), period: 'AM' }
  }

  // Convert 12h to 24h format
  const to24Hour = (hour12: string, period: string) => {
    let hour = parseInt(hour12)
    if (period === 'PM' && hour !== 12) hour += 12
    if (period === 'AM' && hour === 12) hour = 0
    return hour.toString().padStart(2, '0')
  }

  // Parse current values
  const [idaHour24, idaMinute] = idaValue.split(':')
  const [regresoHour24, regresoMinute] = regresoValue.split(':')

  const ida12 = to12Hour(idaHour24 || '00')
  const regreso12 = to12Hour(regresoHour24 || '00')

  // Generate time options
  const hours = Array.from({ length: 12 }, (_, i) =>
    (i + 1).toString().padStart(2, '0')
  )
  const minutes = Array.from({ length: 60 }, (_, i) =>
    i.toString().padStart(2, '0')
  )
  const periods = ['AM', 'PM']

  // Handle time changes
  const handleIdaTimeChange = (
    type: 'hour' | 'minute' | 'period',
    value: string
  ) => {
    if (type === 'hour') {
      const hour24 = to24Hour(value, ida12.period)
      onIdaChange(`${hour24}:${idaMinute || '00'}`)
    } else if (type === 'period') {
      const hour24 = to24Hour(ida12.hour, value)
      onIdaChange(`${hour24}:${idaMinute || '00'}`)
    } else {
      onIdaChange(`${idaHour24 || '00'}:${value}`)
    }
  }

  const handleRegresoTimeChange = (
    type: 'hour' | 'minute' | 'period',
    value: string
  ) => {
    if (type === 'hour') {
      const hour24 = to24Hour(value, regreso12.period)
      onRegresoChange(`${hour24}:${regresoMinute || '00'}`)
    } else if (type === 'period') {
      const hour24 = to24Hour(regreso12.hour, value)
      onRegresoChange(`${hour24}:${regresoMinute || '00'}`)
    } else {
      onRegresoChange(`${regresoHour24 || '00'}:${value}`)
    }
  }

  return (
    <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
      {/* Departure Time */}
      <div className="space-y-2">
        <Label className="text-sm font-medium text-white">{label} - Ida</Label>
        <div className="flex items-center gap-2">
          <Select
            value={ida12.hour}
            onChange={(e) => handleIdaTimeChange('hour', e.target.value)}
            className="w-24 bg-gray-700 text-white border-gray-600 focus:text-white [&_option]:bg-white [&_option]:text-gray-900 [&_option]:px-1"
          >
            {hours.map((hour) => (
              <option
                key={`ida-hour-${hour}`}
                value={hour}
                className="text-gray-900 py-1"
              >
                {hour}
              </option>
            ))}
          </Select>
          <span className="text-white">:</span>
          <Select
            value={idaMinute || '00'}
            onChange={(e) => handleIdaTimeChange('minute', e.target.value)}
            className="w-24 bg-gray-700 text-white border-gray-600 focus:text-white [&_option]:bg-white [&_option]:text-gray-900 [&_option]:px-1"
          >
            {minutes.map((minute) => (
              <option
                key={`ida-min-${minute}`}
                value={minute}
                className="text-gray-900 py-1"
              >
                {minute}
              </option>
            ))}
          </Select>
          <Select
            value={ida12.period}
            onChange={(e) => handleIdaTimeChange('period', e.target.value)}
            className="w-28 bg-gray-700 text-white border-gray-600 focus:text-white [&_option]:bg-white [&_option]:text-gray-900 [&_option]:px-1"
          >
            {periods.map((period) => (
              <option
                key={`ida-period-${period}`}
                value={period}
                className="text-gray-900 py-1"
              >
                {period}
              </option>
            ))}
          </Select>
        </div>
      </div>

      {/* Return Time */}
      <div className="space-y-2">
        <Label className="text-sm font-medium text-white">
          {label} - Regreso
        </Label>
        <div className="flex items-center gap-2">
          <Select
            value={regreso12.hour}
            onChange={(e) => handleRegresoTimeChange('hour', e.target.value)}
            className="w-24 bg-gray-700 text-white border-gray-600 focus:text-white [&_option]:bg-white [&_option]:text-gray-900 [&_option]:px-1"
          >
            {hours.map((hour) => (
              <option
                key={`regreso-hour-${hour}`}
                value={hour}
                className="text-gray-900 py-1"
              >
                {hour}
              </option>
            ))}
          </Select>
          <span className="text-white">:</span>
          <Select
            value={regresoMinute || '00'}
            onChange={(e) => handleRegresoTimeChange('minute', e.target.value)}
            className="w-24 bg-gray-700 text-white border-gray-600 focus:text-white [&_option]:bg-white [&_option]:text-gray-900 [&_option]:px-1"
          >
            {minutes.map((minute) => (
              <option
                key={`regreso-min-${minute}`}
                value={minute}
                className="text-gray-900 py-1"
              >
                {minute}
              </option>
            ))}
          </Select>
          <Select
            value={regreso12.period}
            onChange={(e) => handleRegresoTimeChange('period', e.target.value)}
            className="w-28 bg-gray-700 text-white border-gray-600 focus:text-white [&_option]:bg-white [&_option]:text-gray-900 [&_option]:px-1"
          >
            {periods.map((period) => (
              <option
                key={`regreso-period-${period}`}
                value={period}
                className="text-gray-900 py-1"
              >
                {period}
              </option>
            ))}
          </Select>
        </div>
      </div>
    </div>
  )
}

export default TimeSelector

================
File: app/admin/charter-editor/components/ui/toast.tsx
================
// src/components/ui/Toast.tsx

import React, { useEffect } from 'react'
import { cn } from '@/lib/utils'
import { FaCheck, FaTimes, FaExclamationTriangle } from 'react-icons/fa'

interface ToastProps {
  type: 'success' | 'error' | 'warning'
  message: string
  onClose: () => void
  duration?: number
}

const Toast: React.FC<ToastProps> = ({
  type,
  message,
  onClose,
  duration = 3000,
}) => {
  useEffect(() => {
    const timer = setTimeout(onClose, duration)
    return () => clearTimeout(timer)
  }, [duration, onClose])

  const getIcon = () => {
    switch (type) {
      case 'success':
        return <FaCheck className="h-4 w-4" />
      case 'error':
        return <FaTimes className="h-4 w-4" />
      case 'warning':
        return <FaExclamationTriangle className="h-4 w-4" />
    }
  }

  const getStyles = () => {
    switch (type) {
      case 'success':
        return 'bg-green-800 border-green-500'
      case 'error':
        return 'bg-red-800 border-red-500'
      case 'warning':
        return 'bg-yellow-800 border-yellow-500'
    }
  }

  return (
    <div
      className={cn(
        'fixed top-4 right-4 z-50 flex items-center gap-2 rounded-lg px-4 py-2',
        'border text-white shadow-lg transition-all duration-300',
        'animate-in slide-in-from-top-5',
        getStyles()
      )}
      role="alert"
    >
      <span className="flex items-center justify-center">{getIcon()}</span>
      <p className="text-sm font-medium">{message}</p>
      <button
        onClick={onClose}
        className="ml-4 text-white/80 hover:text-white focus:outline-none"
        aria-label="Cerrar notificación"
      >
        <FaTimes className="h-3 w-3" />
      </button>
    </div>
  )
}

export default Toast

================
File: app/admin/charter-editor/constants/defaults.ts
================
// src/constants/defaults.ts
import type { GlobalProfit } from '@/types'

export const initialGlobalProfit: GlobalProfit = {
  rt: 30,
  ow: 20,
}

export const DEFAULT_INFO: string[] = [
  'Impuestos de los USA incluidos',
  '• $27 impuestos de salida de Cuba',
  '• $35 Tasa Sanitaria',
  '• $9 Cargo por Reserva',
  '• $25 Recarga de Combustible',
  '(cobrado en aeropuerto)',
]

================
File: app/admin/charter-editor/data/airportCodes.ts
================
// src/data/airportCodes.ts

export const airportNames: { [code: string]: string } = {
  MIA: 'Miami',
  HAV: 'Havana',
  CMW: 'Camagüey',
  HOG: 'Holguín',
  SNU: 'Santa Clara',
  RSW: 'Fort Myers',
  TPA: 'Tampa',
  // Añade cualquier otro código de aeropuerto y nombre según sea necesario
}

================
File: app/admin/charter-editor/data/charterData.ts
================
// src/data/charterData.ts

import type { CharterData } from '@/types'

export const initialCharterData: CharterData[] = [
  {
    name: 'Enjoy',
    destinations: [
      {
        destination: 'MIA-HAV',
        flightDays: ['Viernes y Sábado'],
        flightTimes: [
          { ida: '06:00', regreso: '09:30' },
          { ida: '18:00', regreso: '21:30' },
        ],
        periods: [
          {
            label: 'Marzo 1-15',
            rt: 349,
            ow: 269,
          },
          {
            label: 'Marzo 16-31',
            rt: 399,
            ow: 289,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.40/lb',
          'Maletas adicionales: $2.70/lb',
          'Cargo por chequeo: $26 por pieza',
        ],
        additionalInfo: [
          'Impuestos USA incluidos',
          'Tasa de salida: $27',
          'Tasa sanitaria: $35',
          'Cargo por reserva: $9',
          'Recarga de combustible: $25',
        ],
      },
      {
        destination: 'MIA-SNU',
        flightDays: ['Lunes y Jueves'],
        flightTimes: [
          { ida: '07:00', regreso: '10:30' },
          { ida: '15:00', regreso: '18:30' },
        ],
        periods: [
          {
            label: 'Marzo 1-15',
            rt: 369,
            ow: 289,
          },
          {
            label: 'Marzo 16-31',
            rt: 419,
            ow: 309,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.50/lb',
          'Maletas adicionales: $2.80/lb',
          'Cargo por chequeo: $28 por pieza',
        ],
        additionalInfo: [
          'Impuestos USA incluidos',
          'Tasa de salida: $27',
          'Tasa sanitaria: $35',
          'Cargo por reserva: $9',
          'Recarga de combustible: $25',
        ],
      },
    ],
  },
  {
    name: 'Xael',
    destinations: [
      {
        destination: 'MIA-HAV',
        flightDays: ['Domingo a Jueves'],
        flightTimes: [
          { ida: '05:45', regreso: '08:00' },
          { ida: '19:30', regreso: '21:30' },
        ],
        periods: [
          {
            label: 'Noviembre 1-30 (excepto 27-30)',
            rt: 299,
            ow: 229,
          },
          {
            label: 'Noviembre 27-30',
            rt: 359,
            ow: 249,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.00/lb',
          'Maletas adicionales: $2.00/lb',
          'Cargo por chequeo: $25 por pieza',
        ],
        additionalInfo: [
          'Impuestos USA incluidos',
          'Tasa de salida: $27',
          'Cargo por reserva: $9',
          'Recarga de combustible: $25',
        ],
      },
      {
        destination: 'MIA-CMW',
        flightDays: ['Martes y Viernes'],
        flightTimes: [
          { ida: '06:45', regreso: '09:15' },
          { ida: '14:30', regreso: '17:00' },
        ],
        periods: [
          {
            label: 'Noviembre 1-30',
            rt: 319,
            ow: 239,
          },
          {
            label: 'Temporada Alta',
            rt: 379,
            ow: 279,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.10/lb',
          'Maletas adicionales: $2.20/lb',
          'Cargo por chequeo: $25 por pieza',
        ],
        additionalInfo: [
          'Impuestos USA incluidos',
          'Tasa de salida: $27',
          'Cargo por reserva: $9',
          'Recarga de combustible: $25',
        ],
      },
      {
        destination: 'MIA-HOG',
        flightDays: ['Lunes y Sábado'],
        flightTimes: [
          { ida: '07:45', regreso: '10:15' },
          { ida: '15:30', regreso: '18:00' },
        ],
        periods: [
          {
            label: 'Noviembre 1-30',
            rt: 339,
            ow: 249,
          },
          {
            label: 'Temporada Alta',
            rt: 399,
            ow: 289,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.20/lb',
          'Maletas adicionales: $2.30/lb',
          'Cargo por chequeo: $25 por pieza',
        ],
        additionalInfo: [
          'Impuestos USA incluidos',
          'Tasa de salida: $27',
          'Cargo por reserva: $9',
          'Recarga de combustible: $25',
        ],
      },
    ],
  },
  {
    name: 'Cubazul',
    destinations: [
      {
        destination: 'MIA-HAV',
        flightDays: ['Lunes, Miércoles y Viernes'],
        flightTimes: [
          { ida: '10:00', regreso: '13:15' },
          { ida: '15:00', regreso: '18:15' },
        ],
        periods: [
          {
            label: 'Diciembre 1-15',
            rt: 319,
            ow: 239,
          },
          {
            label: 'Diciembre 16-31',
            rt: 379,
            ow: 269,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.20/lb',
          'Maletas adicionales: $2.50/lb',
          'Cargo por chequeo: $30 por pieza',
        ],
        additionalInfo: [
          'Incluye todos los impuestos',
          'No incluye seguro de viaje',
          'Tasa de salida: $27',
          'Tasa sanitaria: $35',
        ],
      },
      {
        destination: 'MIA-SNU',
        flightDays: ['Martes y Jueves'],
        flightTimes: [
          { ida: '09:00', regreso: '12:15' },
          { ida: '14:00', regreso: '17:15' },
        ],
        periods: [
          {
            label: 'Diciembre 1-15',
            rt: 329,
            ow: 249,
          },
          {
            label: 'Diciembre 16-31',
            rt: 389,
            ow: 279,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.20/lb',
          'Maletas adicionales: $2.50/lb',
          'Cargo por chequeo: $30 por pieza',
        ],
        additionalInfo: [
          'Incluye todos los impuestos',
          'No incluye seguro de viaje',
          'Tasa de salida: $27',
          'Tasa sanitaria: $35',
        ],
      },
      {
        destination: 'MIA-CMW',
        flightDays: ['Miércoles y Sábado'],
        flightTimes: [
          { ida: '08:00', regreso: '11:15' },
          { ida: '16:00', regreso: '19:15' },
        ],
        periods: [
          {
            label: 'Diciembre 1-15',
            rt: 339,
            ow: 259,
          },
          {
            label: 'Diciembre 16-31',
            rt: 399,
            ow: 289,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.20/lb',
          'Maletas adicionales: $2.50/lb',
          'Cargo por chequeo: $30 por pieza',
        ],
        additionalInfo: [
          'Incluye todos los impuestos',
          'No incluye seguro de viaje',
          'Tasa de salida: $27',
          'Tasa sanitaria: $35',
        ],
      },
      {
        destination: 'MIA-HOG',
        flightDays: ['Lunes y Viernes'],
        flightTimes: [
          { ida: '11:00', regreso: '14:15' },
          { ida: '17:00', regreso: '20:15' },
        ],
        periods: [
          {
            label: 'Diciembre 1-15',
            rt: 349,
            ow: 269,
          },
          {
            label: 'Diciembre 16-31',
            rt: 409,
            ow: 299,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.20/lb',
          'Maletas adicionales: $2.50/lb',
          'Cargo por chequeo: $30 por pieza',
        ],
        additionalInfo: [
          'Incluye todos los impuestos',
          'No incluye seguro de viaje',
          'Tasa de salida: $27',
          'Tasa sanitaria: $35',
        ],
      },
      {
        destination: 'RSW-HAV',
        flightDays: ['Martes y Domingo'],
        flightTimes: [{ ida: '11:00', regreso: '14:15' }],
        periods: [
          {
            label: 'Diciembre 1-15',
            rt: 359,
            ow: 279,
          },
          {
            label: 'Diciembre 16-31',
            rt: 419,
            ow: 309,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.30/lb',
          'Maletas adicionales: $2.60/lb',
          'Cargo por chequeo: $30 por pieza',
        ],
        additionalInfo: [
          'Incluye todos los impuestos',
          'No incluye seguro de viaje',
          'Tasa de salida: $27',
          'Tasa sanitaria: $35',
        ],
      },
      {
        destination: 'RSW-SNU',
        flightDays: ['Jueves y Sábado'],
        flightTimes: [{ ida: '12:00', regreso: '15:15' }],
        periods: [
          {
            label: 'Diciembre 1-15',
            rt: 369,
            ow: 289,
          },
          {
            label: 'Diciembre 16-31',
            rt: 429,
            ow: 319,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.30/lb',
          'Maletas adicionales: $2.60/lb',
          'Cargo por chequeo: $30 por pieza',
        ],
        additionalInfo: [
          'Incluye todos los impuestos',
          'No incluye seguro de viaje',
          'Tasa de salida: $27',
          'Tasa sanitaria: $35',
        ],
      },
    ],
  },
  {
    name: 'Invicta',
    destinations: [
      {
        destination: 'MIA-HAV',
        flightDays: ['Martes y Jueves'],
        flightTimes: [
          { ida: '09:00', regreso: '11:45' },
          { ida: '14:30', regreso: '17:15' },
        ],
        periods: [
          {
            label: 'Enero 1-15',
            rt: 329,
            ow: 249,
          },
          {
            label: 'Enero 16-31',
            rt: 389,
            ow: 279,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.30/lb',
          'Maletas adicionales: $2.80/lb',
          'Cargo por chequeo: $28 por pieza',
        ],
        additionalInfo: [
          'Incluye impuestos de entrada y salida',
          'Aplica recargo por cambio de fecha',
          'Tasa sanitaria: $35',
          'Cargo por reserva: $9',
        ],
      },
      {
        destination: 'MIA-SNU',
        flightDays: ['Lunes y Viernes'],
        flightTimes: [
          { ida: '10:00', regreso: '12:45' },
          { ida: '15:30', regreso: '18:15' },
        ],
        periods: [
          {
            label: 'Enero 1-15',
            rt: 339,
            ow: 259,
          },
          {
            label: 'Enero 16-31',
            rt: 399,
            ow: 289,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.30/lb',
          'Maletas adicionales: $2.80/lb',
          'Cargo por chequeo: $28 por pieza',
        ],
        additionalInfo: [
          'Incluye impuestos de entrada y salida',
          'Aplica recargo por cambio de fecha',
          'Tasa sanitaria: $35',
          'Cargo por reserva: $9',
        ],
      },
      {
        destination: 'MIA-CMW',
        flightDays: ['Miércoles y Sábado'],
        flightTimes: [
          { ida: '11:00', regreso: '13:45' },
          { ida: '16:30', regreso: '19:15' },
        ],
        periods: [
          {
            label: 'Enero 1-15',
            rt: 349,
            ow: 269,
          },
          {
            label: 'Enero 16-31',
            rt: 409,
            ow: 299,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.30/lb',
          'Maletas adicionales: $2.80/lb',
          'Cargo por chequeo: $28 por pieza',
        ],
        additionalInfo: [
          'Incluye impuestos de entrada y salida',
          'Aplica recargo por cambio de fecha',
          'Tasa sanitaria: $35',
          'Cargo por reserva: $9',
        ],
      },
      {
        destination: 'MIA-HOG',
        flightDays: ['Domingo'],
        flightTimes: [
          { ida: '08:00', regreso: '10:45' },
          { ida: '13:30', regreso: '16:15' },
        ],
        periods: [
          {
            label: 'Enero 1-15',
            rt: 359,
            ow: 279,
          },
          {
            label: 'Enero 16-31',
            rt: 419,
            ow: 309,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.30/lb',
          'Maletas adicionales: $2.80/lb',
          'Cargo por chequeo: $28 por pieza',
        ],
        additionalInfo: [
          'Incluye impuestos de entrada y salida',
          'Aplica recargo por cambio de fecha',
          'Tasa sanitaria: $35',
          'Cargo por reserva: $9',
        ],
      },
      {
        destination: 'TPA-HAV',
        flightDays: ['Martes y Sábado'],
        flightTimes: [{ ida: '09:30', regreso: '12:15' }],
        periods: [
          {
            label: 'Enero 1-15',
            rt: 369,
            ow: 289,
          },
          {
            label: 'Enero 16-31',
            rt: 429,
            ow: 319,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.40/lb',
          'Maletas adicionales: $2.90/lb',
          'Cargo por chequeo: $28 por pieza',
        ],
        additionalInfo: [
          'Incluye impuestos de entrada y salida',
          'Aplica recargo por cambio de fecha',
          'Tasa sanitaria: $35',
          'Cargo por reserva: $9',
        ],
      },
      {
        destination: 'TPA-SNU',
        flightDays: ['Jueves'],
        flightTimes: [{ ida: '10:30', regreso: '13:15' }],
        periods: [
          {
            label: 'Enero 1-15',
            rt: 379,
            ow: 299,
          },
          {
            label: 'Enero 16-31',
            rt: 439,
            ow: 329,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.40/lb',
          'Maletas adicionales: $2.90/lb',
          'Cargo por chequeo: $28 por pieza',
        ],
        additionalInfo: [
          'Incluye impuestos de entrada y salida',
          'Aplica recargo por cambio de fecha',
          'Tasa sanitaria: $35',
          'Cargo por reserva: $9',
        ],
      },
    ],
  },
  {
    name: 'Havana Air',
    destinations: [
      {
        destination: 'MIA-HAV',
        flightDays: ['Lunes, Miércoles, Viernes y Domingo'],
        flightTimes: [
          { ida: '08:30', regreso: '11:00' },
          { ida: '16:00', regreso: '18:30' },
        ],
        periods: [
          {
            label: 'Febrero 1-14',
            rt: 309,
            ow: 239,
          },
          {
            label: 'Febrero 15-28',
            rt: 359,
            ow: 269,
          },
          {
            label: 'Temporada Alta',
            rt: 399,
            ow: 299,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.50/lb',
          'Maletas adicionales: $3.00/lb',
          'Cargo por chequeo: $27 por pieza',
        ],
        additionalInfo: [
          'Impuestos de salida y entrada incluidos',
          'Seguro opcional disponible',
          'Tasa sanitaria: $35',
          'Cargo por reserva: $9',
        ],
      },
      {
        destination: 'MIA-SNU',
        flightDays: ['Martes y Sábado'],
        flightTimes: [
          { ida: '09:30', regreso: '12:00' },
          { ida: '17:00', regreso: '19:30' },
        ],
        periods: [
          {
            label: 'Febrero 1-14',
            rt: 329,
            ow: 259,
          },
          {
            label: 'Febrero 15-28',
            rt: 379,
            ow: 289,
          },
          {
            label: 'Temporada Alta',
            rt: 419,
            ow: 319,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.50/lb',
          'Maletas adicionales: $3.00/lb',
          'Cargo por chequeo: $27 por pieza',
        ],
        additionalInfo: [
          'Impuestos de salida y entrada incluidos',
          'Seguro opcional disponible',
          'Tasa sanitaria: $35',
          'Cargo por reserva: $9',
        ],
      },
      {
        destination: 'MIA-HOG',
        flightDays: ['Jueves y Domingo'],
        flightTimes: [
          { ida: '10:30', regreso: '13:00' },
          { ida: '18:00', regreso: '20:30' },
        ],
        periods: [
          {
            label: 'Febrero 1-14',
            rt: 349,
            ow: 269,
          },
          {
            label: 'Febrero 15-28',
            rt: 399,
            ow: 299,
          },
          {
            label: 'Temporada Alta',
            rt: 439,
            ow: 329,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.50/lb',
          'Maletas adicionales: $3.00/lb',
          'Cargo por chequeo: $27 por pieza',
        ],
        additionalInfo: [
          'Impuestos de salida y entrada incluidos',
          'Seguro opcional disponible',
          'Tasa sanitaria: $35',
          'Cargo por reserva: $9',
        ],
      },
      {
        destination: 'TPA-HAV',
        flightDays: ['Lunes y Viernes'],
        flightTimes: [
          { ida: '11:30', regreso: '14:00' },
          { ida: '19:00', regreso: '21:30' },
        ],
        periods: [
          {
            label: 'Febrero 1-14',
            rt: 339,
            ow: 259,
          },
          {
            label: 'Febrero 15-28',
            rt: 389,
            ow: 289,
          },
          {
            label: 'Temporada Alta',
            rt: 429,
            ow: 319,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.60/lb',
          'Maletas adicionales: $3.10/lb',
          'Cargo por chequeo: $27 por pieza',
        ],
        additionalInfo: [
          'Impuestos de salida y entrada incluidos',
          'Seguro opcional disponible',
          'Tasa sanitaria: $35',
          'Cargo por reserva: $9',
        ],
      },
      {
        destination: 'TPA-HOG',
        flightDays: ['Miércoles'],
        flightTimes: [{ ida: '12:30', regreso: '15:00' }],
        periods: [
          {
            label: 'Febrero 1-14',
            rt: 369,
            ow: 279,
          },
          {
            label: 'Febrero 15-28',
            rt: 419,
            ow: 309,
          },
          {
            label: 'Temporada Alta',
            rt: 459,
            ow: 339,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.60/lb',
          'Maletas adicionales: $3.10/lb',
          'Cargo por chequeo: $27 por pieza',
        ],
        additionalInfo: [
          'Impuestos de salida y entrada incluidos',
          'Seguro opcional disponible',
          'Tasa sanitaria: $35',
          'Cargo por reserva: $9',
        ],
      },
    ],
  },
]

export default initialCharterData

================
File: app/admin/charter-editor/lib/utils.ts
================
import { clsx, type ClassValue } from 'clsx'
import { twMerge } from 'tailwind-merge'

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}

================
File: app/admin/charter-editor/styles/globals.css
================
/* src/styles/globals.css */

@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  /* Base Colors */
  --background: 0 0% 100%;
  --foreground: 222.2 84% 4.9%;

  /* Card Colors */
  --card: 0 0% 100%;
  --card-foreground: 222.2 84% 4.9%;

  /* Popover Colors */
  --popover: 0 0% 100%;
  --popover-foreground: 222.2 84% 4.9%;

  /* Primary Colors */
  --primary: 222.2 47.4% 11.2%;
  --primary-foreground: 210 40% 98%;

  /* Secondary Colors */
  --secondary: 210 40% 96.1%;
  --secondary-foreground: 222.2 47.4% 11.2%;

  /* Muted Colors */
  --muted: 210 40% 96.1%;
  --muted-foreground: 215.4 16.3% 46.9%;

  /* Accent Colors */
  --accent: 210 40% 96.1%;
  --accent-foreground: 222.2 47.4% 11.2%;

  /* Destructive Colors */
  --destructive: 0 84.2% 60.2%;
  --destructive-foreground: 210 40% 98%;

  /* Border & Input */
  --border: 214.3 31.8% 91.4%;
  --input: 214.3 31.8% 91.4%;
  --ring: 222.2 84% 4.9%;

  /* Chart Colors */
  --chart-1: 12 76% 61%;
  --chart-2: 173 58% 39%;
  --chart-3: 197 37% 24%;
  --chart-4: 43 74% 66%;
  --chart-5: 27 87% 67%;

  /* Border Radius */
  --radius: 0.5rem;
}

/* Dark Mode Colors */
.dark {
  --background: 222.2 84% 4.9%;
  --foreground: 210 40% 98%;

  /* Card Colors */
  --card: 222.2 84% 4.9%;
  --card-foreground: 210 40% 98%;

  /* Popover Colors */
  --popover: 222.2 84% 4.9%;
  --popover-foreground: 210 40% 98%;

  /* Primary Colors */
  --primary: 210 40% 98%;
  --primary-foreground: 222.2 47.4% 11.2%;

  /* Secondary Colors */
  --secondary: 217.2 32.6% 17.5%;
  --secondary-foreground: 210 40% 98%;

  /* Muted Colors */
  --muted: 217.2 32.6% 17.5%;
  --muted-foreground: 215 20.2% 65.1%;

  /* Accent Colors */
  --accent: 217.2 32.6% 17.5%;
  --accent-foreground: 210 40% 98%;

  /* Destructive Colors */
  --destructive: 0 62.8% 30.6%;
  --destructive-foreground: 210 40% 98%;

  /* Border & Input */
  --border: 217.2 32.6% 17.5%;
  --input: 217.2 32.6% 17.5%;
  --ring: 212.7 26.8% 83.9%;
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  /* Input Styles */
  input {
    font-family: inherit;
    -webkit-appearance: none;
    appearance: none;
    color: var(--foreground); /* Ensure text is visible */
    background-color: hsl(var(--input)); /* Set input background */
    border-color: hsl(var(--border)); /* Set input border */
    padding-right: 2rem; /* Add padding to prevent text overlap with spinner */
  }

  /* Re-enable number input arrows in WebKit browsers */
  input[type='number']::-webkit-inner-spin-button,
  input[type='number']::-webkit-outer-spin-button {
    -webkit-appearance: auto;
    margin: 0;
    color: var(--foreground); /* Set spinner color */
  }

  /* Re-enable number input arrows in Firefox */
  input[type='number'] {
    -moz-appearance: textfield;
  }

  /* Textarea Styles */
  textarea {
    font-family: inherit;
    -webkit-appearance: none;
    appearance: none;
    white-space: pre-wrap !important;
    overflow-wrap: break-word;
    resize: vertical;
    line-height: 1.5;
    min-height: 80px;
    padding: 0.5rem;
    color: var(--foreground); /* Ensure text is visible */
    background-color: hsl(var(--input)); /* Set textarea background */
    border-color: hsl(var(--border)); /* Set textarea border */
  }

  /* Textarea Placeholder */
  textarea::placeholder {
    white-space: pre-wrap;
    color: var(--muted-foreground);
  }

  /* Focus States */
  input:focus,
  textarea:focus {
    outline: none;
    ring-color: var(--ring);
    ring-offset-color: var(--background);
  }

  /* Disabled States */
  input:disabled,
  textarea:disabled {
    cursor: not-allowed;
    opacity: 0.5;
  }
}

/* Utility Classes */
@layer utilities {
  .whitespace-pre-wrap {
    white-space: pre-wrap !important;
  }

  .resize-vertical {
    resize: vertical;
  }

  .min-h-textarea {
    min-height: 80px;
  }
}

/* Custom Scrollbar */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: hsl(var(--secondary));
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: hsl(var(--muted-foreground));
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: hsl(var(--accent));
}

/* Selection */
::selection {
  background-color: hsl(var(--primary));
  color: hsl(var(--primary-foreground));
}

/* Smooth Scrolling */
html {
  scroll-behavior: smooth;
}

/* Animation Classes */
@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.fade-in {
  animation: fadeIn 0.3s ease-in;
}

/* Transition Classes */
.transition-all {
  transition-property: all;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  transition-duration: 150ms;
}

/* Print Styles */
@media print {
  @page {
    margin: 0.5cm;
  }

  body {
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }
}

================
File: app/admin/charter-editor/types/index.ts
================
// src/types/index.ts

export interface FlightTime {
  ida: string // Departure time
  regreso: string // Return time
}

export interface PeriodData {
  label: string // e.g., "March 1-15", "Holiday Season"
  rt?: number // Round trip base price
  ow?: number // One way base price
  profitOverride?: {
    rt?: number // Optional override for round trip profit
    ow?: number // Optional override for one way profit
  }
}

export interface DestinationData {
  destination: string
  flightDays: string[]
  flightTimes: FlightTime[]
  periods: PeriodData[]
  baggageInfo: string[]
  additionalInfo: string[]
}

export interface CharterData {
  name: string // Charter company name
  destinations: DestinationData[]
}

export interface GlobalProfit {
  rt: number // Default round trip profit
  ow: number // Default one way profit
}

export interface StorageData {
  charters: CharterData[]
  globalProfit: GlobalProfit
  agencyLogo?: string
  promotionalImage?: string
  lastUpdated: string
  selectedDestination: string
  selectedCharterIndex: number
}

// Toast notification type
export type NotificationType = 'success' | 'error' | 'warning'

export interface NotificationData {
  type: NotificationType
  message: string
}

// Price display configuration
export interface PriceDisplayConfig {
  showBase?: boolean // Show base price before profit
  showOverride?: boolean // Show profit override indicators
}

// Chart configuration
export interface ChartConfig {
  charters: CharterData[]
  globalProfit: GlobalProfit
  additionalInfo: string[]
}

// Editor state interface
export interface EditorState {
  selectedDestination: string
  selectedCharterIndex: number
  currentDestinationData?: DestinationData
  isEditing: boolean
}

// File upload configuration
export interface FileUploadConfig {
  accept: string
  maxSize: number
  aspectRatio?: number
}

================
File: app/admin/charter-editor/utils/storage.ts
================
// src/utils/storage.ts

import type { CharterData, GlobalProfit } from '@/types'

export interface StorageData {
  charters: CharterData[]
  globalProfit: GlobalProfit
  agencyLogo?: string
  promotionalImage?: string
  lastUpdated: string
  selectedDestination: string
  selectedCharterIndex: number
}

const STORAGE_KEY = 'charterPriceData'

// Utility functions
export const formatCurrency = (amount: number): string => {
  return amount.toLocaleString('en-US', {
    style: 'decimal',
    minimumFractionDigits: 2,
    maximumFractionDigits: 2,
  })
}

export const calculatePrice = (
  basePrice: number,
  type: keyof GlobalProfit,
  globalProfit: GlobalProfit,
  overrideProfit?: Partial<GlobalProfit>
): number => {
  const profit = overrideProfit?.[type] ?? globalProfit[type]
  return basePrice + profit
}

class StorageManager {
  private static instance: StorageManager
  private data: StorageData | null = null
  private initialized: boolean = false

  private constructor() {}

  static getInstance(): StorageManager {
    if (!StorageManager.instance) {
      StorageManager.instance = new StorageManager()
    }
    return StorageManager.instance
  }

  isInitialized(): boolean {
    return this.initialized
  }

  async initialize(): Promise<void> {
    try {
      const storedData = localStorage.getItem(STORAGE_KEY)
      if (storedData) {
        this.data = JSON.parse(storedData)
        console.log('Data loaded from storage:', this.data)
      }
      this.initialized = true
    } catch (error) {
      console.error('Error initializing storage:', error)
      this.data = null
      this.initialized = true // Still mark as initialized even if there's an error
    }
  }

  async saveData(data: StorageData): Promise<boolean> {
    try {
      if (!this.initialized) {
        console.warn('Attempting to save before initialization')
        return false
      }

      this.data = data
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data))
      console.log('Data saved successfully:', data)
      return true
    } catch (error) {
      console.error('Error saving data:', error)
      return false
    }
  }

  getData(): StorageData | null {
    if (!this.initialized) {
      console.warn('Attempting to get data before initialization')
      return null
    }
    return this.data
  }

  clearData(): void {
    if (!this.initialized) {
      console.warn('Attempting to clear data before initialization')
      return
    }
    localStorage.removeItem(STORAGE_KEY)
    this.data = null
  }
}

export const storageManager = StorageManager.getInstance()

================
File: app/admin/components/ui/button.tsx
================
import * as React from 'react'
import { Slot } from '@radix-ui/react-slot'
import { cva, type VariantProps } from 'class-variance-authority'

import { cn } from '@/lib/utils'

const buttonVariants = cva(
  'inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0',
  {
    variants: {
      variant: {
        default: 'bg-primary text-primary-foreground hover:bg-primary/90',
        destructive:
          'bg-destructive text-destructive-foreground hover:bg-destructive/90',
        outline:
          'border border-input bg-background hover:bg-accent hover:text-accent-foreground',
        secondary:
          'bg-secondary text-secondary-foreground hover:bg-secondary/80',
        ghost: 'hover:bg-accent hover:text-accent-foreground',
        link: 'text-primary underline-offset-4 hover:underline',
      },
      size: {
        default: 'h-10 px-4 py-2',
        sm: 'h-9 rounded-md px-3',
        lg: 'h-11 rounded-md px-8',
        icon: 'h-10 w-10',
      },
    },
    defaultVariants: {
      variant: 'default',
      size: 'default',
    },
  }
)

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : 'button'
    return (
      <Comp
        className={cn(buttonVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    )
  }
)
Button.displayName = 'Button'

export { Button, buttonVariants }

================
File: app/admin/components/ui/card.tsx
================
import * as React from 'react'
import { cn } from '@/lib/utils'

const Card = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn(
      'rounded-lg border border-gray-700 bg-gray-800 text-gray-100 shadow-sm',
      className
    )}
    {...props}
  />
))
Card.displayName = 'Card'

const CardHeader = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn('flex flex-col space-y-1.5 p-6', className)}
    {...props}
  />
))
CardHeader.displayName = 'CardHeader'

const CardTitle = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLHeadingElement>
>(({ className, ...props }, ref) => (
  <h3
    ref={ref}
    className={cn(
      'text-2xl font-semibold leading-none tracking-tight text-white',
      className
    )}
    {...props}
  />
))
CardTitle.displayName = 'CardTitle'

const CardDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => (
  <p ref={ref} className={cn('text-sm text-gray-400', className)} {...props} />
))
CardDescription.displayName = 'CardDescription'

const CardContent = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn('p-6 pt-0', className)} {...props} />
))
CardContent.displayName = 'CardContent'

const CardFooter = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn('flex items-center p-6 pt-0', className)}
    {...props}
  />
))
CardFooter.displayName = 'CardFooter'

export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }

================
File: app/admin/components/ui/index.ts
================
export { Button, buttonVariants } from './button'
export { Input } from './input'
export { Label } from './label'
export { Select } from './select'
export { Toast } from './toast'
export { Textarea } from './textarea'
export {
  Card,
  CardHeader,
  CardFooter,
  CardTitle,
  CardDescription,
  CardContent,
} from './card'

================
File: app/admin/components/ui/input.tsx
================
'use client'

import * as React from 'react'
import { cn } from '@/lib/utils'

export interface InputProps
  extends React.InputHTMLAttributes<HTMLInputElement> {}

const Input = React.forwardRef<HTMLInputElement, InputProps>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          'flex h-10 w-full rounded-md border border-gray-600 bg-gray-700 px-3 py-2 text-sm text-white placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50',
          className
        )}
        ref={ref}
        {...props}
      />
    )
  }
)

Input.displayName = 'Input'

export { Input }

================
File: app/admin/components/ui/label.tsx
================
'use client'

import * as React from 'react'
import { cn } from '@/lib/utils'

export interface LabelProps
  extends React.LabelHTMLAttributes<HTMLLabelElement> {}

const Label = React.forwardRef<HTMLLabelElement, LabelProps>(
  ({ className, ...props }, ref) => {
    return (
      <label
        className={cn(
          'text-sm font-medium text-white leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70',
          className
        )}
        ref={ref}
        {...props}
      />
    )
  }
)

Label.displayName = 'Label'

export { Label }

================
File: app/admin/components/ui/select.tsx
================
'use client'

import * as React from 'react'
import { cn } from '@/lib/utils'

interface Option {
  label: string
  value: string
}

interface SelectProps
  extends Omit<React.SelectHTMLAttributes<HTMLSelectElement>, 'onChange'> {
  options: Option[]
  onChange: (value: string) => void
}

const Select = React.forwardRef<HTMLSelectElement, SelectProps>(
  ({ className, options, onChange, value, ...props }, ref) => {
    return (
      <select
        className={cn(
          'flex h-10 w-full rounded-md border border-gray-600 bg-gray-700 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50',
          className
        )}
        ref={ref}
        value={value}
        onChange={(e) => onChange(e.target.value)}
        {...props}
      >
        {options.map((option) => (
          <option
            key={option.value}
            value={option.value}
            className="bg-gray-700 text-white"
          >
            {option.label}
          </option>
        ))}
      </select>
    )
  }
)

Select.displayName = 'Select'

export default Select

================
File: app/admin/components/ui/textarea.tsx
================
// src/components/ui/textarea.tsx
import * as React from 'react'
import { cn } from '@/lib/utils'

const Textarea = React.forwardRef<
  HTMLTextAreaElement,
  React.TextareaHTMLAttributes<HTMLTextAreaElement>
>(({ className, onChange, ...props }, ref) => {
  const handleChange = (event: React.ChangeEvent<HTMLTextAreaElement>) => {
    if (onChange) {
      onChange(event)
    }
  }

  return (
    <textarea
      className={cn(
        'flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 whitespace-pre-wrap',
        className
      )}
      ref={ref}
      onChange={handleChange}
      style={{
        resize: 'vertical',
        lineHeight: '1.5',
        whiteSpace: 'pre-wrap',
        ...props.style,
      }}
      spellCheck="false"
      {...props}
    />
  )
})

Textarea.displayName = 'Textarea'

export { Textarea }

================
File: app/admin/components/ui/toast.tsx
================
// src/components/ui/Toast.tsx

import React, { useEffect } from 'react'
import { cn } from '@/lib/utils'
import { FaCheck, FaTimes, FaExclamationTriangle } from 'react-icons/fa'

interface ToastProps {
  type: 'success' | 'error' | 'warning'
  message: string
  onClose: () => void
  duration?: number
}

const Toast: React.FC<ToastProps> = ({
  type,
  message,
  onClose,
  duration = 3000,
}) => {
  useEffect(() => {
    const timer = setTimeout(onClose, duration)
    return () => clearTimeout(timer)
  }, [duration, onClose])

  const getIcon = () => {
    switch (type) {
      case 'success':
        return <FaCheck className="h-4 w-4" />
      case 'error':
        return <FaTimes className="h-4 w-4" />
      case 'warning':
        return <FaExclamationTriangle className="h-4 w-4" />
    }
  }

  const getStyles = () => {
    switch (type) {
      case 'success':
        return 'bg-green-800 border-green-500'
      case 'error':
        return 'bg-red-800 border-red-500'
      case 'warning':
        return 'bg-yellow-800 border-yellow-500'
    }
  }

  return (
    <div
      className={cn(
        'fixed top-4 right-4 z-50 flex items-center gap-2 rounded-lg px-4 py-2',
        'border text-white shadow-lg transition-all duration-300',
        'animate-in slide-in-from-top-5',
        getStyles()
      )}
      role="alert"
    >
      <span className="flex items-center justify-center">{getIcon()}</span>
      <p className="text-sm font-medium">{message}</p>
      <button
        onClick={onClose}
        className="ml-4 text-white/80 hover:text-white focus:outline-none"
        aria-label="Cerrar notificación"
      >
        <FaTimes className="h-3 w-3" />
      </button>
    </div>
  )
}

export default Toast

================
File: app/admin/components/widget-editors/AnnouncementEditor.tsx
================
// app/admin/components/widget-editors/AnnouncementEditor.tsx
'use client'

import { Widget } from '@/types/dashboard'

interface AnnouncementEditorProps {
  widget: Widget
  onChange: (widget: Widget) => void
}

export default function AnnouncementEditor({
  widget,
  onChange,
}: AnnouncementEditorProps) {
  return (
    <div className="space-y-4">
      <div>
        <label className="block text-sm font-medium text-gray-700">
          Announcement Type
        </label>
        <select
          value={widget.content.type || 'info'}
          onChange={(e) =>
            onChange({
              ...widget,
              content: { ...widget.content, type: e.target.value },
            })
          }
          className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
        >
          <option value="info">Information</option>
          <option value="warning">Warning</option>
          <option value="alert">Alert</option>
        </select>
      </div>

      <div>
        <label className="block text-sm font-medium text-gray-700">
          Content
        </label>
        <textarea
          value={widget.content.text || ''}
          onChange={(e) =>
            onChange({
              ...widget,
              content: { ...widget.content, text: e.target.value },
            })
          }
          className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
          rows={4}
          placeholder="Enter announcement text..."
        />
      </div>

      <div>
        <label className="block text-sm font-medium text-gray-700">
          Priority
        </label>
        <select
          value={widget.content.priority || 'normal'}
          onChange={(e) =>
            onChange({
              ...widget,
              content: { ...widget.content, priority: e.target.value },
            })
          }
          className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
        >
          <option value="low">Low</option>
          <option value="normal">Normal</option>
          <option value="high">High</option>
        </select>
      </div>

      <div className="grid grid-cols-2 gap-4">
        <div>
          <label className="block text-sm font-medium text-gray-700">
            Display From
          </label>
          <input
            type="datetime-local"
            value={widget.content.displayFrom || ''}
            onChange={(e) =>
              onChange({
                ...widget,
                content: { ...widget.content, displayFrom: e.target.value },
              })
            }
            className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
          />
        </div>
        <div>
          <label className="block text-sm font-medium text-gray-700">
            Display Until
          </label>
          <input
            type="datetime-local"
            value={widget.content.displayUntil || ''}
            onChange={(e) =>
              onChange({
                ...widget,
                content: { ...widget.content, displayUntil: e.target.value },
              })
            }
            className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
          />
        </div>
      </div>

      <div className="space-y-4">
        <label className="block text-sm font-medium text-gray-700">
          Display Settings
        </label>
        <div className="space-y-2">
          <div className="flex items-center">
            <input
              type="checkbox"
              checked={widget.settings?.dismissible || false}
              onChange={(e) =>
                onChange({
                  ...widget,
                  settings: {
                    ...widget.settings,
                    dismissible: e.target.checked,
                  },
                })
              }
              className="h-4 w-4 text-blue-600 rounded border-gray-300"
            />
            <label className="ml-2 text-sm text-gray-700">
              Allow users to dismiss this announcement
            </label>
          </div>

          <div className="flex items-center">
            <input
              type="checkbox"
              checked={widget.settings?.showIcon || false}
              onChange={(e) =>
                onChange({
                  ...widget,
                  settings: {
                    ...widget.settings,
                    showIcon: e.target.checked,
                  },
                })
              }
              className="h-4 w-4 text-blue-600 rounded border-gray-300"
            />
            <label className="ml-2 text-sm text-gray-700">Show type icon</label>
          </div>

          <div className="flex items-center">
            <input
              type="checkbox"
              checked={widget.settings?.persistent || false}
              onChange={(e) =>
                onChange({
                  ...widget,
                  settings: {
                    ...widget.settings,
                    persistent: e.target.checked,
                  },
                })
              }
              className="h-4 w-4 text-blue-600 rounded border-gray-300"
            />
            <label className="ml-2 text-sm text-gray-700">
              Keep visible until expiration (override user dismiss)
            </label>
          </div>
        </div>

        <div>
          <label className="block text-sm font-medium text-gray-700">
            Display Style
          </label>
          <select
            value={widget.settings?.style || 'banner'}
            onChange={(e) =>
              onChange({
                ...widget,
                settings: {
                  ...widget.settings,
                  style: e.target.value,
                },
              })
            }
            className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
          >
            <option value="banner">Full Width Banner</option>
            <option value="card">Card</option>
            <option value="toast">Toast Notification</option>
          </select>
        </div>

        {widget.settings?.style === 'toast' && (
          <div>
            <label className="block text-sm font-medium text-gray-700">
              Toast Position
            </label>
            <select
              value={widget.settings?.position || 'top-right'}
              onChange={(e) =>
                onChange({
                  ...widget,
                  settings: {
                    ...widget.settings,
                    position: e.target.value,
                  },
                })
              }
              className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
            >
              <option value="top-right">Top Right</option>
              <option value="top-left">Top Left</option>
              <option value="bottom-right">Bottom Right</option>
              <option value="bottom-left">Bottom Left</option>
            </select>
          </div>
        )}
      </div>
    </div>
  )
}

================
File: app/admin/components/widget-editors/PriceChartEditor.tsx
================
'use client'

import { Widget, WidgetSettings } from '@/types/dashboard'

interface PriceChartEditorProps {
  widget: Widget
  onChange: (widget: Widget) => void
}

export default function PriceChartEditor({
  widget,
  onChange,
}: PriceChartEditorProps) {
  const updateSettings = (settings: Partial<WidgetSettings>) => {
    onChange({
      ...widget,
      settings: {
        ...widget.settings,
        ...settings,
      },
    })
  }

  return (
    <div className="space-y-4">
      <div>
        <label className="block text-sm font-medium text-gray-700">
          Auto Update
        </label>
        <div className="mt-1">
          <input
            type="checkbox"
            checked={widget.settings?.autoUpdate || false}
            onChange={(e) => updateSettings({ autoUpdate: e.target.checked })}
            className="h-4 w-4 text-blue-600 rounded border-gray-300"
          />
          <span className="ml-2 text-sm text-gray-500">
            Automatically update prices from charter systems
          </span>
        </div>
      </div>

      <div>
        <label className="block text-sm font-medium text-gray-700">
          Update Interval (minutes)
        </label>
        <input
          type="number"
          value={widget.settings?.refreshInterval || 60}
          onChange={(e) =>
            updateSettings({ refreshInterval: parseInt(e.target.value) })
          }
          className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
          min="5"
          step="5"
        />
      </div>

      <div>
        <label className="block text-sm font-medium text-gray-700">
          Display Format
        </label>
        <select
          value={widget.settings?.layout || 'grid'}
          onChange={(e) =>
            updateSettings({
              layout: e.target.value as WidgetSettings['layout'],
            })
          }
          className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
        >
          <option value="grid">Grid</option>
          <option value="list">List</option>
          <option value="carousel">Carousel</option>
        </select>
      </div>

      <div>
        <label className="block text-sm font-medium text-gray-700">
          Price Sources
        </label>
        <div className="mt-2 space-y-2">
          {['XAEL', 'Cubazul', 'Invicta'].map((source) => (
            <div key={source} className="flex items-center">
              <input
                type="checkbox"
                checked={widget.settings?.sources?.[source] || false}
                onChange={(e) => {
                  const currentSources = widget.settings?.sources || {}
                  updateSettings({
                    sources: {
                      ...currentSources,
                      [source]: e.target.checked,
                    },
                  })
                }}
                className="h-4 w-4 text-blue-600 rounded border-gray-300"
              />
              <label className="ml-2 text-sm text-gray-700">{source}</label>
            </div>
          ))}
        </div>
      </div>
    </div>
  )
}

================
File: app/admin/components/widget-editors/PromotionImageEditor.tsx
================
'use client'

import { Widget } from '@/types/dashboard'

interface PromotionImageEditorProps {
  widget: Widget
  onChange: (widget: Widget) => void
}

export default function PromotionImageEditor({
  widget,
  onChange,
}: PromotionImageEditorProps) {
  return (
    <div className="space-y-4">
      <div>
        <label className="block text-sm font-medium text-gray-700">
          Promotion Type
        </label>
        <select
          value={widget.content.type || 'standard'}
          onChange={(e) =>
            onChange({
              ...widget,
              content: { ...widget.content, type: e.target.value },
            })
          }
          className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
        >
          <option value="standard">Standard</option>
          <option value="featured">Featured</option>
          <option value="banner">Banner</option>
        </select>
      </div>

      <div>
        <label className="block text-sm font-medium text-gray-700">
          Image URL
        </label>
        <input
          type="text"
          value={widget.content.imageUrl || ''}
          onChange={(e) =>
            onChange({
              ...widget,
              content: { ...widget.content, imageUrl: e.target.value },
            })
          }
          className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
          placeholder="https://example.com/image.jpg"
        />
      </div>

      <div>
        <label className="block text-sm font-medium text-gray-700">
          Link URL (Optional)
        </label>
        <input
          type="text"
          value={widget.content.linkUrl || ''}
          onChange={(e) =>
            onChange({
              ...widget,
              content: { ...widget.content, linkUrl: e.target.value },
            })
          }
          className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
          placeholder="https://example.com/promotion"
        />
      </div>

      <div className="grid grid-cols-2 gap-4">
        <div>
          <label className="block text-sm font-medium text-gray-700">
            Valid From
          </label>
          <input
            type="datetime-local"
            value={widget.content.validFrom || ''}
            onChange={(e) =>
              onChange({
                ...widget,
                content: { ...widget.content, validFrom: e.target.value },
              })
            }
            className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
          />
        </div>
        <div>
          <label className="block text-sm font-medium text-gray-700">
            Valid Until
          </label>
          <input
            type="datetime-local"
            value={widget.content.validUntil || ''}
            onChange={(e) =>
              onChange({
                ...widget,
                content: { ...widget.content, validUntil: e.target.value },
              })
            }
            className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
          />
        </div>
      </div>
    </div>
  )
}

================
File: app/admin/components/AnnouncementsManager.tsx
================
'use client'

import { useState } from 'react'
import { Announcement } from '@/types/dashboard'

interface AnnouncementsManagerProps {
  announcements: Announcement[]
  onUpdate: (announcements: Announcement[]) => void
}

export default function AnnouncementsManager({
  announcements,
  onUpdate,
}: AnnouncementsManagerProps) {
  const [editingAnnouncement, setEditingAnnouncement] =
    useState<Announcement | null>(null)
  const [deleteConfirm, setDeleteConfirm] = useState<string | null>(null)

  const handleSaveAnnouncement = async (announcement: Announcement) => {
    const updatedAnnouncements = editingAnnouncement
      ? announcements.map((a) => (a.id === announcement.id ? announcement : a))
      : [...announcements, announcement]
    onUpdate(updatedAnnouncements)
    setEditingAnnouncement(null)
  }

  const handleDeleteAnnouncement = (id: string) => {
    const updatedAnnouncements = announcements.filter((a) => a.id !== id)
    onUpdate(updatedAnnouncements)
    setDeleteConfirm(null)
  }

  const handleAddAnnouncement = () => {
    const newAnnouncement: Announcement = {
      id: `announcement-${Date.now()}`,
      title: 'New Announcement',
      content: '',
      priority: 'normal',
      type: 'info',
      validFrom: new Date(),
      validUntil: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000), // 1 week from now
      active: true,
      order: announcements.length,
    }
    setEditingAnnouncement(newAnnouncement)
  }

  return (
    <div className="space-y-6">
      <div className="flex justify-between items-center">
        <h2 className="text-xl font-semibold">Manage Announcements</h2>
        <button
          onClick={handleAddAnnouncement}
          className="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"
        >
          Add Announcement
        </button>
      </div>

      {editingAnnouncement && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
          <div className="bg-white rounded-lg p-6 max-w-2xl w-full">
            <h3 className="text-lg font-semibold mb-4">
              {editingAnnouncement.id.startsWith('announcement-')
                ? 'New'
                : 'Edit'}{' '}
              Announcement
            </h3>
            <div className="space-y-4">
              <div>
                <label className="block text-sm font-medium text-gray-700">
                  Title
                </label>
                <input
                  type="text"
                  value={editingAnnouncement.title}
                  onChange={(e) =>
                    setEditingAnnouncement({
                      ...editingAnnouncement,
                      title: e.target.value,
                    })
                  }
                  className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                />
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700">
                  Content
                </label>
                <textarea
                  value={editingAnnouncement.content}
                  onChange={(e) =>
                    setEditingAnnouncement({
                      ...editingAnnouncement,
                      content: e.target.value,
                    })
                  }
                  rows={4}
                  className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                />
              </div>

              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700">
                    Priority
                  </label>
                  <select
                    value={editingAnnouncement.priority}
                    onChange={(e) =>
                      setEditingAnnouncement({
                        ...editingAnnouncement,
                        priority: e.target.value as 'low' | 'normal' | 'high',
                      })
                    }
                    className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                  >
                    <option value="low">Low</option>
                    <option value="normal">Normal</option>
                    <option value="high">High</option>
                  </select>
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700">
                    Type
                  </label>
                  <select
                    value={editingAnnouncement.type}
                    onChange={(e) =>
                      setEditingAnnouncement({
                        ...editingAnnouncement,
                        type: e.target.value as 'info' | 'warning' | 'alert',
                      })
                    }
                    className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                  >
                    <option value="info">Info</option>
                    <option value="warning">Warning</option>
                    <option value="alert">Alert</option>
                  </select>
                </div>
              </div>

              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700">
                    Valid From
                  </label>
                  <input
                    type="datetime-local"
                    value={editingAnnouncement.validFrom
                      .toISOString()
                      .slice(0, 16)}
                    onChange={(e) =>
                      setEditingAnnouncement({
                        ...editingAnnouncement,
                        validFrom: new Date(e.target.value),
                      })
                    }
                    className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700">
                    Valid Until
                  </label>
                  <input
                    type="datetime-local"
                    value={editingAnnouncement.validUntil
                      .toISOString()
                      .slice(0, 16)}
                    onChange={(e) =>
                      setEditingAnnouncement({
                        ...editingAnnouncement,
                        validUntil: new Date(e.target.value),
                      })
                    }
                    className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                  />
                </div>
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700">
                  Display Order
                </label>
                <input
                  type="number"
                  value={editingAnnouncement.order}
                  onChange={(e) =>
                    setEditingAnnouncement({
                      ...editingAnnouncement,
                      order: parseInt(e.target.value),
                    })
                  }
                  className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                  min="0"
                />
              </div>

              <div className="flex items-center">
                <input
                  type="checkbox"
                  checked={editingAnnouncement.active}
                  onChange={(e) =>
                    setEditingAnnouncement({
                      ...editingAnnouncement,
                      active: e.target.checked,
                    })
                  }
                  className="h-4 w-4 text-blue-600 rounded border-gray-300"
                />
                <label className="ml-2 text-sm text-gray-700">Active</label>
              </div>

              <div className="flex justify-end space-x-2 mt-6">
                <button
                  onClick={() => setEditingAnnouncement(null)}
                  className="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50"
                >
                  Cancel
                </button>
                <button
                  onClick={() => handleSaveAnnouncement(editingAnnouncement)}
                  className="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700"
                >
                  Save
                </button>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* Announcements List */}
      <div className="space-y-4">
        {announcements
          .sort((a, b) => a.order - b.order)
          .map((announcement) => (
            <div
              key={announcement.id}
              className={`border rounded-lg p-4 ${
                announcement.type === 'alert'
                  ? 'border-red-200 bg-red-50'
                  : announcement.type === 'warning'
                    ? 'border-yellow-200 bg-yellow-50'
                    : 'border-blue-200 bg-blue-50'
              }`}
            >
              <div className="flex justify-between items-start">
                <div className="flex-1">
                  <h3 className="font-semibold flex items-center">
                    {announcement.title}
                    <span
                      className={`ml-2 text-xs px-2 py-1 rounded-full ${
                        announcement.priority === 'high'
                          ? 'bg-red-100 text-red-800'
                          : announcement.priority === 'normal'
                            ? 'bg-yellow-100 text-yellow-800'
                            : 'bg-green-100 text-green-800'
                      }`}
                    >
                      {announcement.priority}
                    </span>
                  </h3>
                  <p className="mt-2 text-gray-600">{announcement.content}</p>
                  <div className="mt-2 text-sm text-gray-500">
                    <span>Order: {announcement.order}</span>
                    <span className="mx-2">•</span>
                    <span>
                      {announcement.validFrom.toLocaleDateString()} -{' '}
                      {announcement.validUntil.toLocaleDateString()}
                    </span>
                    <span className="mx-2">•</span>
                    <span
                      className={
                        announcement.active ? 'text-green-600' : 'text-red-600'
                      }
                    >
                      {announcement.active ? 'Active' : 'Inactive'}
                    </span>
                  </div>
                </div>

                <div className="flex space-x-2 ml-4">
                  <button
                    onClick={() => setEditingAnnouncement(announcement)}
                    className="p-2 text-blue-600 hover:bg-blue-100 rounded"
                  >
                    Edit
                  </button>
                  {deleteConfirm === announcement.id ? (
                    <>
                      <button
                        onClick={() =>
                          handleDeleteAnnouncement(announcement.id)
                        }
                        className="p-2 text-red-600 hover:bg-red-100 rounded"
                      >
                        Confirm
                      </button>
                      <button
                        onClick={() => setDeleteConfirm(null)}
                        className="p-2 text-gray-600 hover:bg-gray-100 rounded"
                      >
                        Cancel
                      </button>
                    </>
                  ) : (
                    <button
                      onClick={() => setDeleteConfirm(announcement.id)}
                      className="p-2 text-red-600 hover:bg-red-100 rounded"
                    >
                      Delete
                    </button>
                  )}
                </div>
              </div>
            </div>
          ))}
      </div>
    </div>
  )
}

================
File: app/admin/components/ChartersManager.tsx
================
// app/admin/components/ChartersManager.tsx
'use client'

import { useState } from 'react'
import { db } from '@/lib/firebaseConfig'
import { collection, doc, setDoc } from 'firebase/firestore'
import { Charter, Flight } from '@/types/flight'

interface ChartersManagerProps {
  charters: Charter[]
  onUpdate: (charters: Charter[]) => void
}

export default function ChartersManager({
  charters,
  onUpdate,
}: ChartersManagerProps) {
  const [editingCharter, setEditingCharter] = useState<Charter | null>(null)
  const [newFlight, setNewFlight] = useState<Flight>({ route: '', price: '' })

  const handleSaveCharter = async (charter: Charter) => {
    try {
      // Update in Firestore
      const charterRef = doc(db, 'charters', charter.id)
      await setDoc(charterRef, charter, { merge: true })

      // Update local state
      const updatedCharters = charters.map((c) =>
        c.id === charter.id ? charter : c
      )
      onUpdate(updatedCharters)
      setEditingCharter(null)
    } catch (error) {
      console.error('Error saving charter:', error)
    }
  }

  const handleAddFlight = (charter: Charter) => {
    if (newFlight.route && newFlight.price) {
      const updatedCharter = {
        ...charter,
        flights: [...charter.flights, newFlight],
      }
      handleSaveCharter(updatedCharter)
      setNewFlight({ route: '', price: '' })
    }
  }

  return (
    <div className="space-y-8">
      {charters.map((charter) => (
        <div key={charter.id} className="border rounded-lg p-6">
          <div className="flex justify-between items-center mb-4">
            <h3 className="text-xl font-semibold">{charter.title}</h3>
            <button
              onClick={() => setEditingCharter(charter)}
              className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
            >
              Edit Charter
            </button>
          </div>

          {/* Flights Table */}
          <table className="w-full mb-4">
            <thead>
              <tr>
                <th className="text-left pb-2">Route</th>
                <th className="text-left pb-2">Price</th>
                <th className="text-left pb-2">Actions</th>
              </tr>
            </thead>
            <tbody>
              {charter.flights.map((flight, index) => (
                <tr key={index}>
                  <td className="py-2">{flight.route}</td>
                  <td className="py-2">{flight.price}</td>
                  <td className="py-2">
                    <button
                      onClick={() => {
                        const updatedCharter = {
                          ...charter,
                          flights: charter.flights.filter(
                            (_, i) => i !== index
                          ),
                        }
                        handleSaveCharter(updatedCharter)
                      }}
                      className="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700"
                    >
                      Remove
                    </button>
                  </td>
                </tr>
              ))}
            </tbody>
          </table>

          {/* Add New Flight */}
          <div className="flex space-x-2">
            <input
              type="text"
              placeholder="Route"
              value={newFlight.route}
              onChange={(e) =>
                setNewFlight({ ...newFlight, route: e.target.value })
              }
              className="flex-1 p-2 border rounded"
            />
            <input
              type="text"
              placeholder="Price"
              value={newFlight.price}
              onChange={(e) =>
                setNewFlight({ ...newFlight, price: e.target.value })
              }
              className="w-32 p-2 border rounded"
            />
            <button
              onClick={() => handleAddFlight(charter)}
              className="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"
            >
              Add Flight
            </button>
          </div>
        </div>
      ))}
    </div>
  )
}

================
File: app/admin/components/DashboardStats.tsx
================
'use client'

import { useState } from 'react'
import { DashboardData } from '@/types/dashboard'
import {
  LineChart,
  Line,
  XAxis,
  YAxis,
  CartesianGrid,
  Tooltip,
  ResponsiveContainer,
} from 'recharts'

interface DashboardStatsProps {
  data: DashboardData | null
}

export default function DashboardStats({ data }: DashboardStatsProps) {
  const [timeframe, setTimeframe] = useState<'daily' | 'weekly' | 'monthly'>(
    'daily'
  )

  if (!data) {
    return (
      <div className="p-6">
        <div className="text-center text-gray-500">
          Loading dashboard data...
        </div>
      </div>
    )
  }

  // Calculate trends (percentage changes)
  const calculateTrend = (current: number, previous: number): number => {
    return previous ? ((current - previous) / previous) * 100 : 0
  }

  const stats = [
    {
      name: 'Total Flights',
      value: data.totalFlights,
      trend: calculateTrend(data.totalFlights, data.totalFlights - 5),
      color: 'bg-blue-500',
    },
    {
      name: 'Active Promotions',
      value: data.activePromotions,
      trend: calculateTrend(data.activePromotions, data.activePromotions - 2),
      color: 'bg-green-500',
    },
    {
      name: 'Active Announcements',
      value: data.activeAnnouncements,
      trend: calculateTrend(
        data.activeAnnouncements,
        data.activeAnnouncements - 1
      ),
      color: 'bg-purple-500',
    },
    {
      name: 'Recent Bookings',
      value: data.recentBookings,
      trend: calculateTrend(data.recentBookings, data.recentBookings - 3),
      color: 'bg-yellow-500',
    },
  ]

  // Sample chart data
  const chartData = [
    { name: 'Jan', bookings: 65, revenue: 4800, visitors: 2400 },
    { name: 'Feb', bookings: 59, revenue: 5200, visitors: 2800 },
    { name: 'Mar', bookings: 80, revenue: 6100, visitors: 3200 },
    { name: 'Apr', bookings: 81, revenue: 6400, visitors: 3600 },
    { name: 'May', bookings: 56, revenue: 5900, visitors: 3100 },
    { name: 'Jun', bookings: 55, revenue: 5700, visitors: 3000 },
  ]

  return (
    <div className="p-6 space-y-6">
      {/* Stats Grid */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        {stats.map((stat) => (
          <div
            key={stat.name}
            className="bg-white rounded-lg shadow-sm p-6 border border-gray-200"
          >
            <div className="flex items-center justify-between">
              <h3 className="text-sm font-medium text-gray-500">{stat.name}</h3>
              <div className={`w-2 h-2 rounded-full ${stat.color}`}></div>
            </div>
            <p className="mt-2 text-3xl font-semibold text-gray-900">
              {stat.value.toLocaleString()}
            </p>
            <div className="mt-2 flex items-center">
              <span
                className={`text-sm font-medium ${
                  stat.trend >= 0 ? 'text-green-600' : 'text-red-600'
                }`}
              >
                {stat.trend >= 0 ? '↑' : '↓'} {Math.abs(stat.trend).toFixed(1)}%
              </span>
              <span className="ml-2 text-sm text-gray-500">
                from previous period
              </span>
            </div>
          </div>
        ))}
      </div>

      {/* Metrics Timeframe Selector */}
      <div className="flex items-center space-x-4">
        <h2 className="text-lg font-medium text-gray-900">
          Performance Metrics
        </h2>
        <div className="flex rounded-lg shadow-sm">
          {(['daily', 'weekly', 'monthly'] as const).map((t) => (
            <button
              key={t}
              onClick={() => setTimeframe(t)}
              className={`px-4 py-2 text-sm font-medium ${
                timeframe === t
                  ? 'bg-blue-600 text-white'
                  : 'bg-white text-gray-700 hover:bg-gray-50'
              } ${
                t === 'daily'
                  ? 'rounded-l-lg'
                  : t === 'monthly'
                    ? 'rounded-r-lg'
                    : ''
              } border border-gray-200`}
            >
              {t.charAt(0).toUpperCase() + t.slice(1)}
            </button>
          ))}
        </div>
      </div>

      {/* Metrics Grid */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
        {Object.entries(data.metrics[timeframe]).map(([key, value]) => (
          <div
            key={key}
            className="bg-white rounded-lg shadow-sm p-6 border border-gray-200"
          >
            <h3 className="text-sm font-medium text-gray-500 capitalize">
              {key}
            </h3>
            <p className="mt-2 text-3xl font-semibold text-gray-900">
              {key === 'revenue'
                ? `$${value.toLocaleString()}`
                : value.toLocaleString()}
            </p>
          </div>
        ))}
      </div>

      {/* Charts */}
      <div className="space-y-6">
        <div className="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
          <h3 className="text-lg font-medium text-gray-900 mb-6">
            Performance Overview
          </h3>
          <div className="h-[400px]">
            <ResponsiveContainer width="100%" height="100%">
              <LineChart data={chartData}>
                <CartesianGrid strokeDasharray="3 3" />
                <XAxis dataKey="name" />
                <YAxis yAxisId="left" />
                <YAxis yAxisId="right" orientation="right" />
                <Tooltip />
                <Line
                  yAxisId="left"
                  type="monotone"
                  dataKey="bookings"
                  stroke="#3B82F6"
                  name="Bookings"
                />
                <Line
                  yAxisId="right"
                  type="monotone"
                  dataKey="revenue"
                  stroke="#10B981"
                  name="Revenue"
                />
                <Line
                  yAxisId="left"
                  type="monotone"
                  dataKey="visitors"
                  stroke="#8B5CF6"
                  name="Visitors"
                />
              </LineChart>
            </ResponsiveContainer>
          </div>
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
          {/* Recent Activity */}
          <div className="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
            <h3 className="text-lg font-medium text-gray-900 mb-4">
              Recent Activity
            </h3>
            <div className="space-y-4">
              {[
                {
                  type: 'booking',
                  message: 'New booking received',
                  time: '5 minutes ago',
                },
                {
                  type: 'promotion',
                  message: 'Summer promotion updated',
                  time: '2 hours ago',
                },
                {
                  type: 'announcement',
                  message: 'New announcement published',
                  time: '4 hours ago',
                },
              ].map((activity, index) => (
                <div
                  key={index}
                  className="flex items-center space-x-3 text-sm"
                >
                  <div
                    className={`w-2 h-2 rounded-full ${
                      activity.type === 'booking'
                        ? 'bg-green-500'
                        : activity.type === 'promotion'
                          ? 'bg-blue-500'
                          : 'bg-purple-500'
                    }`}
                  />
                  <span className="flex-1 text-gray-600">
                    {activity.message}
                  </span>
                  <span className="text-gray-400">{activity.time}</span>
                </div>
              ))}
            </div>
          </div>

          {/* Quick Actions */}
          <div className="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
            <h3 className="text-lg font-medium text-gray-900 mb-4">
              Quick Actions
            </h3>
            <div className="grid grid-cols-2 gap-4">
              {[
                {
                  label: 'New Promotion',
                  color: 'bg-blue-600 hover:bg-blue-700',
                },
                {
                  label: 'Add Announcement',
                  color: 'bg-purple-600 hover:bg-purple-700',
                },
                {
                  label: 'Update Prices',
                  color: 'bg-green-600 hover:bg-green-700',
                },
                {
                  label: 'View Reports',
                  color: 'bg-yellow-600 hover:bg-yellow-700',
                },
              ].map((action) => (
                <button
                  key={action.label}
                  className={`${action.color} text-white text-sm font-medium px-4 py-2 rounded-lg transition`}
                >
                  {action.label}
                </button>
              ))}
            </div>
          </div>
        </div>
      </div>
    </div>
  )
}

================
File: app/admin/components/FlightTabsManager.tsx
================
'use client'

import { useState } from 'react'
import { FlightTab } from '@/types/dashboard'
import dynamic from 'next/dynamic'

const TabContentEditor = dynamic(() => import('./TabContentEditor'), {
  ssr: false,
})

interface FlightTabsManagerProps {
  tabs: FlightTab[]
  onUpdate: (tabs: FlightTab[]) => Promise<void>
}

export default function FlightTabsManager({
  tabs,
  onUpdate,
}: FlightTabsManagerProps) {
  const [editingTab, setEditingTab] = useState<FlightTab | null>(null)
  const [isCreating, setIsCreating] = useState(false)
  const [deleteConfirm, setDeleteConfirm] = useState<string | null>(null)

  const handleCreateTab = () => {
    const newTab: FlightTab = {
      id: `tab-${Date.now()}`,
      title: 'New Tab',
      description: '',
      order: (tabs || []).length,
      widgets: [], // Ensure widgets array is initialized
      active: true,
    }
    setEditingTab(newTab)
    setIsCreating(true)
  }

  const handleSaveTab = async (tab: FlightTab) => {
    try {
      const updatedTabs = isCreating
        ? [...(tabs || []), tab]
        : (tabs || []).map((t) => (t.id === tab.id ? tab : t))

      await onUpdate(updatedTabs)
      setEditingTab(null)
      setIsCreating(false)
    } catch (error) {
      console.error('Error saving tab:', error)
    }
  }

  const handleDeleteTab = async (tabId: string) => {
    try {
      const updatedTabs = (tabs || []).filter((t) => t.id !== tabId)
      // Reorder remaining tabs
      updatedTabs.forEach((tab, index) => {
        tab.order = index
      })
      await onUpdate(updatedTabs)
      setDeleteConfirm(null)
    } catch (error) {
      console.error('Error deleting tab:', error)
    }
  }

  const handleMoveTab = async (tabId: string, direction: 'up' | 'down') => {
    const currentIndex = (tabs || []).findIndex((t) => t.id === tabId)
    if (
      (direction === 'up' && currentIndex === 0) ||
      (direction === 'down' && currentIndex === (tabs || []).length - 1)
    ) {
      return
    }

    const updatedTabs = [...(tabs || [])]
    const newIndex = direction === 'up' ? currentIndex - 1 : currentIndex + 1
    const [movedTab] = updatedTabs.splice(currentIndex, 1)
    updatedTabs.splice(newIndex, 0, movedTab)

    // Update order property
    updatedTabs.forEach((tab, index) => {
      tab.order = index
    })

    await onUpdate(updatedTabs)
  }

  return (
    <div className="p-6 space-y-6">
      {/* Header */}
      <div className="flex justify-between items-center">
        <h2 className="text-xl font-semibold text-gray-900">
          Manage Flight Section Tabs
        </h2>
        <button
          onClick={handleCreateTab}
          className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"
        >
          Add New Tab
        </button>
      </div>

      {/* Tabs List */}
      <div className="grid gap-6">
        {(tabs || [])
          .sort((a, b) => a.order - b.order)
          .map((tab, index) => (
            <div
              key={tab.id}
              className="bg-white rounded-lg shadow-sm border border-gray-200"
            >
              <div className="p-6">
                <div className="flex items-start justify-between">
                  <div className="flex-1">
                    <div className="flex items-center space-x-4">
                      <div className="flex flex-col space-y-1">
                        <button
                          onClick={() => handleMoveTab(tab.id, 'up')}
                          disabled={index === 0}
                          className="p-1 text-gray-500 hover:text-gray-700 disabled:opacity-50"
                        >
                          ↑
                        </button>
                        <button
                          onClick={() => handleMoveTab(tab.id, 'down')}
                          disabled={index === (tabs || []).length - 1}
                          className="p-1 text-gray-500 hover:text-gray-700 disabled:opacity-50"
                        >
                          ↓
                        </button>
                      </div>
                      <div>
                        <h3 className="text-lg font-medium text-gray-900">
                          {tab.title}
                        </h3>
                        {tab.description && (
                          <p className="mt-1 text-sm text-gray-500">
                            {tab.description}
                          </p>
                        )}
                        <div className="mt-2 flex items-center space-x-2">
                          <span
                            className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
                              tab.active
                                ? 'bg-green-100 text-green-800'
                                : 'bg-red-100 text-red-800'
                            }`}
                          >
                            {tab.active ? 'Active' : 'Inactive'}
                          </span>
                          <span className="text-xs text-gray-500">
                            {(tab?.widgets || []).length} widgets
                          </span>
                          <span className="text-xs text-gray-500">
                            Order: {tab.order}
                          </span>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div className="flex space-x-2 ml-4">
                    <button
                      onClick={() => setEditingTab(tab)}
                      className="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition"
                    >
                      Edit
                    </button>
                    {deleteConfirm === tab.id ? (
                      <>
                        <button
                          onClick={() => handleDeleteTab(tab.id)}
                          className="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition"
                        >
                          Confirm
                        </button>
                        <button
                          onClick={() => setDeleteConfirm(null)}
                          className="px-3 py-1 bg-gray-600 text-white rounded hover:bg-gray-700 transition"
                        >
                          Cancel
                        </button>
                      </>
                    ) : (
                      <button
                        onClick={() => setDeleteConfirm(tab.id)}
                        className="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition"
                      >
                        Delete
                      </button>
                    )}
                  </div>
                </div>
              </div>
            </div>
          ))}
      </div>

      {/* Tab Editor Modal */}
      {editingTab && (
        <TabContentEditor
          tab={editingTab}
          onSave={handleSaveTab}
          onCancel={() => {
            setEditingTab(null)
            setIsCreating(false)
          }}
        />
      )}
    </div>
  )
}

================
File: app/admin/components/PromotionsMagager.tsx
================
// app/adimn / components / PromotionsManager.tsx(continued)
;('use client')

import { useState } from 'react'
import { Promotion } from '@/types/dashboard'

interface PromotionsManagerProps {
  promotions: Promotion[]
  onUpdate: (promotions: Promotion[]) => void
}

export default function PromotionsManager({
  promotions,
  onUpdate,
}: PromotionsManagerProps) {
  const [editingPromotion, setEditingPromotion] = useState<Promotion | null>(
    null
  )
  const [deleteConfirm, setDeleteConfirm] = useState<string | null>(null)

  const handleSavePromotion = async (promotion: Promotion) => {
    const updatedPromotions = promotions.map((p) =>
      p.id === promotion.id ? promotion : p
    )
    onUpdate(updatedPromotions)
    setEditingPromotion(null)
  }

  const handleDeletePromotion = (id: string) => {
    const updatedPromotions = promotions.filter((p) => p.id !== id)
    onUpdate(updatedPromotions)
    setDeleteConfirm(null)
  }

  const handleAddPromotion = () => {
    const newPromotion: Promotion = {
      id: `promo-${Date.now()}`,
      title: 'New Promotion',
      imageUrl: '',
      description: '',
      validFrom: new Date(),
      validUntil: new Date(),
      active: true,
      order: promotions.length,
      charter: '',
      type: 'standard',
    }
    onUpdate([...promotions, newPromotion])
    setEditingPromotion(newPromotion)
  }

  return (
    <div className="space-y-6">
      <div className="flex justify-between items-center">
        <h2 className="text-xl font-semibold">Manage Promotions</h2>
        <button
          onClick={handleAddPromotion}
          className="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"
        >
          Add Promotion
        </button>
      </div>

      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {promotions
          .sort((a, b) => (a.order || 0) - (b.order || 0))
          .map((promotion) => (
            <div key={promotion.id} className="border rounded-lg p-4">
              {editingPromotion?.id === promotion.id ? (
                <div className="space-y-4">
                  <input
                    type="text"
                    value={editingPromotion.title}
                    onChange={(e) =>
                      setEditingPromotion({
                        ...editingPromotion,
                        title: e.target.value,
                      })
                    }
                    className="w-full p-2 border rounded"
                    placeholder="Title"
                  />
                  <input
                    type="text"
                    value={editingPromotion.imageUrl}
                    onChange={(e) =>
                      setEditingPromotion({
                        ...editingPromotion,
                        imageUrl: e.target.value,
                      })
                    }
                    className="w-full p-2 border rounded"
                    placeholder="Image URL"
                  />
                  <textarea
                    value={editingPromotion.description}
                    onChange={(e) =>
                      setEditingPromotion({
                        ...editingPromotion,
                        description: e.target.value,
                      })
                    }
                    className="w-full p-2 border rounded"
                    placeholder="Description"
                    rows={3}
                  />
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm text-gray-600">
                        Valid From
                      </label>
                      <input
                        type="date"
                        value={
                          editingPromotion.validFrom.toISOString().split('T')[0]
                        }
                        onChange={(e) =>
                          setEditingPromotion({
                            ...editingPromotion,
                            validFrom: new Date(e.target.value),
                          })
                        }
                        className="w-full p-2 border rounded"
                      />
                    </div>
                    <div>
                      <label className="block text-sm text-gray-600">
                        Valid Until
                      </label>
                      <input
                        type="date"
                        value={
                          editingPromotion.validUntil
                            .toISOString()
                            .split('T')[0]
                        }
                        onChange={(e) =>
                          setEditingPromotion({
                            ...editingPromotion,
                            validUntil: new Date(e.target.value),
                          })
                        }
                        className="w-full p-2 border rounded"
                      />
                    </div>
                  </div>
                  <div>
                    <label className="block text-sm text-gray-600">Type</label>
                    <select
                      value={editingPromotion.type}
                      onChange={(e) =>
                        setEditingPromotion({
                          ...editingPromotion,
                          type: e.target.value as
                            | 'standard'
                            | 'featured'
                            | 'banner',
                        })
                      }
                      className="w-full p-2 border rounded"
                    >
                      <option value="standard">Standard</option>
                      <option value="featured">Featured</option>
                      <option value="banner">Banner</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm text-gray-600">
                      Charter (Optional)
                    </label>
                    <input
                      type="text"
                      value={editingPromotion.charter}
                      onChange={(e) =>
                        setEditingPromotion({
                          ...editingPromotion,
                          charter: e.target.value,
                        })
                      }
                      className="w-full p-2 border rounded"
                      placeholder="Charter name"
                    />
                  </div>
                  <div>
                    <label className="block text-sm text-gray-600">
                      Display Order
                    </label>
                    <input
                      type="number"
                      value={editingPromotion.order || 0}
                      onChange={(e) =>
                        setEditingPromotion({
                          ...editingPromotion,
                          order: parseInt(e.target.value),
                        })
                      }
                      className="w-full p-2 border rounded"
                      min="0"
                    />
                  </div>
                  <div className="flex items-center">
                    <input
                      type="checkbox"
                      checked={editingPromotion.active}
                      onChange={(e) =>
                        setEditingPromotion({
                          ...editingPromotion,
                          active: e.target.checked,
                        })
                      }
                      className="mr-2"
                    />
                    <label className="text-sm text-gray-600">Active</label>
                  </div>
                  <div className="flex justify-end space-x-2">
                    <button
                      onClick={() => handleSavePromotion(editingPromotion)}
                      className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
                    >
                      Save
                    </button>
                    <button
                      onClick={() => setEditingPromotion(null)}
                      className="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700"
                    >
                      Cancel
                    </button>
                  </div>
                </div>
              ) : (
                <div>
                  <div className="aspect-w-16 aspect-h-9 mb-4">
                    {promotion.imageUrl ? (
                      <img
                        src={promotion.imageUrl}
                        alt={promotion.title}
                        className="object-cover rounded"
                      />
                    ) : (
                      <div className="bg-gray-200 rounded flex items-center justify-center">
                        No Image
                      </div>
                    )}
                  </div>
                  <h3 className="font-semibold">{promotion.title}</h3>
                  <p className="text-sm text-gray-600 mt-2">
                    {promotion.description}
                  </p>
                  <div className="mt-2 text-sm">
                    <span
                      className={`px-2 py-1 rounded ${
                        promotion.active
                          ? 'bg-green-100 text-green-800'
                          : 'bg-red-100 text-red-800'
                      }`}
                    >
                      {promotion.active ? 'Active' : 'Inactive'}
                    </span>
                    <span className="ml-2 text-gray-500">
                      Order: {promotion.order || 0}
                    </span>
                  </div>
                  <div className="mt-4 flex justify-end space-x-2">
                    <button
                      onClick={() => setEditingPromotion(promotion)}
                      className="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700"
                    >
                      Edit
                    </button>
                    {deleteConfirm === promotion.id ? (
                      <>
                        <button
                          onClick={() => handleDeletePromotion(promotion.id)}
                          className="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700"
                        >
                          Confirm
                        </button>
                        <button
                          onClick={() => setDeleteConfirm(null)}
                          className="px-3 py-1 bg-gray-600 text-white rounded hover:bg-gray-700"
                        >
                          Cancel
                        </button>
                      </>
                    ) : (
                      <button
                        onClick={() => setDeleteConfirm(promotion.id)}
                        className="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700"
                      >
                        Delete
                      </button>
                    )}
                  </div>
                </div>
              )}
            </div>
          ))}
      </div>
    </div>
  )
}

================
File: app/admin/components/ServicesManager.tsx
================
'use client'

import { useState } from 'react'
import { db } from '@/lib/firebaseConfig'
import { collection, doc, updateDoc, setDoc } from 'firebase/firestore'

interface Service {
  id: string
  title: string
  content: string
}

interface ServicesManagerProps {
  services: Service[]
  onUpdate: (services: Service[]) => void
}

export default function ServicesManager({
  services,
  onUpdate,
}: ServicesManagerProps) {
  const [editingService, setEditingService] = useState<Service | null>(null)

  const handleSaveService = async (service: Service) => {
    try {
      // Update in Firestore
      const serviceRef = doc(db, 'services', service.id)
      await setDoc(serviceRef, service, { merge: true })

      // Update local state
      const updatedServices = services.map((s) =>
        s.id === service.id ? service : s
      )
      onUpdate(updatedServices)
      setEditingService(null)
    } catch (error) {
      console.error('Error saving service:', error)
    }
  }

  return (
    <div className="space-y-6">
      {services.map((service) => (
        <div key={service.id} className="border rounded-lg p-4">
          {editingService?.id === service.id ? (
            <div className="space-y-4">
              <input
                type="text"
                value={editingService.title}
                onChange={(e) =>
                  setEditingService({
                    ...editingService,
                    title: e.target.value,
                  })
                }
                className="w-full p-2 border rounded"
              />
              <textarea
                value={editingService.content}
                onChange={(e) =>
                  setEditingService({
                    ...editingService,
                    content: e.target.value,
                  })
                }
                className="w-full p-2 border rounded h-24"
              />
              <div className="flex space-x-2">
                <button
                  onClick={() => handleSaveService(editingService)}
                  className="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"
                >
                  Save
                </button>
                <button
                  onClick={() => setEditingService(null)}
                  className="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700"
                >
                  Cancel
                </button>
              </div>
            </div>
          ) : (
            <div className="space-y-2">
              <div className="flex justify-between items-center">
                <h3 className="text-lg font-semibold">{service.title}</h3>
                <button
                  onClick={() => setEditingService(service)}
                  className="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700"
                >
                  Edit
                </button>
              </div>
              <p className="text-gray-600">{service.content}</p>
            </div>
          )}
        </div>
      ))}
    </div>
  )
}

================
File: app/admin/components/TabContentEditor.tsx
================
'use client'

import { useState } from 'react'
import { FlightTab, Widget } from '@/types/dashboard'
import dynamic from 'next/dynamic'

const WidgetEditor = dynamic(() => import('./WidgetEditor'), {
  ssr: false,
})

export interface TabContentEditorProps {
  tab: FlightTab
  onSave: (tab: FlightTab) => Promise<void>
  onCancel: () => void
}

export default function TabContentEditor({
  tab,
  onSave,
  onCancel,
}: TabContentEditorProps) {
  const [editingTab, setEditingTab] = useState<FlightTab>(tab)
  const [editingWidget, setEditingWidget] = useState<Widget | null>(null)
  const [deleteWidgetConfirm, setDeleteWidgetConfirm] = useState<string | null>(
    null
  )

  const handleAddWidget = (type: Widget['type']) => {
    const newWidget: Widget = {
      id: `widget-${Date.now()}`,
      type,
      title: `New ${type} Widget`,
      content: {},
      order: editingTab.widgets.length,
      settings: {},
    }
    setEditingWidget(newWidget)
  }

  const handleSaveWidget = (widget: Widget) => {
    const isNew = !editingTab.widgets.find((w) => w.id === widget.id)
    const updatedWidgets = isNew
      ? [...editingTab.widgets, widget]
      : editingTab.widgets.map((w) => (w.id === widget.id ? widget : w))

    setEditingTab({
      ...editingTab,
      widgets: updatedWidgets,
    })
    setEditingWidget(null)
  }

  const handleDeleteWidget = (widgetId: string) => {
    setEditingTab({
      ...editingTab,
      widgets: editingTab.widgets.filter((w) => w.id !== widgetId),
    })
    setDeleteWidgetConfirm(null)
  }

  const handleSaveTab = () => {
    onSave(editingTab)
  }

  return (
    <div className="fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4">
      <div className="bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
        <div className="p-6">
          <h3 className="text-lg font-medium text-gray-900 mb-4">
            {tab.id.startsWith('tab-') ? 'Create New Tab' : 'Edit Tab'}
          </h3>

          {/* Tab Details */}
          <div className="space-y-4 mb-6">
            <div>
              <label className="block text-sm font-medium text-gray-700">
                Title
              </label>
              <input
                type="text"
                value={editingTab.title}
                onChange={(e) =>
                  setEditingTab({ ...editingTab, title: e.target.value })
                }
                className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
              />
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700">
                Description
              </label>
              <textarea
                value={editingTab.description}
                onChange={(e) =>
                  setEditingTab({ ...editingTab, description: e.target.value })
                }
                className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                rows={3}
              />
            </div>

            <div className="flex items-center">
              <input
                type="checkbox"
                checked={editingTab.active}
                onChange={(e) =>
                  setEditingTab({ ...editingTab, active: e.target.checked })
                }
                className="h-4 w-4 text-blue-600 rounded border-gray-300"
              />
              <label className="ml-2 block text-sm text-gray-900">Active</label>
            </div>
          </div>

          {/* Widgets Section */}
          <div className="border-t border-gray-200 pt-6">
            <div className="flex justify-between items-center mb-4">
              <h4 className="text-lg font-medium text-gray-900">Widgets</h4>
              <div className="flex space-x-2">
                <select
                  onChange={(e) =>
                    handleAddWidget(e.target.value as Widget['type'])
                  }
                  className="block w-full rounded-md border-gray-300 shadow-sm"
                  defaultValue=""
                >
                  <option value="" disabled>
                    Add Widget
                  </option>
                  <option value="priceChart">Price Chart</option>
                  <option value="promotionImage">Promotion Image</option>
                  <option value="announcement">Announcement</option>
                  <option value="info">Info</option>
                </select>
              </div>
            </div>

            {/* Widgets List */}
            <div className="space-y-4">
              {editingTab.widgets
                .sort((a, b) => a.order - b.order)
                .map((widget) => (
                  <div
                    key={widget.id}
                    className="flex items-center justify-between p-4 bg-gray-50 rounded-lg"
                  >
                    <div>
                      <h5 className="font-medium text-gray-900">
                        {widget.title}
                      </h5>
                      <p className="text-sm text-gray-500 capitalize">
                        {widget.type}
                      </p>
                    </div>
                    <div className="flex space-x-2">
                      <button
                        onClick={() => setEditingWidget(widget)}
                        className="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700"
                      >
                        Edit
                      </button>
                      {deleteWidgetConfirm === widget.id ? (
                        <>
                          <button
                            onClick={() => handleDeleteWidget(widget.id)}
                            className="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700"
                          >
                            Confirm
                          </button>
                          <button
                            onClick={() => setDeleteWidgetConfirm(null)}
                            className="px-3 py-1 bg-gray-600 text-white rounded hover:bg-gray-700"
                          >
                            Cancel
                          </button>
                        </>
                      ) : (
                        <button
                          onClick={() => setDeleteWidgetConfirm(widget.id)}
                          className="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700"
                        >
                          Delete
                        </button>
                      )}
                    </div>
                  </div>
                ))}
            </div>
          </div>

          {/* Action Buttons */}
          <div className="mt-6 flex justify-end space-x-3">
            <button
              onClick={onCancel}
              className="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50"
            >
              Cancel
            </button>
            <button
              onClick={handleSaveTab}
              className="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700"
            >
              Save
            </button>
          </div>
        </div>
      </div>

      {/* Widget Editor Modal */}
      {editingWidget && (
        <WidgetEditor
          widget={editingWidget}
          onSave={handleSaveWidget}
          onCancel={() => setEditingWidget(null)}
        />
      )}
    </div>
  )
}

================
File: app/admin/components/WidgetEditor.tsx
================
'use client'

import { useState } from 'react'
import { Widget } from '@/types/dashboard'
import PriceChartEditor from './widget-editors/PriceChartEditor'
import PromotionImageEditor from './widget-editors/PromotionImageEditor'
import AnnouncementEditor from './widget-editors/AnnouncementEditor'

interface WidgetEditorProps {
  widget: Widget
  onSave: (widget: Widget) => void
  onCancel: () => void
}

export default function WidgetEditor({
  widget,
  onSave,
  onCancel,
}: WidgetEditorProps) {
  const [editingWidget, setEditingWidget] = useState<Widget>(widget)

  const handleSave = () => {
    onSave(editingWidget)
  }

  const renderWidgetTypeEditor = () => {
    switch (editingWidget.type) {
      case 'priceChart':
        return (
          <PriceChartEditor
            widget={editingWidget}
            onChange={(updatedWidget: Widget) =>
              setEditingWidget(updatedWidget)
            }
          />
        )
      case 'promotionImage':
        return (
          <PromotionImageEditor
            widget={editingWidget}
            onChange={(updatedWidget: Widget) =>
              setEditingWidget(updatedWidget)
            }
          />
        )
      case 'announcement':
        return (
          <AnnouncementEditor
            widget={editingWidget}
            onChange={(updatedWidget: Widget) =>
              setEditingWidget(updatedWidget)
            }
          />
        )
      default:
        return null
    }
  }

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div className="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
        <div className="p-6">
          <div className="flex justify-between items-center mb-6">
            <h3 className="text-lg font-medium text-gray-900">
              Edit {editingWidget.type} Widget
            </h3>
            <button
              onClick={onCancel}
              className="text-gray-400 hover:text-gray-500"
            >
              <span className="sr-only">Close</span>
              <svg
                className="h-6 w-6"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  strokeLinecap="round"
                  strokeLinejoin="round"
                  strokeWidth="2"
                  d="M6 18L18 6M6 6l12 12"
                />
              </svg>
            </button>
          </div>

          {/* Common Widget Settings */}
          <div className="space-y-4 mb-6">
            <div>
              <label className="block text-sm font-medium text-gray-700">
                Widget Title
              </label>
              <input
                type="text"
                value={editingWidget.title}
                onChange={(e) =>
                  setEditingWidget({ ...editingWidget, title: e.target.value })
                }
                className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
              />
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700">
                Display Order
              </label>
              <input
                type="number"
                value={editingWidget.order}
                onChange={(e) =>
                  setEditingWidget({
                    ...editingWidget,
                    order: parseInt(e.target.value),
                  })
                }
                className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                min="0"
              />
            </div>
          </div>

          {/* Widget-specific Editor */}
          {renderWidgetTypeEditor()}

          {/* Action Buttons */}
          <div className="mt-6 flex justify-end space-x-3">
            <button
              onClick={onCancel}
              className="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50"
            >
              Cancel
            </button>
            <button
              onClick={handleSave}
              className="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700"
            >
              Save Changes
            </button>
          </div>
        </div>
      </div>
    </div>
  )
}

================
File: app/admin/dashboard/page.tsx
================
//app/admin/dashboard/page.tsx
'use client'

import { useState, useEffect, useCallback } from 'react'
import { useAuth } from '@/contexts/AuthContext'
import { useRouter } from 'next/navigation'
import { db } from '@/lib/firebaseConfig'
import {
  collection,
  doc,
  setDoc,
  onSnapshot,
  DocumentData,
} from 'firebase/firestore'
import ChartersManager from '../components/ChartersManager'
import ServicesManager from '../components/ServicesManager'
import FlightTabsManager from '../components/FlightTabsManager'
import type { Charter, Service } from '@/types/flight'
import type {
  FlightTab,
  Promotion,
  Announcement,
  DashboardData,
} from '@/types/dashboard'

// Initial dashboard metrics
const initialDashboardData: DashboardData = {
  totalFlights: 0,
  activePromotions: 0,
  activeAnnouncements: 0,
  recentBookings: 0,
  metrics: {
    daily: {
      bookings: 0,
      revenue: 0,
      visitors: 0,
    },
    weekly: {
      bookings: 0,
      revenue: 0,
      visitors: 0,
    },
    monthly: {
      bookings: 0,
      revenue: 0,
      visitors: 0,
    },
  },
}

type CollectionData = {
  services: Service[]
  charters: Charter[]
  flightTabs: FlightTab[]
  promotions: Promotion[]
  announcements: Announcement[]
}

type CollectionType = keyof CollectionData

const transformDoc = (doc: DocumentData) => {
  const data = doc.data()
  return {
    id: doc.id,
    ...data,
    ...(data.validFrom && {
      validFrom: data.validFrom.toDate(),
    }),
    ...(data.validUntil && {
      validUntil: data.validUntil.toDate(),
    }),
  }
}

export default function AdminDashboard() {
  const { user, loading, isAdmin, signOut } = useAuth()
  const router = useRouter()

  // State Management
  const [activeSection, setActiveSection] = useState<string>('overview')
  const [services, setServices] = useState<Service[]>([])
  const [charters, setCharters] = useState<Charter[]>([])
  const [flightTabs, setFlightTabs] = useState<FlightTab[]>([])
  const [promotions, setPromotions] = useState<Promotion[]>([])
  const [announcements, setAnnouncements] = useState<Announcement[]>([])
  const [dashboardData, setDashboardData] =
    useState<DashboardData>(initialDashboardData)
  const [isLoading, setIsLoading] = useState(true)
  const [error, setError] = useState<string | null>(null)
  const [isSaving, setIsSaving] = useState(false)

  // Navigation Items
  const navigationItems = [
    { id: 'overview', label: 'Overview', icon: 'ChartPieIcon' },
    { id: 'flight-tabs', label: 'Flight Tabs', icon: 'TableCellsIcon' },
    { id: 'charters', label: 'Charters', icon: 'AirplaneIcon' },
    { id: 'services', label: 'Services', icon: 'BuildingStorefrontIcon' },
    { id: 'settings', label: 'Settings', icon: 'Cog6ToothIcon' },
  ]

  // Generic save handler for collections
  const handleSave = async (
    collectionName: string,
    data: any,
    id: string
  ): Promise<void> => {
    setIsSaving(true)
    try {
      const docRef = doc(db, collectionName, id)
      await setDoc(docRef, data, { merge: true })
    } catch (error) {
      setError(`Error saving ${collectionName}: ${error}`)
      throw error
    } finally {
      setIsSaving(false)
    }
  }

  // Collection-specific save handlers
  const handleSaveCharters = useCallback(async (updatedCharters: Charter[]) => {
    try {
      await Promise.all(
        updatedCharters.map((charter) =>
          handleSave('charters', charter, charter.id)
        )
      )
    } catch (error) {
      setError('Error saving charters')
    }
  }, [])

  const handleSaveServices = useCallback(async (updatedServices: Service[]) => {
    try {
      await Promise.all(
        updatedServices.map((service) =>
          handleSave('services', service, service.id)
        )
      )
    } catch (error) {
      setError('Error saving services')
    }
  }, [])

  const handleSaveFlightTabs = useCallback(async (tabs: FlightTab[]) => {
    try {
      await handleSave('flightTabs', { tabs }, 'flightTabs')
    } catch (error) {
      setError('Error saving flight tabs')
    }
  }, [])

  // Fetch Firestore Data
  useEffect(() => {
    if (!user || !isAdmin) return

    // Handle regular collections
    const regularCollections = [
      { name: 'services', setter: setServices },
      { name: 'charters', setter: setCharters },
      { name: 'promotions', setter: setPromotions },
      { name: 'announcements', setter: setAnnouncements },
    ]

    const unsubscribers = regularCollections.map(({ name, setter }) =>
      onSnapshot(
        collection(db, name),
        (snapshot) => {
          const data = snapshot.docs.map(transformDoc)
          setter(data)
        },
        (error) => {
          console.error(`Error fetching ${name}:`, error)
          setError(`Error loading ${name}`)
        }
      )
    )

    // Handle flightTabs separately since it's a single document with an array
    const flightTabsUnsubscriber = onSnapshot(
      doc(db, 'flightTabs', 'flightTabs'),
      (snapshot) => {
        const data = snapshot.data()
        if (data && Array.isArray(data.tabs)) {
          setFlightTabs(
            data.tabs.map((tab) => ({
              ...tab,
              widgets: tab.widgets || [], // Ensure widgets is always an array
            }))
          )
        } else {
          setFlightTabs([]) // Set empty array if no data
        }
      },
      (error) => {
        console.error('Error fetching flight tabs:', error)
        setError('Error loading flight tabs')
      }
    )

    setIsLoading(false)

    return () => {
      unsubscribers.forEach((unsubscribe) => unsubscribe())
      flightTabsUnsubscriber()
    }
  }, [user, isAdmin])

  // Auth check effect
  useEffect(() => {
    if (!loading) {
      if (!user || !isAdmin) {
        router.replace('/admin/auth/login')
      }
    }
  }, [user, isAdmin, loading, router])

  // Loading check
  if (loading || isLoading) {
    return (
      <div className="flex justify-center items-center min-h-screen bg-gray-100">
        <div className="text-xl text-gray-600">Loading...</div>
      </div>
    )
  }

  // If not authenticated, render nothing while redirecting
  if (!user || !isAdmin) {
    return null
  }

  const renderActiveSection = () => {
    switch (activeSection) {
      case 'flight-tabs':
        return (
          <FlightTabsManager
            tabs={flightTabs}
            onUpdate={handleSaveFlightTabs}
          />
        )
      case 'charters':
        return (
          <ChartersManager charters={charters} onUpdate={handleSaveCharters} />
        )
      case 'services':
        return (
          <ServicesManager services={services} onUpdate={handleSaveServices} />
        )
      default:
        return null
    }
  }

  return (
    <div className="min-h-screen bg-gray-100">
      {/* Header */}
      <header className="bg-white shadow-sm sticky top-0 z-50">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
          <div className="flex justify-between items-center">
            <h1 className="text-2xl font-bold text-gray-900">
              CaribeFly Admin
            </h1>
            <div className="flex items-center space-x-4">
              <span className="text-sm text-gray-500">
                Logged in as: <span className="font-medium">{user.email}</span>
              </span>
              <button
                onClick={() => signOut()}
                className="px-4 py-2 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 transition"
              >
                Logout
              </button>
            </div>
          </div>
        </div>
      </header>

      <div className="flex h-[calc(100vh-4rem)]">
        {/* Sidebar Navigation */}
        <aside className="w-64 bg-white shadow-sm">
          <nav className="mt-5 px-2">
            <div className="space-y-1">
              {navigationItems.map((item) => (
                <button
                  key={item.id}
                  onClick={() => setActiveSection(item.id)}
                  className={`w-full group flex items-center px-2 py-2 text-sm font-medium rounded-md ${
                    activeSection === item.id
                      ? 'bg-blue-50 text-blue-600'
                      : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900'
                  }`}
                >
                  <span className="truncate">{item.label}</span>
                </button>
              ))}
            </div>
          </nav>
        </aside>

        {/* Main Content */}
        <main className="flex-1 overflow-y-auto bg-gray-50 p-6">
          {/* Notifications */}
          {error && (
            <div className="mb-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative">
              <strong className="font-bold">Error!</strong>
              <span className="block sm:inline"> {error}</span>
            </div>
          )}

          {isSaving && (
            <div className="mb-6 bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded relative">
              <span className="block sm:inline">Saving changes...</span>
            </div>
          )}

          {/* Active Section Content */}
          <div className="bg-white rounded-lg shadow">
            {renderActiveSection()}
          </div>
        </main>
      </div>
    </div>
  )
}

================
File: app/admin/layout.tsx
================
'use client'

import React from 'react'
import { usePathname } from 'next/navigation'
import Link from 'next/link'

const AdminLayout = ({ children }: { children: React.ReactNode }) => {
  const pathname = usePathname()

  // Don't show navigation for auth pages
  if (pathname?.startsWith('/admin/auth')) {
    return <>{children}</>
  }

  const navigation = [
    { name: 'Dashboard', href: '/admin/dashboard' },
    { name: 'Charter Editor', href: '/admin/charter-editor' },
  ]

  return (
    <div className="min-h-screen bg-gray-900">
      {/* Navigation */}
      <nav className="bg-gray-800">
        <div className="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
          <div className="flex h-16 items-center justify-between">
            <div className="flex items-center">
              <div className="flex-shrink-0">
                <span className="text-xl font-bold text-white">
                  CaribeFly Admin
                </span>
              </div>
              <div className="hidden md:block">
                <div className="ml-10 flex items-baseline space-x-4">
                  {navigation.map((item) => {
                    const isActive = pathname === item.href
                    return (
                      <Link
                        key={item.name}
                        href={item.href}
                        className={`${
                          isActive
                            ? 'bg-gray-900 text-white'
                            : 'text-gray-300 hover:bg-gray-700 hover:text-white'
                        } rounded-md px-3 py-2 text-sm font-medium`}
                        aria-current={isActive ? 'page' : undefined}
                      >
                        {item.name}
                      </Link>
                    )
                  })}
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>

      {/* Main content */}
      <main className="py-10">
        <div className="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">{children}</div>
      </main>
    </div>
  )
}

export default AdminLayout

================
File: app/admin/page.tsx
================
'use client'

import { useEffect } from 'react'
import { useRouter } from 'next/navigation'

export default function AdminPage() {
  const router = useRouter()

  useEffect(() => {
    router.push('/admin/dashboard')
  }, [router])

  return null
}

================
File: app/components/flight-section/Announcements.tsx
================
// app/components/flight-section/Announcements.tsx
'use client'

import { Announcement } from '@/types/dashboard'

interface AnnouncementsProps {
  announcements: Announcement[]
}

export default function Announcements({ announcements }: AnnouncementsProps) {
  const activeAnnouncements = announcements.filter(
    (announcement) =>
      announcement.active &&
      new Date() >= new Date(announcement.validFrom) &&
      new Date() <= new Date(announcement.validUntil)
  )

  if (activeAnnouncements.length === 0) {
    return null
  }

  return (
    <div className="space-y-4">
      {activeAnnouncements.map((announcement) => (
        <div
          key={announcement.id}
          className={`p-4 rounded-lg ${
            announcement.type === 'alert'
              ? 'bg-red-50 border-l-4 border-red-500'
              : announcement.type === 'warning'
                ? 'bg-yellow-50 border-l-4 border-yellow-500'
                : 'bg-blue-50 border-l-4 border-blue-500'
          }`}
        >
          <div className="flex justify-between items-start">
            <div>
              <h4 className="font-semibold text-gray-900">
                {announcement.title}
              </h4>
              <p className="text-gray-800 mt-1">{announcement.content}</p>
            </div>
            <span
              className={`px-2 py-1 text-xs rounded-full ${
                announcement.priority === 'high'
                  ? 'bg-red-100 text-red-800'
                  : announcement.priority === 'normal'
                    ? 'bg-yellow-100 text-yellow-800'
                    : 'bg-green-100 text-green-800'
              }`}
            >
              {announcement.priority}
            </span>
          </div>
        </div>
      ))}
    </div>
  )
}

================
File: app/components/flight-section/FlightTabContent.tsx
================
// app/components/flight-section/FlightTabContent.tsx
'use client'

import { FlightTab, Widget } from '@/types/dashboard'
import PriceChart from './PriceChart'
import Promotions from './Promotions'
import Announcements from './Announcements'

interface FlightTabContentProps {
  tab: FlightTab
  data: {
    charters: any[]
    promotions: any[]
    announcements: any[]
  }
}

export default function FlightTabContent({ tab, data }: FlightTabContentProps) {
  const renderWidget = (widget: Widget) => {
    switch (widget.type) {
      case 'priceChart':
        return (
          <PriceChart
            charters={data.charters}
            autoUpdate={widget.settings?.autoUpdate}
          />
        )
      case 'promotionImage':
        return <Promotions images={data.promotions} />
      case 'announcement':
        return <Announcements announcements={data.announcements} />
      default:
        return null
    }
  }

  return (
    <div className="space-y-6">
      {tab.widgets
        .sort((a, b) => a.order - b.order)
        .map((widget) => (
          <div key={widget.id} className="bg-white rounded-lg shadow p-4">
            <h2 className="text-xl font-semibold mb-4">{widget.title}</h2>
            {renderWidget(widget)}
          </div>
        ))}
    </div>
  )
}

================
File: app/components/flight-section/PriceChart.tsx
================
import React from 'react'
import { Charter } from '@/types/flight'

interface PriceChartProps {
  charters: Charter[]
  autoUpdate?: boolean
}

export default function PriceChart({
  charters,
  autoUpdate = false,
}: PriceChartProps) {
  return (
    <div className="bg-white rounded-lg shadow-md p-4">
      <div className="overflow-x-auto">
        <table className="min-w-full">
          <thead>
            <tr>
              <th className="px-4 py-2 text-left">Charter</th>
              <th className="px-4 py-2 text-left">Route</th>
              <th className="px-4 py-2 text-right">Price</th>
              <th className="px-4 py-2 text-center">Last Updated</th>
            </tr>
          </thead>
          <tbody>
            {charters.map((charter) =>
              charter.flights?.map((flight, index) => (
                <tr key={`${charter.id}-${index}`} className="border-t">
                  <td className="px-4 py-2">{charter.title}</td>
                  <td className="px-4 py-2">{flight.route}</td>
                  <td className="px-4 py-2 text-right">{flight.price}</td>
                  <td className="px-4 py-2 text-center text-sm text-gray-500">
                    {new Date().toLocaleDateString()}
                  </td>
                </tr>
              ))
            )}
          </tbody>
        </table>
      </div>
    </div>
  )
}

================
File: app/components/flights/DestinationTabs.tsx
================
'use client'

import { useState } from 'react'
import { DESTINATIONS } from '@/constants/defaults'
import PriceDisplay from './PriceDisplay'

export default function DestinationTabs() {
  const [activeDestination, setActiveDestination] = useState(
    DESTINATIONS[0].code
  )

  return (
    <div className="destination-tabs">
      {/* Tabs Navigation */}
      <div className="bg-white shadow-sm mb-6">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex space-x-8 overflow-x-auto">
            {DESTINATIONS.map((dest) => (
              <button
                key={dest.code}
                onClick={() => setActiveDestination(dest.code)}
                className={`
                  py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap
                  ${
                    activeDestination === dest.code
                      ? 'border-blue-500 text-blue-600'
                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                  }
                `}
              >
                {dest.name}
              </button>
            ))}
          </div>
        </div>
      </div>

      {/* Price Display */}
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <PriceDisplay destinationCode={activeDestination} />
      </div>
    </div>
  )
}

================
File: app/components/flights/FlightTabContent.tsx
================
'use client'

import type { FlightTab } from '@/types/dashboard'
import type { Charter, Promotion, Announcement } from '@/types/flight'
import { Card } from '../../../admin/components/ui/card'

interface FlightTabContentProps {
  tab: FlightTab
  data: any // Replace with proper type once data structure is finalized
}

export default function FlightTabContent({ tab, data }: FlightTabContentProps) {
  return (
    <div className="flight-tab-content">
      <div className="mb-6">
        <h3 className="text-xl font-semibold mb-2">{tab.title}</h3>
        <p className="text-gray-600">{tab.description}</p>
      </div>

      {/* Flight Information */}
      <div className="grid gap-4">
        {data?.flights?.map((flight: any, index: number) => (
          <div
            key={index}
            className="bg-white p-4 rounded-lg shadow hover:shadow-md transition"
          >
            <div className="flex justify-between items-center mb-2">
              <div>
                <span className="font-medium">{flight.airline}</span>
                <span className="text-gray-500 mx-2">•</span>
                <span className="text-sm text-gray-600">
                  Flight {flight.flightNumber}
                </span>
              </div>
              <div className="text-lg font-semibold text-blue-600">
                ${flight.price}
              </div>
            </div>

            <div className="grid grid-cols-3 gap-4 text-sm">
              <div>
                <div className="text-gray-500">Departure</div>
                <div className="font-medium">{flight.departureTime}</div>
                <div className="text-gray-600">{flight.origin}</div>
              </div>
              <div className="flex items-center justify-center">
                <div className="text-gray-400">
                  {flight.duration}
                  <div className="border-t border-gray-300 my-1"></div>
                  <div className="text-xs text-center">Direct</div>
                </div>
              </div>
              <div>
                <div className="text-gray-500">Arrival</div>
                <div className="font-medium">{flight.arrivalTime}</div>
                <div className="text-gray-600">{flight.destination}</div>
              </div>
            </div>

            {/* Additional Flight Info */}
            <div className="mt-4 pt-4 border-t grid grid-cols-2 gap-4 text-sm">
              <div>
                <div className="text-gray-500">Baggage Allowance</div>
                <div>{flight.baggage}</div>
              </div>
              <div>
                <div className="text-gray-500">Aircraft</div>
                <div>{flight.aircraft}</div>
              </div>
            </div>

            {/* Book Button */}
            <div className="mt-4">
              <button className="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition">
                Select Flight
              </button>
            </div>
          </div>
        ))}
      </div>
    </div>
  )
}

================
File: app/components/flights/PriceDisplay.tsx
================
'use client'

import { useState, useEffect } from 'react'
import { db } from '@/lib/firebaseConfig'
import { collection, onSnapshot, doc, getDoc } from 'firebase/firestore'
import type { CharterData, GlobalProfit } from '@/types/charter'
import { DESTINATIONS } from '@/constants/defaults'
import PriceSheet from '@/app/admin/charter-editor/components/PriceSheet'

interface PriceDisplayProps {
  destinationCode: string
}

export default function PriceDisplay({ destinationCode }: PriceDisplayProps) {
  const [charters, setCharters] = useState<CharterData[]>([])
  const [globalProfit, setGlobalProfit] = useState<GlobalProfit>({
    percentage: 0,
    fixedAmount: 0,
    usePercentage: true,
  })
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    // Subscribe to charter data changes
    const unsubscribe = onSnapshot(
      collection(db, 'charters'),
      (snapshot) => {
        const charterData = snapshot.docs.map((doc) => ({
          id: doc.id,
          ...doc.data(),
        })) as CharterData[]

        setCharters(charterData)
        setLoading(false)
      },
      (error) => {
        console.error('Error fetching charters:', error)
        setLoading(false)
      }
    )

    // Fetch global profit settings
    const fetchGlobalProfit = async () => {
      try {
        const profitDoc = await getDoc(doc(db, 'settings', 'globalProfit'))
        if (profitDoc.exists()) {
          setGlobalProfit(profitDoc.data() as GlobalProfit)
        }
      } catch (error) {
        console.error('Error fetching global profit:', error)
      }
    }

    fetchGlobalProfit()
    return () => unsubscribe()
  }, [])

  const selectedDestInfo = DESTINATIONS.find((d) => d.code === destinationCode)

  if (loading) {
    return (
      <div className="flex items-center justify-center p-8">
        <div className="text-xl text-gray-600">Loading prices...</div>
      </div>
    )
  }

  if (!selectedDestInfo) {
    return (
      <div className="flex items-center justify-center p-8">
        <div className="text-xl text-red-600">Destination not found</div>
      </div>
    )
  }

  return (
    <div className="price-display">
      <PriceSheet
        charters={charters}
        globalProfit={globalProfit}
        selectedDestination={destinationCode}
        onUpdate={() => {}} // No-op since this is read-only
        readOnly={true}
      />
    </div>
  )
}

================
File: app/components/layout/Footer.tsx
================
export default function Footer() {
  return (
    <footer
      className="mt-10 md:mt-16 bg-blue-600 text-white py-4 text-center text-sm md:text-base"
      role="contentinfo"
    >
      <div className="container mx-auto px-4">
        <p>
          {new Date().getFullYear()} CaribeFly - Your Travel Partner to Cuba
        </p>
        <nav className="mt-2" role="navigation" aria-label="Footer Navigation">
          <ul className="flex justify-center space-x-4">
            <li>
              <a href="/about" className="hover:underline">
                About Us
              </a>
            </li>
            <li>
              <a href="/contact" className="hover:underline">
                Contact
              </a>
            </li>
            <li>
              <a href="/privacy" className="hover:underline">
                Privacy Policy
              </a>
            </li>
            <li>
              <a href="/terms" className="hover:underline">
                Terms of Service
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </footer>
  )
}

================
File: app/components/layout/Header.tsx
================
'use client'

import { useRouter } from 'next/navigation'
import Link from 'next/link'

export default function Header() {
  const router = useRouter()

  return (
    <header
      className="flex flex-col md:flex-row justify-between items-center px-4 md:px-6 py-4 bg-white shadow-md"
      role="banner"
    >
      <h1 className="text-2xl font-bold text-blue-600 text-center md:text-left">
        <Link
          href="/"
          className="hover:text-blue-700 transition"
          aria-label="CaribeFly Home"
        >
          CaribeFly
        </Link>
      </h1>
      <nav
        className="mt-2 md:mt-0 space-x-2 flex justify-center"
        role="navigation"
      >
        <button
          onClick={() => router.push('/login')}
          className="px-4 py-2 bg-gray-100 text-gray-800 rounded-lg hover:bg-gray-200 transition"
          aria-label="Log in to your account"
        >
          Log In
        </button>
        <button
          onClick={() => router.push('/signup')}
          className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"
          aria-label="Create a new account"
        >
          Sign Up
        </button>
      </nav>
    </header>
  )
}

================
File: app/components/services/ServiceTabs.tsx
================
'use client'

import { Service } from '@/types/flight'

interface ServiceTabsProps {
  services: Service[]
  activeTab: string
  onTabChange: (tabId: string) => void
}

export default function ServiceTabs({
  services,
  activeTab,
  onTabChange,
}: ServiceTabsProps) {
  return (
    <div
      className="flex overflow-x-auto space-x-2 md:space-x-4 mb-4 md:mb-6 justify-start snap-x snap-mandatory"
      role="tablist"
      aria-label="Service categories"
    >
      {services.map((service) => (
        <button
          key={service.id}
          role="tab"
          aria-selected={activeTab === service.id}
          aria-controls={`${service.id}-panel`}
          id={`${service.id}-tab`}
          className={`px-4 md:px-6 py-2 md:py-3 rounded-lg text-sm md:text-lg font-semibold transition whitespace-nowrap snap-start focus:outline-none focus:ring-2 focus:ring-blue-500 ${
            activeTab === service.id
              ? 'bg-blue-600 text-white shadow-md'
              : 'bg-gray-100 text-gray-800 hover:bg-gray-200'
          }`}
          onClick={() => onTabChange(service.id)}
        >
          {service.title}
        </button>
      ))}
    </div>
  )
}

================
File: app/components/ui/button.tsx
================
'use client'

import * as React from 'react'
import { cn } from '@/lib/utils'

interface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: 'primary' | 'secondary'
  as?: 'button' | 'span'
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  (
    { className, variant = 'primary', as = 'button', children, ...props },
    ref
  ) => {
    const Component = as

    const baseClasses =
      'inline-flex items-center justify-center rounded-md px-4 py-2 text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none'

    const variantClasses = {
      primary: 'bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500',
      secondary: 'bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500',
    }

    return (
      <Component
        className={cn(baseClasses, variantClasses[variant], className)}
        ref={ref}
        {...props}
      >
        {children}
      </Component>
    )
  }
)

Button.displayName = 'Button'

export { Button }

================
File: app/components/ui/toast.tsx
================
'use client'

import { useEffect, useState } from 'react'
import { cn } from '@/lib/utils'
import type { NotificationType } from '@/types/charter'

interface ToastProps {
  type: NotificationType
  message: string
  onClose?: () => void
}

const Toast = ({ type, message, onClose }: ToastProps) => {
  const [isVisible, setIsVisible] = useState(true)

  useEffect(() => {
    const timer = setTimeout(() => {
      setIsVisible(false)
      onClose?.()
    }, 3000)

    return () => clearTimeout(timer)
  }, [onClose])

  const baseClasses =
    'fixed top-4 right-4 p-4 rounded-md shadow-lg transition-opacity duration-300'
  const typeClasses = {
    success: 'bg-green-600 text-white',
    error: 'bg-red-600 text-white',
    warning: 'bg-yellow-500 text-white',
  }

  if (!isVisible) return null

  return (
    <div
      className={cn(
        baseClasses,
        typeClasses[type],
        isVisible ? 'opacity-100' : 'opacity-0'
      )}
      role="alert"
    >
      <div className="flex items-center gap-2">
        {type === 'success' && (
          <svg
            className="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              strokeLinecap="round"
              strokeLinejoin="round"
              strokeWidth="2"
              d="M5 13l4 4L19 7"
            />
          </svg>
        )}
        {type === 'error' && (
          <svg
            className="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              strokeLinecap="round"
              strokeLinejoin="round"
              strokeWidth="2"
              d="M6 18L18 6M6 6l12 12"
            />
          </svg>
        )}
        {type === 'warning' && (
          <svg
            className="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              strokeLinecap="round"
              strokeLinejoin="round"
              strokeWidth="2"
              d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
            />
          </svg>
        )}
        <span>{message}</span>
      </div>
    </div>
  )
}

export default Toast

================
File: app/components/widgets/AnnouncementCard.tsx
================
'use client'

import React from 'react'
import { Widget } from '@/types/dashboard'

interface AnnouncementContent {
  title: string
  content: string
  type: 'info' | 'warning' | 'alert'
  priority: 'high' | 'normal' | 'low'
}

export const AnnouncementCard: React.FC<Widget> = ({ content }) => {
  const announcement = content as AnnouncementContent

  const getBgColor = () => {
    switch (announcement.type) {
      case 'warning':
        return 'bg-yellow-50 border-yellow-200'
      case 'alert':
        return 'bg-red-50 border-red-200'
      default:
        return 'bg-blue-50 border-blue-200'
    }
  }

  const getTextColor = () => {
    switch (announcement.type) {
      case 'warning':
        return 'text-yellow-800'
      case 'alert':
        return 'text-red-800'
      default:
        return 'text-blue-800'
    }
  }

  const getPriorityBadgeColor = () => {
    switch (announcement.priority) {
      case 'high':
        return 'bg-red-100 text-red-800'
      case 'low':
        return 'bg-green-100 text-green-800'
      default:
        return 'bg-gray-100 text-gray-800'
    }
  }

  return (
    <div className={`p-4 rounded-lg border ${getBgColor()} ${getTextColor()}`}>
      <div className="flex justify-between items-start mb-2">
        <h3 className="text-lg font-semibold">{announcement.title}</h3>
        <span
          className={`px-2 py-1 rounded-full text-xs font-medium ${getPriorityBadgeColor()}`}
        >
          {announcement.priority}
        </span>
      </div>
      <p className="text-sm">{announcement.content}</p>
    </div>
  )
}

================
File: app/components/widgets/PriceChart.tsx
================
'use client'

import React from 'react'
import { PriceChartWidget } from '@/types/dashboard'

export const PriceChart: React.FC<PriceChartWidget> = ({ content }) => {
  const { prices } = content

  return (
    <div className="space-y-4">
      <h3 className="text-lg font-semibold">Price History</h3>
      <div className="space-y-2">
        {prices.map((price, index) => (
          <div
            key={index}
            className="flex justify-between items-center p-2 bg-gray-50 rounded"
          >
            <div className="flex items-center space-x-2">
              <span className="text-sm font-medium">{price.charter}</span>
              <span className="text-xs text-gray-500">{price.route}</span>
            </div>
            <div className="flex items-center space-x-2">
              <span className="text-sm font-bold">${price.price}</span>
              <span className="text-xs text-gray-500">
                {new Date(price.lastUpdated).toLocaleDateString()}
              </span>
            </div>
          </div>
        ))}
      </div>
    </div>
  )
}

================
File: app/components/widgets/PromotionCard.tsx
================
'use client'

import React from 'react'
import Image from 'next/image'
import Link from 'next/link'
import { PromotionWidget } from '@/types/dashboard'

export const PromotionCard: React.FC<PromotionWidget> = ({ content }) => {
  const { imageUrl, link, validUntil } = content

  return (
    <div className="relative overflow-hidden rounded-lg">
      <div className="aspect-video relative">
        <Image
          src={imageUrl}
          alt="Promotion"
          fill
          className="object-cover"
          sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
        />
      </div>
      {validUntil && (
        <div className="absolute top-2 right-2 bg-black/70 text-white px-2 py-1 rounded text-xs">
          Valid until {new Date(validUntil).toLocaleDateString()}
        </div>
      )}
      {link && (
        <Link
          href={link}
          className="absolute inset-0 flex items-center justify-center bg-black/40 opacity-0 hover:opacity-100 transition-opacity"
        >
          <span className="bg-white text-black px-4 py-2 rounded-full text-sm font-medium">
            Learn More
          </span>
        </Link>
      )}
    </div>
  )
}

================
File: app/components/DestinationTabs.tsx
================
'use client'

import React from 'react'
import type { FlightTab } from '@/types/dashboard'

interface DestinationTabsProps {
  tabs: FlightTab[]
  activeTab: string
  onTabChange: (tabId: string) => void
}

const DestinationTabs: React.FC<DestinationTabsProps> = ({
  tabs,
  activeTab,
  onTabChange,
}) => {
  return (
    <div className="flex space-x-1 rounded-xl bg-gray-900/20 p-1">
      {tabs.map((tab) => (
        <button
          key={tab.id}
          onClick={() => onTabChange(tab.id)}
          className={`w-full rounded-lg py-2.5 text-sm font-medium leading-5
            ${
              activeTab === tab.id
                ? 'bg-white text-gray-900 shadow'
                : 'text-gray-100 hover:bg-white/[0.12] hover:text-white'
            }
          `}
        >
          {tab.name}
        </button>
      ))}
    </div>
  )
}

export default DestinationTabs

================
File: app/components/FlightCard.tsx
================
'use client'

import { Charter, FlightAvailability } from '@/types/flight'
import { format } from 'date-fns'

interface FlightCardProps {
  charter: Charter
  availability: FlightAvailability
  onSelect: (charter: Charter, availability: FlightAvailability) => void
}

export default function FlightCard({
  charter,
  availability,
  onSelect,
}: FlightCardProps) {
  const formatTime = (time: string) =>
    format(new Date(`2000-01-01T${time}`), 'h:mm a')

  return (
    <div className="bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200">
      {/* Charter Header */}
      <div className="p-4 border-b bg-gray-50">
        <div className="flex justify-between items-center">
          <div>
            <h3 className="text-lg font-semibold">{charter.title}</h3>
            <p className="text-sm text-gray-600">
              Flight {availability.schedule.flightNumber}
            </p>
          </div>
          <div className="text-right">
            <p className="text-2xl font-bold text-blue-600">
              ${availability.pricing.regular.total}
            </p>
            <p className="text-xs text-gray-500">includes taxes and fees</p>
          </div>
        </div>
      </div>

      {/* Flight Details */}
      <div className="p-4">
        <div className="flex justify-between items-center mb-4">
          <div className="text-center">
            <p className="text-2xl font-bold">
              {formatTime(availability.schedule.departure)}
            </p>
            <p className="text-sm text-gray-600">
              {charter.routes[0].from.code}
            </p>
          </div>
          <div className="flex-1 px-4">
            <div className="relative">
              <div className="border-t-2 border-gray-300 w-full absolute top-1/2"></div>
              <div className="text-xs text-center text-gray-500 relative -top-2">
                Direct Flight
              </div>
            </div>
          </div>
          <div className="text-center">
            <p className="text-2xl font-bold">
              {formatTime(availability.schedule.arrival)}
            </p>
            <p className="text-sm text-gray-600">{charter.routes[0].to.code}</p>
          </div>
        </div>

        {/* Status and Seats */}
        <div className="flex justify-between items-center mb-4">
          <span
            className={`px-3 py-1 rounded-full text-sm ${
              availability.status === 'AVAILABLE'
                ? 'bg-green-100 text-green-800'
                : availability.status === 'LIMITED'
                  ? 'bg-yellow-100 text-yellow-800'
                  : 'bg-red-100 text-red-800'
            }`}
          >
            {availability.status}
          </span>
          <p className="text-sm text-gray-600">
            {availability.seatsAvailable} seats left at this price
          </p>
        </div>

        {/* Action Buttons */}
        <div className="flex space-x-2">
          <button
            onClick={() => onSelect(charter, availability)}
            className="flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 
                     transition disabled:opacity-50 disabled:cursor-not-allowed"
            disabled={availability.status === 'SOLD_OUT'}
          >
            Select Flight
          </button>
          <button
            className="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition"
            onClick={() => {
              /* Add fare details modal */
            }}
          >
            Fare Details
          </button>
        </div>
      </div>
    </div>
  )
}

================
File: app/components/FlightFilters.tsx
================
'use client'

interface FilterOptions {
  charter?: string
  maxPrice?: number
  departureTime?: 'morning' | 'afternoon' | 'evening'
  availabilityStatus?: 'AVAILABLE' | 'LIMITED' | 'SOLD_OUT'
}

interface FlightFiltersProps {
  onFilterChange: (filters: FilterOptions) => void
  availableCharters: string[]
  minPrice: number
  maxPrice: number
}

export default function FlightFilters({
  onFilterChange,
  availableCharters,
  minPrice,
  maxPrice,
}: FlightFiltersProps) {
  return (
    <div className="bg-white rounded-lg shadow p-4 space-y-4">
      <h3 className="font-semibold text-gray-900">Filters</h3>

      {/* Charter Filter */}
      <div>
        <label className="block text-sm font-medium text-gray-700">
          Charter
        </label>
        <select
          className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
          onChange={(e) => onFilterChange({ charter: e.target.value })}
        >
          <option value="">All Charters</option>
          {availableCharters.map((charter) => (
            <option key={charter} value={charter}>
              {charter}
            </option>
          ))}
        </select>
      </div>

      {/* Price Range */}
      <div>
        <label className="block text-sm font-medium text-gray-700">
          Max Price
        </label>
        <input
          type="range"
          min={minPrice}
          max={maxPrice}
          step="10"
          className="w-full"
          onChange={(e) => onFilterChange({ maxPrice: Number(e.target.value) })}
        />
      </div>

      {/* Departure Time */}
      <div>
        <label className="block text-sm font-medium text-gray-700">
          Departure Time
        </label>
        <div className="space-y-2">
          {['morning', 'afternoon', 'evening'].map((time) => (
            <label key={time} className="flex items-center">
              <input
                type="radio"
                name="departureTime"
                value={time}
                onChange={(e) =>
                  onFilterChange({
                    departureTime: e.target.value as
                      | 'morning'
                      | 'afternoon'
                      | 'evening',
                  })
                }
                className="form-radio"
              />
              <span className="ml-2 capitalize">{time}</span>
            </label>
          ))}
        </div>
      </div>

      {/* Availability */}
      <div>
        <label className="block text-sm font-medium text-gray-700">
          Availability
        </label>
        <select
          className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
          onChange={(e) =>
            onFilterChange({
              availabilityStatus: e.target.value as
                | 'AVAILABLE'
                | 'LIMITED'
                | 'SOLD_OUT',
            })
          }
        >
          <option value="">All</option>
          <option value="AVAILABLE">Available</option>
          <option value="LIMITED">Limited</option>
        </select>
      </div>
    </div>
  )
}

================
File: app/components/FlightSearch.tsx
================
//app/components/FlightSearch.tsx
'use client'

import { useState } from 'react'
import { format } from 'date-fns'
import type { SearchParams } from '@/types/flight'

interface FlightSearchProps {
  onSearch: (params: SearchParams) => void
  loading?: boolean
}

export default function FlightSearch({
  onSearch,
  loading = false,
}: FlightSearchProps) {
  const [searchParams, setSearchParams] = useState<SearchParams>({
    origin: 'MIA',
    destination: '',
    departureDate: new Date(),
    returnDate: undefined,
    passengers: 1,
    tripType: 'roundtrip',
  })

  const [showCalendar, setShowCalendar] = useState(false)

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault()
    onSearch(searchParams)
  }

  return (
    <form
      onSubmit={handleSubmit}
      className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"
    >
      {/* Trip Type Selection */}
      <div className="md:col-span-3 flex gap-4 justify-center">
        <label className="inline-flex items-center">
          <input
            type="radio"
            checked={searchParams.tripType === 'roundtrip'}
            onChange={() =>
              setSearchParams((prev) => ({ ...prev, tripType: 'roundtrip' }))
            }
            className="form-radio text-blue-600"
          />
          <span className="ml-2">Round Trip</span>
        </label>
        <label className="inline-flex items-center">
          <input
            type="radio"
            checked={searchParams.tripType === 'oneway'}
            onChange={() =>
              setSearchParams((prev) => ({ ...prev, tripType: 'oneway' }))
            }
            className="form-radio text-blue-600"
          />
          <span className="ml-2">One Way</span>
        </label>
      </div>

      {/* Origin & Destination */}
      <select
        value={searchParams.destination}
        onChange={(e) =>
          setSearchParams((prev) => ({ ...prev, destination: e.target.value }))
        }
        className="px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400"
        required
      >
        <option value="">Select Destination</option>
        <option value="HAV">Havana (HAV)</option>
        <option value="VRA">Varadero (VRA)</option>
        <option value="SNU">Santa Clara (SNU)</option>
        <option value="HOG">Holguin (HOG)</option>
        <option value="CMW">Camaguey (CMW)</option>
      </select>

      {/* Date Selection */}
      <div className="relative">
        <input
          type="date"
          value={format(searchParams.departureDate, 'yyyy-MM-dd')}
          onChange={(e) =>
            setSearchParams((prev) => ({
              ...prev,
              departureDate: new Date(e.target.value),
            }))
          }
          className="px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 w-full"
          required
        />
      </div>

      {/* Passengers */}
      <input
        type="number"
        min="1"
        max="9"
        value={searchParams.passengers}
        onChange={(e) =>
          setSearchParams((prev) => ({
            ...prev,
            passengers: parseInt(e.target.value),
          }))
        }
        className="px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400"
        required
      />

      {/* Search Button */}
      <button
        type="submit"
        disabled={loading}
        className="md:col-span-3 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50"
      >
        {loading ? 'Searching...' : 'Search Flights'}
      </button>
    </form>
  )
}

================
File: app/components/FlightSort.tsx
================
'use client'

export type SortOption = 'price' | 'departure' | 'availability' | 'charter'
export type SortDirection = 'asc' | 'desc'

interface FlightSortProps {
  onSort: (option: SortOption, direction: SortDirection) => void
  currentSort: {
    option: SortOption
    direction: SortDirection
  }
}

export default function FlightSort({ onSort, currentSort }: FlightSortProps) {
  return (
    <div className="bg-white rounded-lg shadow p-4">
      <div className="flex items-center space-x-4">
        <span className="text-sm font-medium text-gray-700">Sort by:</span>
        <div className="flex flex-wrap gap-2">
          {[
            { value: 'price', label: 'Price' },
            { value: 'departure', label: 'Departure Time' },
            { value: 'availability', label: 'Availability' },
            { value: 'charter', label: 'Charter' },
          ].map(({ value, label }) => (
            <button
              key={value}
              onClick={() =>
                onSort(
                  value as SortOption,
                  currentSort.option === value &&
                    currentSort.direction === 'asc'
                    ? 'desc'
                    : 'asc'
                )
              }
              className={`px-3 py-1 rounded-full text-sm flex items-center space-x-1
                ${
                  currentSort.option === value
                    ? 'bg-blue-100 text-blue-800'
                    : 'bg-gray-100 text-gray-800 hover:bg-gray-200'
                }`}
            >
              <span>{label}</span>
              {currentSort.option === value && (
                <svg
                  className={`w-4 h-4 transform ${
                    currentSort.direction === 'desc' ? 'rotate-180' : ''
                  }`}
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    strokeWidth={2}
                    d="M5 15l7-7 7 7"
                  />
                </svg>
              )}
            </button>
          ))}
        </div>
      </div>
    </div>
  )
}

================
File: app/components/Navigation.tsx
================
'use client'

import React from 'react'
import Link from 'next/link'
import { Button } from './ui'

const Navigation: React.FC = () => {
  return (
    <nav className="flex justify-between items-center w-full px-6 py-4 bg-white/90 backdrop-blur-sm">
      <Link href="/" className="text-2xl font-bold text-blue-600">
        CaribeFly
      </Link>
      <div className="flex items-center space-x-4">
        <Link href="/about" className="text-gray-600 hover:text-gray-900">
          About
        </Link>
        <Link href="/contact" className="text-gray-600 hover:text-gray-900">
          Contact
        </Link>
        <div className="flex items-center space-x-2">
          <Button variant="outline" size="sm">
            Log In
          </Button>
          <Button size="sm">Sign Up</Button>
        </div>
      </div>
    </nav>
  )
}

export default Navigation

================
File: app/components/ServiceTabs.tsx
================
'use client'

import React, { useState } from 'react'
import { TabSection, SubTab, Widget } from '@/types/dashboard'
import { PriceChart } from './widgets/PriceChart'
import { PromotionCard } from './widgets/PromotionCard'
import { AnnouncementCard } from './widgets/AnnouncementCard'

interface ServiceTabsProps {
  sections: TabSection[]
}

const ServiceTabs: React.FC<ServiceTabsProps> = ({ sections }) => {
  const [activeSection, setActiveSection] = useState<string>(
    sections[0]?.id || ''
  )
  const [activeSubTab, setActiveSubTab] = useState<string>(
    sections[0]?.subTabs[0]?.id || ''
  )

  const renderWidget = (widget: Widget) => {
    switch (widget.type) {
      case 'priceChart':
        return <PriceChart {...widget} />
      case 'promotionImage':
        return <PromotionCard {...widget} />
      case 'announcement':
        return <AnnouncementCard {...widget} />
      default:
        return null
    }
  }

  return (
    <div className="w-full">
      {/* Main Service Tabs */}
      <div className="flex space-x-1 rounded-xl bg-gray-900/20 p-1 mb-4">
        {sections.map((section) => (
          <button
            key={section.id}
            onClick={() => {
              setActiveSection(section.id)
              setActiveSubTab(section.subTabs[0]?.id || '')
            }}
            className={`w-full rounded-lg py-2.5 text-sm font-medium leading-5
              ${
                activeSection === section.id
                  ? 'bg-white text-gray-900 shadow'
                  : 'text-gray-100 hover:bg-white/[0.12] hover:text-white'
              }
            `}
          >
            {section.title}
          </button>
        ))}
      </div>

      {/* Sub Tabs */}
      {sections.map(
        (section) =>
          activeSection === section.id && (
            <div key={section.id} className="space-y-4">
              <div className="flex space-x-2 border-b border-gray-200">
                {section.subTabs.map((subTab) => (
                  <button
                    key={subTab.id}
                    onClick={() => setActiveSubTab(subTab.id)}
                    className={`px-4 py-2 text-sm font-medium border-b-2 transition-colors
                      ${
                        activeSubTab === subTab.id
                          ? 'border-blue-500 text-blue-600'
                          : 'border-transparent text-gray-500 hover:text-gray-700'
                      }
                    `}
                  >
                    {subTab.title}
                  </button>
                ))}
              </div>

              {/* Widget Content */}
              {section.subTabs.map(
                (subTab) =>
                  activeSubTab === subTab.id && (
                    <div
                      key={subTab.id}
                      className="grid grid-cols-1 md:grid-cols-2 gap-4"
                    >
                      {subTab.widgets.map((widget) => (
                        <div
                          key={widget.id}
                          className="bg-white rounded-lg shadow-lg p-4"
                        >
                          {renderWidget(widget)}
                        </div>
                      ))}
                    </div>
                  )
              )}
            </div>
          )
      )}
    </div>
  )
}

export default ServiceTabs

================
File: app/dashboard/page.tsx
================
//app/dashboard/page.tsx
'use client'

import { useAuth } from '../../hooks/useAuth'
import { useRouter } from 'next/navigation'
import { useEffect } from 'react'
import { signOut } from 'firebase/auth'
import { auth } from '../../lib/firebaseConfig'
import { destroyCookie } from 'nookies'

export default function Dashboard() {
  const user = useAuth()
  const router = useRouter()

  useEffect(() => {
    if (user === null) {
      router.push('/login')
    }
  }, [user, router])

  const handleLogout = async () => {
    await signOut(auth)
    destroyCookie(null, 'firebaseToken') // Clear the token
    router.push('/') // Redirect to home page instead of login
  }

  if (user === undefined) {
    return (
      <div className="flex justify-center items-center min-h-screen">
        Loading...
      </div>
    )
  }

  return (
    <div className="min-h-screen bg-gray-100">
      <div className="bg-blue-600 p-4 text-white text-center">
        <h1 className="text-4xl font-bold">Welcome to your Dashboard</h1>
        <p className="mt-2 text-xl">Hello, {user?.email}</p>
      </div>
      <div className="container mx-auto mt-10 p-4">
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div className="p-6 bg-white rounded-lg shadow-md">
            <h2 className="text-2xl font-semibold mb-4">Profile Overview</h2>
            <p className="text-gray-700">
              This section can display user-specific details in the future.
            </p>
          </div>
          <div className="p-6 bg-white rounded-lg shadow-md">
            <h2 className="text-2xl font-semibold mb-4">Settings</h2>
            <p className="text-gray-700">
              Adjust your account settings here (coming soon).
            </p>
          </div>
        </div>
        <div className="mt-10 text-center">
          <button
            onClick={handleLogout}
            className="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600"
          >
            Logout
          </button>
        </div>
      </div>
    </div>
  )
}

================
File: app/login/page.tsx
================
'use client'

import { useState } from 'react'
import { signInWithEmailAndPassword } from 'firebase/auth'
import { auth } from '../../lib/firebaseConfig'
import { useRouter } from 'next/navigation'
import { useAuth } from '../../contexts/AuthContext'
import Link from 'next/link'

export default function Login() {
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [error, setError] = useState<string | null>(null)
  const router = useRouter()
  const { loading } = useAuth()

  const handleLogin = async (e: React.FormEvent<HTMLFormElement>) => {
    e.preventDefault()
    try {
      await signInWithEmailAndPassword(auth, email, password)
      router.push('/dashboard')
    } catch (error) {
      setError('Invalid email or password. Please try again.')
      console.error('Login error', error)
    }
  }

  if (loading) {
    return (
      <div className="flex justify-center items-center min-h-screen">
        <div className="text-xl">Loading...</div>
      </div>
    )
  }

  return (
    <div className="flex items-center justify-center min-h-screen bg-gradient-to-br from-blue-600 to-purple-700">
      <div className="w-full max-w-md p-8 space-y-6 bg-white rounded-xl shadow-lg">
        <Link
          href="/"
          className="block text-sm text-blue-600 hover:underline mb-4"
        >
          ← Back to Home
        </Link>
        <h2 className="text-3xl font-extrabold text-center text-gray-900">
          Sign in to <span className="text-blue-600">CaribeFly</span>
        </h2>
        <form onSubmit={handleLogin} className="mt-8 space-y-4">
          <div>
            <label
              htmlFor="email"
              className="block text-sm font-medium text-gray-700"
            >
              Email address
            </label>
            <input
              id="email"
              name="email"
              type="email"
              required
              value={email}
              onChange={(e) => setEmail(e.target.value)}
              className="w-full px-4 py-2 mt-1 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
              placeholder="you@example.com"
            />
          </div>

          <div>
            <label
              htmlFor="password"
              className="block text-sm font-medium text-gray-700"
            >
              Password
            </label>
            <input
              id="password"
              name="password"
              type="password"
              required
              value={password}
              onChange={(e) => setPassword(e.target.value)}
              className="w-full px-4 py-2 mt-1 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
              placeholder="••••••••"
            />
          </div>

          <button
            type="submit"
            className="w-full py-3 mt-4 text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
          >
            Sign In
          </button>

          {error && <p className="mt-2 text-center text-red-500">{error}</p>}
        </form>

        <div className="flex items-center justify-between mt-6">
          <p className="text-sm text-gray-600">
            Dont have an account?{' '}
            <a
              href="/signup"
              className="font-medium text-blue-600 hover:underline"
            >
              Sign up
            </a>
          </p>
          <Link
            href="/admin/auth/login"
            className="text-sm font-medium text-blue-600 hover:underline"
          >
            Admin Login
          </Link>
        </div>
      </div>
    </div>
  )
}

================
File: app/search/page.tsx
================
'use client'

import { useState, useEffect } from 'react'
import { format, addMinutes, isBefore } from 'date-fns'
import { useSearchParams } from 'next/navigation'
import FlightCard from '../components/FlightCard'
import FlightFilters from '../components/FlightFilters'
import FlightSort, { SortOption, SortDirection } from '../components/FlightSort'
import type { Charter, FlightAvailability, FilterOptions } from '@/types/flight'
import { XaelService } from '@/lib/services/xael-service'

interface SearchState {
  results: Array<{
    charter: Charter
    availability: FlightAvailability
  }>
  loading: boolean
  error: string | null
  timestamp: Date
  searchParams: {
    origin: string
    destination: string
    date: string
    passengers: number
    tripType: 'oneway' | 'roundtrip'
  }
  filters: FilterOptions
  sort: {
    option: SortOption
    direction: SortDirection
  }
}

export default function SearchResults() {
  const searchParams = useSearchParams()
  const [searchState, setSearchState] = useState<SearchState>({
    results: [],
    loading: true,
    error: null,
    timestamp: new Date(),
    searchParams: {
      origin: searchParams.get('origin') || 'MIA',
      destination: searchParams.get('destination') || '',
      date: searchParams.get('date') || '',
      passengers: Number(searchParams.get('passengers')) || 1,
      tripType:
        (searchParams.get('tripType') as 'oneway' | 'roundtrip') || 'roundtrip',
    },
    filters: {},
    sort: {
      option: 'price',
      direction: 'asc',
    },
  })

  // Fetch flight results
  useEffect(() => {
    const fetchResults = async () => {
      try {
        const xaelService = new XaelService({
          username: process.env.NEXT_PUBLIC_XAEL_USERNAME!,
          password: process.env.NEXT_PUBLIC_XAEL_PASSWORD!,
        })

        const results = await xaelService.getAvailability(
          searchState.searchParams.origin,
          searchState.searchParams.destination,
          new Date(searchState.searchParams.date)
        )

        setSearchState((prev) => ({
          ...prev,
          results: results.map((availability) => ({
            charter: {
              id: 'xael',
              title: 'XAEL Charters',
              system: 'airmax',
              routes: [
                {
                  from: { code: 'MIA', city: 'Miami' },
                  to: {
                    code: searchState.searchParams.destination,
                    city: 'Destination City',
                  },
                },
              ],
              schedules: [],
              pricing: {},
            },
            availability,
          })),
          loading: false,
        }))

        await xaelService.cleanup()
      } catch (error) {
        setSearchState((prev) => ({
          ...prev,
          error: 'Error fetching flights. Please try again.',
          loading: false,
        }))
      }
    }

    fetchResults()
  }, [searchState.searchParams])

  // Apply filters and sorting
  const filteredAndSortedResults = [...searchState.results]
    .filter((result) => {
      const { filters } = searchState
      if (filters.charter && result.charter.id !== filters.charter) return false
      if (
        filters.maxPrice &&
        result.availability.pricing.regular.total > filters.maxPrice
      )
        return false
      if (
        filters.availabilityStatus &&
        result.availability.status !== filters.availabilityStatus
      )
        return false
      return true
    })
    .sort((a, b) => {
      const { option, direction } = searchState.sort
      const modifier = direction === 'asc' ? 1 : -1

      switch (option) {
        case 'price':
          return (
            (a.availability.pricing.regular.total -
              b.availability.pricing.regular.total) *
            modifier
          )
        case 'departure':
          return (
            (new Date(a.availability.schedule.departure).getTime() -
              new Date(b.availability.schedule.departure).getTime()) *
            modifier
          )
        case 'availability':
          return (
            (b.availability.seatsAvailable - a.availability.seatsAvailable) *
            modifier
          )
        case 'charter':
          return a.charter.title.localeCompare(b.charter.title) * modifier
        default:
          return 0
      }
    })

  // Calculate validity period (15 minutes)
  const validUntil = addMinutes(searchState.timestamp, 15)
  const [isValid, setIsValid] = useState(true)

  // Check result validity
  useEffect(() => {
    const checkValidity = () => {
      setIsValid(isBefore(new Date(), validUntil))
    }

    const timer = setInterval(checkValidity, 1000)
    return () => clearInterval(timer)
  }, [validUntil])

  return (
    <div className="min-h-screen bg-gray-50">
      {/* Header with search summary */}
      <header className="bg-white shadow">
        <div className="max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8">
          <div className="flex justify-between items-center">
            <div>
              <h1 className="text-2xl font-bold text-gray-900">
                Flight Results
              </h1>
              <p className="mt-1 text-sm text-gray-500">
                {searchState.searchParams.origin} to{' '}
                {searchState.searchParams.destination} •{' '}
                {format(
                  new Date(searchState.searchParams.date),
                  'MMM dd, yyyy'
                )}{' '}
                • {searchState.searchParams.passengers}{' '}
                {searchState.searchParams.passengers === 1
                  ? 'passenger'
                  : 'passengers'}
              </p>
            </div>
            {/* Validity timer */}
            <div
              className={`text-sm ${
                isValid ? 'text-green-600' : 'text-red-600'
              }`}
            >
              {isValid ? (
                <div>Results valid until: {format(validUntil, 'HH:mm:ss')}</div>
              ) : (
                <div className="flex items-center space-x-2">
                  <span>Results expired</span>
                  <button
                    onClick={() => window.location.reload()}
                    className="px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700"
                  >
                    Refresh
                  </button>
                </div>
              )}
            </div>
          </div>
        </div>
      </header>

      {/* Main content */}
      <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div className="grid grid-cols-4 gap-6">
          {/* Filters */}
          <div className="col-span-1">
            <FlightFilters
              onFilterChange={(filters: FilterOptions) =>
                setSearchState((prev) => ({
                  ...prev,
                  filters: { ...prev.filters, ...filters },
                }))
              }
              availableCharters={['xael', 'cubazul', 'invicta']}
              minPrice={0}
              maxPrice={1000}
            />
          </div>

          {/* Results */}
          <div className="col-span-3">
            <FlightSort
              onSort={(option: SortOption, direction: SortDirection) =>
                setSearchState((prev) => ({
                  ...prev,
                  sort: { option, direction },
                }))
              }
              currentSort={searchState.sort}
            />

            <div className="mt-4 space-y-4">
              {searchState.loading ? (
                <div className="flex justify-center items-center min-h-[400px]">
                  <div className="text-center">
                    <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div>
                    <p className="mt-4 text-gray-600">
                      Searching for flights...
                    </p>
                  </div>
                </div>
              ) : searchState.error ? (
                <div className="text-center text-red-600">
                  {searchState.error}
                </div>
              ) : (
                filteredAndSortedResults.map((result, index) => (
                  <FlightCard
                    key={`${result.charter.id}-${index}`}
                    charter={result.charter}
                    availability={result.availability}
                    onSelect={(
                      charter: Charter,
                      availability: FlightAvailability
                    ) => {
                      // Handle flight selection
                      console.log('Selected flight:', { charter, availability })
                    }}
                  />
                ))
              )}
            </div>
          </div>
        </div>
      </main>
    </div>
  )
}

================
File: app/signup/page.tsx
================
//app/signup/page.tsx
'use client'

import { useState } from 'react'
import { createUserWithEmailAndPassword } from 'firebase/auth'
import { auth } from '../../lib/firebaseConfig'
import { useRouter } from 'next/navigation'
import Link from 'next/link'

export default function Signup() {
  const [email, setEmail] = useState<string>('')
  const [password, setPassword] = useState<string>('')
  const [error, setError] = useState<string | null>(null)
  const router = useRouter()

  const handleSignup = async (e: React.FormEvent<HTMLFormElement>) => {
    e.preventDefault()
    setError(null) // Clear previous error messages
    try {
      await createUserWithEmailAndPassword(auth, email, password)
      router.push('/dashboard')
    } catch (error: any) {
      setError(error.message) // Display error message if signup fails
    }
  }

  return (
    <div className="flex items-center justify-center min-h-screen bg-gradient-to-br from-teal-500 to-blue-600">
      <div className="w-full max-w-md p-8 space-y-6 bg-white rounded-xl shadow-lg">
        <Link
          href="/"
          className="block text-sm text-blue-600 hover:underline mb-4"
        >
          ← Back to Home
        </Link>
        <h1 className="text-3xl font-bold text-center mb-6 text-gray-800">
          Create an Account
        </h1>
        {error && (
          <div className="bg-red-100 text-red-700 p-2 rounded mb-4 text-center">
            {error}
          </div>
        )}
        <form onSubmit={handleSignup} className="flex flex-col space-y-4">
          <input
            type="email"
            placeholder="Email"
            value={email}
            onChange={(e) => setEmail(e.target.value)}
            required
            className="w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400 transition"
          />
          <input
            type="password"
            placeholder="Password"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
            required
            className="w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400 transition"
          />
          <button
            type="submit"
            className="w-full bg-blue-600 text-white font-semibold py-2 rounded-lg hover:bg-blue-700 transition"
          >
            Sign Up
          </button>
        </form>
        <div className="flex items-center justify-between mt-6">
          <p className="text-sm text-gray-600">
            Already have an account?{' '}
            <Link
              href="/login"
              className="font-medium text-blue-600 hover:underline"
            >
              Sign in
            </Link>
          </p>
          <Link
            href="/admin/auth/login"
            className="text-sm font-medium text-blue-600 hover:underline"
          >
            Admin login
          </Link>
        </div>
      </div>
    </div>
  )
}

================
File: app/globals.css
================
/* app/globals.css */
@import 'tailwindcss/base';
@import 'tailwindcss/components';
@import 'tailwindcss/utilities';

================
File: app/layout.tsx
================
// app/layout.tsx
import './globals.css'
import { ReactNode } from 'react'
import { AuthProvider } from '@/contexts/AuthContext'
import { Metadata } from 'next'

export const metadata: Metadata = {
  title: 'CaribeFly',
  description: 'Book your flights with ease!',
  icons: {
    icon: [
      {
        url: '/favicon.ico',
        sizes: 'any',
      },
    ],
  },
}

export default function RootLayout({ children }: { children: ReactNode }) {
  return (
    <html lang="en">
      <body className="min-h-screen bg-gray-100">
        <AuthProvider>{children}</AuthProvider>
      </body>
    </html>
  )
}

================
File: app/page.tsx
================
// app/page.tsx
'use client'

import { useState, useEffect } from 'react'
import { useRouter } from 'next/navigation'
import { db } from '@/lib/firebaseConfig'
import { collection, getDocs } from 'firebase/firestore'
import FlightSearch from './components/FlightSearch'
import FlightTabContent from './components/flights/FlightTabContent'
import Header from './components/layout/Header'
import Footer from './components/layout/Footer'
import ServiceTabs from './components/services/ServiceTabs'
import type { Charter, Service, SearchParams } from '@/types/flight'
import type { FlightTab } from '@/types/dashboard'
import type { TabData } from '@/types/firebase'

export default function Home() {
  const router = useRouter()
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState<string | null>(null)
  const [services, setServices] = useState<Service[]>([])
  const [activeTab, setActiveTab] = useState<string>('flights')
  const [flightTabs, setFlightTabs] = useState<FlightTab[]>([])
  const [tabData, setTabData] = useState<TabData>({
    charters: [],
    promotions: [],
    announcements: [],
  })

  // Fetch initial data from Firestore
  useEffect(() => {
    const fetchData = async () => {
      try {
        setLoading(true)
        setError(null)

        // Fetch services and flight tabs
        const [
          servicesSnapshot,
          flightTabsSnapshot,
          chartersSnapshot,
          promotionsSnapshot,
          announcementsSnapshot,
        ] = await Promise.all([
          getDocs(collection(db, 'services')),
          getDocs(collection(db, 'flightTabs')),
          getDocs(collection(db, 'charters')),
          getDocs(collection(db, 'promotions')),
          getDocs(collection(db, 'announcements')),
        ])

        setServices(
          servicesSnapshot.docs.map((doc) => ({
            id: doc.id,
            ...doc.data(),
          })) as Service[]
        )

        setFlightTabs(
          flightTabsSnapshot.docs.map((doc) => ({
            id: doc.id,
            ...doc.data(),
          })) as FlightTab[]
        )

        setTabData({
          charters: chartersSnapshot.docs.map((doc) => ({
            id: doc.id,
            ...doc.data(),
          })),
          promotions: promotionsSnapshot.docs.map((doc) => ({
            id: doc.id,
            ...doc.data(),
          })),
          announcements: announcementsSnapshot.docs.map((doc) => ({
            id: doc.id,
            ...doc.data(),
          })),
        } as TabData)
      } catch (error) {
        console.error('Error fetching data:', error)
        setError('Failed to load data. Please try refreshing the page.')
      } finally {
        setLoading(false)
      }
    }

    fetchData()
  }, [])

  if (error) {
    return (
      <div
        className="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-500 to-purple-700"
        role="alert"
        aria-live="assertive"
      >
        <div className="bg-white p-6 rounded-lg shadow-lg max-w-md w-full mx-4">
          <h2 className="text-xl font-semibold text-red-600 mb-2">Error</h2>
          <p className="text-gray-700">{error}</p>
          <button
            onClick={() => window.location.reload()}
            className="mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"
            aria-label="Retry loading the page"
          >
            Retry
          </button>
        </div>
      </div>
    )
  }

  if (loading) {
    return (
      <div
        className="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-500 to-purple-700"
        role="status"
        aria-live="polite"
      >
        <div className="text-white text-xl">Loading...</div>
      </div>
    )
  }

  // Handle flight search
  const handleSearch = async (params: SearchParams) => {
    // Redirect to search results page with query parameters
    const searchParams = new URLSearchParams({
      origin: params.origin,
      destination: params.destination,
      date: params.departureDate.toISOString(),
      passengers: params.passengers.toString(),
      tripType: params.tripType,
    })

    router.push(`/search?${searchParams.toString()}`)
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-500 to-purple-700">
      <Header />

      {/* Hero section with search */}
      <main>
        <div className="relative bg-white shadow-lg rounded-b-3xl p-6 md:p-10 mt-4">
          <h1 className="text-3xl md:text-4xl font-bold text-center mb-6 text-gray-800">
            Your Gateway to Cuba - Flights, Hotels, Rentals & More
          </h1>
          <FlightSearch onSearch={handleSearch} />
        </div>

        {/* Services section */}
        <section
          className="container mx-auto mt-8 md:mt-10 px-4 md:px-0"
          aria-label="Services"
        >
          <ServiceTabs
            services={services}
            activeTab={activeTab}
            onTabChange={setActiveTab}
          />

          {/* Tab content */}
          {activeTab === 'flights' && (
            <div
              className="bg-gradient-to-br from-white to-blue-50 p-4 md:p-8 rounded-xl shadow-md"
              role="tabpanel"
              aria-labelledby="flights-tab"
            >
              {flightTabs.map((tab) => (
                <FlightTabContent key={tab.id} tab={tab} data={tabData} />
              ))}
            </div>
          )}
        </section>
      </main>

      <Footer />
    </div>
  )
}

================
File: backup-repo.git/hooks/applypatch-msg.sample
================
#!/bin/sh
#
# An example hook script to check the commit log message taken by
# applypatch from an e-mail message.
#
# The hook should exit with non-zero status after issuing an
# appropriate message if it wants to stop the commit.  The hook is
# allowed to edit the commit message file.
#
# To enable this hook, rename this file to "applypatch-msg".

. git-sh-setup
commitmsg="$(git rev-parse --git-path hooks/commit-msg)"
test -x "$commitmsg" && exec "$commitmsg" ${1+"$@"}
:

================
File: backup-repo.git/hooks/commit-msg.sample
================
#!/bin/sh
#
# An example hook script to check the commit log message.
# Called by "git commit" with one argument, the name of the file
# that has the commit message.  The hook should exit with non-zero
# status after issuing an appropriate message if it wants to stop the
# commit.  The hook is allowed to edit the commit message file.
#
# To enable this hook, rename this file to "commit-msg".

# Uncomment the below to add a Signed-off-by line to the message.
# Doing this in a hook is a bad idea in general, but the prepare-commit-msg
# hook is more suited to it.
#
# SOB=$(git var GIT_AUTHOR_IDENT | sed -n 's/^\(.*>\).*$/Signed-off-by: \1/p')
# grep -qs "^$SOB" "$1" || echo "$SOB" >> "$1"

# This example catches duplicate Signed-off-by lines.

test "" = "$(grep '^Signed-off-by: ' "$1" |
	 sort | uniq -c | sed -e '/^[ 	]*1[ 	]/d')" || {
	echo >&2 Duplicate Signed-off-by lines.
	exit 1
}

================
File: backup-repo.git/hooks/fsmonitor-watchman.sample
================
#!/usr/bin/perl

use strict;
use warnings;
use IPC::Open2;

# An example hook script to integrate Watchman
# (https://facebook.github.io/watchman/) with git to speed up detecting
# new and modified files.
#
# The hook is passed a version (currently 2) and last update token
# formatted as a string and outputs to stdout a new update token and
# all files that have been modified since the update token. Paths must
# be relative to the root of the working tree and separated by a single NUL.
#
# To enable this hook, rename this file to "query-watchman" and set
# 'git config core.fsmonitor .git/hooks/query-watchman'
#
my ($version, $last_update_token) = @ARGV;

# Uncomment for debugging
# print STDERR "$0 $version $last_update_token\n";

# Check the hook interface version
if ($version ne 2) {
	die "Unsupported query-fsmonitor hook version '$version'.\n" .
	    "Falling back to scanning...\n";
}

my $git_work_tree = get_working_dir();

my $retry = 1;

my $json_pkg;
eval {
	require JSON::XS;
	$json_pkg = "JSON::XS";
	1;
} or do {
	require JSON::PP;
	$json_pkg = "JSON::PP";
};

launch_watchman();

sub launch_watchman {
	my $o = watchman_query();
	if (is_work_tree_watched($o)) {
		output_result($o->{clock}, @{$o->{files}});
	}
}

sub output_result {
	my ($clockid, @files) = @_;

	# Uncomment for debugging watchman output
	# open (my $fh, ">", ".git/watchman-output.out");
	# binmode $fh, ":utf8";
	# print $fh "$clockid\n@files\n";
	# close $fh;

	binmode STDOUT, ":utf8";
	print $clockid;
	print "\0";
	local $, = "\0";
	print @files;
}

sub watchman_clock {
	my $response = qx/watchman clock "$git_work_tree"/;
	die "Failed to get clock id on '$git_work_tree'.\n" .
		"Falling back to scanning...\n" if $? != 0;

	return $json_pkg->new->utf8->decode($response);
}

sub watchman_query {
	my $pid = open2(\*CHLD_OUT, \*CHLD_IN, 'watchman -j --no-pretty')
	or die "open2() failed: $!\n" .
	"Falling back to scanning...\n";

	# In the query expression below we're asking for names of files that
	# changed since $last_update_token but not from the .git folder.
	#
	# To accomplish this, we're using the "since" generator to use the
	# recency index to select candidate nodes and "fields" to limit the
	# output to file names only. Then we're using the "expression" term to
	# further constrain the results.
	my $last_update_line = "";
	if (substr($last_update_token, 0, 1) eq "c") {
		$last_update_token = "\"$last_update_token\"";
		$last_update_line = qq[\n"since": $last_update_token,];
	}
	my $query = <<"	END";
		["query", "$git_work_tree", {$last_update_line
			"fields": ["name"],
			"expression": ["not", ["dirname", ".git"]]
		}]
	END

	# Uncomment for debugging the watchman query
	# open (my $fh, ">", ".git/watchman-query.json");
	# print $fh $query;
	# close $fh;

	print CHLD_IN $query;
	close CHLD_IN;
	my $response = do {local $/; <CHLD_OUT>};

	# Uncomment for debugging the watch response
	# open ($fh, ">", ".git/watchman-response.json");
	# print $fh $response;
	# close $fh;

	die "Watchman: command returned no output.\n" .
	"Falling back to scanning...\n" if $response eq "";
	die "Watchman: command returned invalid output: $response\n" .
	"Falling back to scanning...\n" unless $response =~ /^\{/;

	return $json_pkg->new->utf8->decode($response);
}

sub is_work_tree_watched {
	my ($output) = @_;
	my $error = $output->{error};
	if ($retry > 0 and $error and $error =~ m/unable to resolve root .* directory (.*) is not watched/) {
		$retry--;
		my $response = qx/watchman watch "$git_work_tree"/;
		die "Failed to make watchman watch '$git_work_tree'.\n" .
		    "Falling back to scanning...\n" if $? != 0;
		$output = $json_pkg->new->utf8->decode($response);
		$error = $output->{error};
		die "Watchman: $error.\n" .
		"Falling back to scanning...\n" if $error;

		# Uncomment for debugging watchman output
		# open (my $fh, ">", ".git/watchman-output.out");
		# close $fh;

		# Watchman will always return all files on the first query so
		# return the fast "everything is dirty" flag to git and do the
		# Watchman query just to get it over with now so we won't pay
		# the cost in git to look up each individual file.
		my $o = watchman_clock();
		$error = $output->{error};

		die "Watchman: $error.\n" .
		"Falling back to scanning...\n" if $error;

		output_result($o->{clock}, ("/"));
		$last_update_token = $o->{clock};

		eval { launch_watchman() };
		return 0;
	}

	die "Watchman: $error.\n" .
	"Falling back to scanning...\n" if $error;

	return 1;
}

sub get_working_dir {
	my $working_dir;
	if ($^O =~ 'msys' || $^O =~ 'cygwin') {
		$working_dir = Win32::GetCwd();
		$working_dir =~ tr/\\/\//;
	} else {
		require Cwd;
		$working_dir = Cwd::cwd();
	}

	return $working_dir;
}

================
File: backup-repo.git/hooks/post-update.sample
================
#!/bin/sh
#
# An example hook script to prepare a packed repository for use over
# dumb transports.
#
# To enable this hook, rename this file to "post-update".

exec git update-server-info

================
File: backup-repo.git/hooks/pre-applypatch.sample
================
#!/bin/sh
#
# An example hook script to verify what is about to be committed
# by applypatch from an e-mail message.
#
# The hook should exit with non-zero status after issuing an
# appropriate message if it wants to stop the commit.
#
# To enable this hook, rename this file to "pre-applypatch".

. git-sh-setup
precommit="$(git rev-parse --git-path hooks/pre-commit)"
test -x "$precommit" && exec "$precommit" ${1+"$@"}
:

================
File: backup-repo.git/hooks/pre-commit.sample
================
#!/bin/sh
#
# An example hook script to verify what is about to be committed.
# Called by "git commit" with no arguments.  The hook should
# exit with non-zero status after issuing an appropriate message if
# it wants to stop the commit.
#
# To enable this hook, rename this file to "pre-commit".

if git rev-parse --verify HEAD >/dev/null 2>&1
then
	against=HEAD
else
	# Initial commit: diff against an empty tree object
	against=$(git hash-object -t tree /dev/null)
fi

# If you want to allow non-ASCII filenames set this variable to true.
allownonascii=$(git config --type=bool hooks.allownonascii)

# Redirect output to stderr.
exec 1>&2

# Cross platform projects tend to avoid non-ASCII filenames; prevent
# them from being added to the repository. We exploit the fact that the
# printable range starts at the space character and ends with tilde.
if [ "$allownonascii" != "true" ] &&
	# Note that the use of brackets around a tr range is ok here, (it's
	# even required, for portability to Solaris 10's /usr/bin/tr), since
	# the square bracket bytes happen to fall in the designated range.
	test $(git diff --cached --name-only --diff-filter=A -z $against |
	  LC_ALL=C tr -d '[ -~]\0' | wc -c) != 0
then
	cat <<\EOF
Error: Attempt to add a non-ASCII file name.

This can cause problems if you want to work with people on other platforms.

To be portable it is advisable to rename the file.

If you know what you are doing you can disable this check using:

  git config hooks.allownonascii true
EOF
	exit 1
fi

# If there are whitespace errors, print the offending file names and fail.
exec git diff-index --check --cached $against --

================
File: backup-repo.git/hooks/pre-merge-commit.sample
================
#!/bin/sh
#
# An example hook script to verify what is about to be committed.
# Called by "git merge" with no arguments.  The hook should
# exit with non-zero status after issuing an appropriate message to
# stderr if it wants to stop the merge commit.
#
# To enable this hook, rename this file to "pre-merge-commit".

. git-sh-setup
test -x "$GIT_DIR/hooks/pre-commit" &&
        exec "$GIT_DIR/hooks/pre-commit"
:

================
File: backup-repo.git/hooks/pre-push.sample
================
#!/bin/sh

# An example hook script to verify what is about to be pushed.  Called by "git
# push" after it has checked the remote status, but before anything has been
# pushed.  If this script exits with a non-zero status nothing will be pushed.
#
# This hook is called with the following parameters:
#
# $1 -- Name of the remote to which the push is being done
# $2 -- URL to which the push is being done
#
# If pushing without using a named remote those arguments will be equal.
#
# Information about the commits which are being pushed is supplied as lines to
# the standard input in the form:
#
#   <local ref> <local oid> <remote ref> <remote oid>
#
# This sample shows how to prevent push of commits where the log message starts
# with "WIP" (work in progress).

remote="$1"
url="$2"

zero=$(git hash-object --stdin </dev/null | tr '[0-9a-f]' '0')

while read local_ref local_oid remote_ref remote_oid
do
	if test "$local_oid" = "$zero"
	then
		# Handle delete
		:
	else
		if test "$remote_oid" = "$zero"
		then
			# New branch, examine all commits
			range="$local_oid"
		else
			# Update to existing branch, examine new commits
			range="$remote_oid..$local_oid"
		fi

		# Check for WIP commit
		commit=$(git rev-list -n 1 --grep '^WIP' "$range")
		if test -n "$commit"
		then
			echo >&2 "Found WIP commit in $local_ref, not pushing"
			exit 1
		fi
	fi
done

exit 0

================
File: backup-repo.git/hooks/pre-rebase.sample
================
#!/bin/sh
#
# Copyright (c) 2006, 2008 Junio C Hamano
#
# The "pre-rebase" hook is run just before "git rebase" starts doing
# its job, and can prevent the command from running by exiting with
# non-zero status.
#
# The hook is called with the following parameters:
#
# $1 -- the upstream the series was forked from.
# $2 -- the branch being rebased (or empty when rebasing the current branch).
#
# This sample shows how to prevent topic branches that are already
# merged to 'next' branch from getting rebased, because allowing it
# would result in rebasing already published history.

publish=next
basebranch="$1"
if test "$#" = 2
then
	topic="refs/heads/$2"
else
	topic=`git symbolic-ref HEAD` ||
	exit 0 ;# we do not interrupt rebasing detached HEAD
fi

case "$topic" in
refs/heads/??/*)
	;;
*)
	exit 0 ;# we do not interrupt others.
	;;
esac

# Now we are dealing with a topic branch being rebased
# on top of master.  Is it OK to rebase it?

# Does the topic really exist?
git show-ref -q "$topic" || {
	echo >&2 "No such branch $topic"
	exit 1
}

# Is topic fully merged to master?
not_in_master=`git rev-list --pretty=oneline ^master "$topic"`
if test -z "$not_in_master"
then
	echo >&2 "$topic is fully merged to master; better remove it."
	exit 1 ;# we could allow it, but there is no point.
fi

# Is topic ever merged to next?  If so you should not be rebasing it.
only_next_1=`git rev-list ^master "^$topic" ${publish} | sort`
only_next_2=`git rev-list ^master           ${publish} | sort`
if test "$only_next_1" = "$only_next_2"
then
	not_in_topic=`git rev-list "^$topic" master`
	if test -z "$not_in_topic"
	then
		echo >&2 "$topic is already up to date with master"
		exit 1 ;# we could allow it, but there is no point.
	else
		exit 0
	fi
else
	not_in_next=`git rev-list --pretty=oneline ^${publish} "$topic"`
	/usr/bin/perl -e '
		my $topic = $ARGV[0];
		my $msg = "* $topic has commits already merged to public branch:\n";
		my (%not_in_next) = map {
			/^([0-9a-f]+) /;
			($1 => 1);
		} split(/\n/, $ARGV[1]);
		for my $elem (map {
				/^([0-9a-f]+) (.*)$/;
				[$1 => $2];
			} split(/\n/, $ARGV[2])) {
			if (!exists $not_in_next{$elem->[0]}) {
				if ($msg) {
					print STDERR $msg;
					undef $msg;
				}
				print STDERR " $elem->[1]\n";
			}
		}
	' "$topic" "$not_in_next" "$not_in_master"
	exit 1
fi

<<\DOC_END

This sample hook safeguards topic branches that have been
published from being rewound.

The workflow assumed here is:

 * Once a topic branch forks from "master", "master" is never
   merged into it again (either directly or indirectly).

 * Once a topic branch is fully cooked and merged into "master",
   it is deleted.  If you need to build on top of it to correct
   earlier mistakes, a new topic branch is created by forking at
   the tip of the "master".  This is not strictly necessary, but
   it makes it easier to keep your history simple.

 * Whenever you need to test or publish your changes to topic
   branches, merge them into "next" branch.

The script, being an example, hardcodes the publish branch name
to be "next", but it is trivial to make it configurable via
$GIT_DIR/config mechanism.

With this workflow, you would want to know:

(1) ... if a topic branch has ever been merged to "next".  Young
    topic branches can have stupid mistakes you would rather
    clean up before publishing, and things that have not been
    merged into other branches can be easily rebased without
    affecting other people.  But once it is published, you would
    not want to rewind it.

(2) ... if a topic branch has been fully merged to "master".
    Then you can delete it.  More importantly, you should not
    build on top of it -- other people may already want to
    change things related to the topic as patches against your
    "master", so if you need further changes, it is better to
    fork the topic (perhaps with the same name) afresh from the
    tip of "master".

Let's look at this example:

		   o---o---o---o---o---o---o---o---o---o "next"
		  /       /           /           /
		 /   a---a---b A     /           /
		/   /               /           /
	       /   /   c---c---c---c B         /
	      /   /   /             \         /
	     /   /   /   b---b C     \       /
	    /   /   /   /             \     /
    ---o---o---o---o---o---o---o---o---o---o---o "master"


A, B and C are topic branches.

 * A has one fix since it was merged up to "next".

 * B has finished.  It has been fully merged up to "master" and "next",
   and is ready to be deleted.

 * C has not merged to "next" at all.

We would want to allow C to be rebased, refuse A, and encourage
B to be deleted.

To compute (1):

	git rev-list ^master ^topic next
	git rev-list ^master        next

	if these match, topic has not merged in next at all.

To compute (2):

	git rev-list master..topic

	if this is empty, it is fully merged to "master".

DOC_END

================
File: backup-repo.git/hooks/pre-receive.sample
================
#!/bin/sh
#
# An example hook script to make use of push options.
# The example simply echoes all push options that start with 'echoback='
# and rejects all pushes when the "reject" push option is used.
#
# To enable this hook, rename this file to "pre-receive".

if test -n "$GIT_PUSH_OPTION_COUNT"
then
	i=0
	while test "$i" -lt "$GIT_PUSH_OPTION_COUNT"
	do
		eval "value=\$GIT_PUSH_OPTION_$i"
		case "$value" in
		echoback=*)
			echo "echo from the pre-receive-hook: ${value#*=}" >&2
			;;
		reject)
			exit 1
		esac
		i=$((i + 1))
	done
fi

================
File: backup-repo.git/hooks/prepare-commit-msg.sample
================
#!/bin/sh
#
# An example hook script to prepare the commit log message.
# Called by "git commit" with the name of the file that has the
# commit message, followed by the description of the commit
# message's source.  The hook's purpose is to edit the commit
# message file.  If the hook fails with a non-zero status,
# the commit is aborted.
#
# To enable this hook, rename this file to "prepare-commit-msg".

# This hook includes three examples. The first one removes the
# "# Please enter the commit message..." help message.
#
# The second includes the output of "git diff --name-status -r"
# into the message, just before the "git status" output.  It is
# commented because it doesn't cope with --amend or with squashed
# commits.
#
# The third example adds a Signed-off-by line to the message, that can
# still be edited.  This is rarely a good idea.

COMMIT_MSG_FILE=$1
COMMIT_SOURCE=$2
SHA1=$3

/usr/bin/perl -i.bak -ne 'print unless(m/^. Please enter the commit message/..m/^#$/)' "$COMMIT_MSG_FILE"

# case "$COMMIT_SOURCE,$SHA1" in
#  ,|template,)
#    /usr/bin/perl -i.bak -pe '
#       print "\n" . `git diff --cached --name-status -r`
# 	 if /^#/ && $first++ == 0' "$COMMIT_MSG_FILE" ;;
#  *) ;;
# esac

# SOB=$(git var GIT_COMMITTER_IDENT | sed -n 's/^\(.*>\).*$/Signed-off-by: \1/p')
# git interpret-trailers --in-place --trailer "$SOB" "$COMMIT_MSG_FILE"
# if test -z "$COMMIT_SOURCE"
# then
#   /usr/bin/perl -i.bak -pe 'print "\n" if !$first_line++' "$COMMIT_MSG_FILE"
# fi

================
File: backup-repo.git/hooks/push-to-checkout.sample
================
#!/bin/sh

# An example hook script to update a checked-out tree on a git push.
#
# This hook is invoked by git-receive-pack(1) when it reacts to git
# push and updates reference(s) in its repository, and when the push
# tries to update the branch that is currently checked out and the
# receive.denyCurrentBranch configuration variable is set to
# updateInstead.
#
# By default, such a push is refused if the working tree and the index
# of the remote repository has any difference from the currently
# checked out commit; when both the working tree and the index match
# the current commit, they are updated to match the newly pushed tip
# of the branch. This hook is to be used to override the default
# behaviour; however the code below reimplements the default behaviour
# as a starting point for convenient modification.
#
# The hook receives the commit with which the tip of the current
# branch is going to be updated:
commit=$1

# It can exit with a non-zero status to refuse the push (when it does
# so, it must not modify the index or the working tree).
die () {
	echo >&2 "$*"
	exit 1
}

# Or it can make any necessary changes to the working tree and to the
# index to bring them to the desired state when the tip of the current
# branch is updated to the new commit, and exit with a zero status.
#
# For example, the hook can simply run git read-tree -u -m HEAD "$1"
# in order to emulate git fetch that is run in the reverse direction
# with git push, as the two-tree form of git read-tree -u -m is
# essentially the same as git switch or git checkout that switches
# branches while keeping the local changes in the working tree that do
# not interfere with the difference between the branches.

# The below is a more-or-less exact translation to shell of the C code
# for the default behaviour for git's push-to-checkout hook defined in
# the push_to_deploy() function in builtin/receive-pack.c.
#
# Note that the hook will be executed from the repository directory,
# not from the working tree, so if you want to perform operations on
# the working tree, you will have to adapt your code accordingly, e.g.
# by adding "cd .." or using relative paths.

if ! git update-index -q --ignore-submodules --refresh
then
	die "Up-to-date check failed"
fi

if ! git diff-files --quiet --ignore-submodules --
then
	die "Working directory has unstaged changes"
fi

# This is a rough translation of:
#
#   head_has_history() ? "HEAD" : EMPTY_TREE_SHA1_HEX
if git cat-file -e HEAD 2>/dev/null
then
	head=HEAD
else
	head=$(git hash-object -t tree --stdin </dev/null)
fi

if ! git diff-index --quiet --cached --ignore-submodules $head --
then
	die "Working directory has staged changes"
fi

if ! git read-tree -u -m "$commit"
then
	die "Could not update working tree to new HEAD"
fi

================
File: backup-repo.git/hooks/update.sample
================
#!/bin/sh
#
# An example hook script to block unannotated tags from entering.
# Called by "git receive-pack" with arguments: refname sha1-old sha1-new
#
# To enable this hook, rename this file to "update".
#
# Config
# ------
# hooks.allowunannotated
#   This boolean sets whether unannotated tags will be allowed into the
#   repository.  By default they won't be.
# hooks.allowdeletetag
#   This boolean sets whether deleting tags will be allowed in the
#   repository.  By default they won't be.
# hooks.allowmodifytag
#   This boolean sets whether a tag may be modified after creation. By default
#   it won't be.
# hooks.allowdeletebranch
#   This boolean sets whether deleting branches will be allowed in the
#   repository.  By default they won't be.
# hooks.denycreatebranch
#   This boolean sets whether remotely creating branches will be denied
#   in the repository.  By default this is allowed.
#

# --- Command line
refname="$1"
oldrev="$2"
newrev="$3"

# --- Safety check
if [ -z "$GIT_DIR" ]; then
	echo "Don't run this script from the command line." >&2
	echo " (if you want, you could supply GIT_DIR then run" >&2
	echo "  $0 <ref> <oldrev> <newrev>)" >&2
	exit 1
fi

if [ -z "$refname" -o -z "$oldrev" -o -z "$newrev" ]; then
	echo "usage: $0 <ref> <oldrev> <newrev>" >&2
	exit 1
fi

# --- Config
allowunannotated=$(git config --type=bool hooks.allowunannotated)
allowdeletebranch=$(git config --type=bool hooks.allowdeletebranch)
denycreatebranch=$(git config --type=bool hooks.denycreatebranch)
allowdeletetag=$(git config --type=bool hooks.allowdeletetag)
allowmodifytag=$(git config --type=bool hooks.allowmodifytag)

# check for no description
projectdesc=$(sed -e '1q' "$GIT_DIR/description")
case "$projectdesc" in
"Unnamed repository"* | "")
	echo "*** Project description file hasn't been set" >&2
	exit 1
	;;
esac

# --- Check types
# if $newrev is 0000...0000, it's a commit to delete a ref.
zero=$(git hash-object --stdin </dev/null | tr '[0-9a-f]' '0')
if [ "$newrev" = "$zero" ]; then
	newrev_type=delete
else
	newrev_type=$(git cat-file -t $newrev)
fi

case "$refname","$newrev_type" in
	refs/tags/*,commit)
		# un-annotated tag
		short_refname=${refname##refs/tags/}
		if [ "$allowunannotated" != "true" ]; then
			echo "*** The un-annotated tag, $short_refname, is not allowed in this repository" >&2
			echo "*** Use 'git tag [ -a | -s ]' for tags you want to propagate." >&2
			exit 1
		fi
		;;
	refs/tags/*,delete)
		# delete tag
		if [ "$allowdeletetag" != "true" ]; then
			echo "*** Deleting a tag is not allowed in this repository" >&2
			exit 1
		fi
		;;
	refs/tags/*,tag)
		# annotated tag
		if [ "$allowmodifytag" != "true" ] && git rev-parse $refname > /dev/null 2>&1
		then
			echo "*** Tag '$refname' already exists." >&2
			echo "*** Modifying a tag is not allowed in this repository." >&2
			exit 1
		fi
		;;
	refs/heads/*,commit)
		# branch
		if [ "$oldrev" = "$zero" -a "$denycreatebranch" = "true" ]; then
			echo "*** Creating a branch is not allowed in this repository" >&2
			exit 1
		fi
		;;
	refs/heads/*,delete)
		# delete branch
		if [ "$allowdeletebranch" != "true" ]; then
			echo "*** Deleting a branch is not allowed in this repository" >&2
			exit 1
		fi
		;;
	refs/remotes/*,commit)
		# tracking branch
		;;
	refs/remotes/*,delete)
		# delete tracking branch
		if [ "$allowdeletebranch" != "true" ]; then
			echo "*** Deleting a tracking branch is not allowed in this repository" >&2
			exit 1
		fi
		;;
	*)
		# Anything else (is there anything else?)
		echo "*** Update hook: unknown type of update to ref $refname of type $newrev_type" >&2
		exit 1
		;;
esac

# --- Finished
exit 0

================
File: backup-repo.git/info/exclude
================
# git ls-files --others --exclude-from=.git/info/exclude
# Lines that start with '#' are comments.
# For a project mostly in C, the following would be a good set of
# exclude patterns (uncomment them if you want to use them):
# *.[oa]
# *~

================
File: backup-repo.git/config
================
[core]
	repositoryformatversion = 0
	filemode = true
	bare = true
	ignorecase = true
	precomposeunicode = true
[remote "origin"]
	url = https://github.com/LuisFaxas/caribefly-website
	fetch = +refs/*:refs/*
	mirror = true

================
File: backup-repo.git/description
================
Unnamed repository; edit this file 'description' to name the repository.

================
File: backup-repo.git/HEAD
================
ref: refs/heads/main

================
File: backup-repo.git/packed-refs
================
# pack-refs with: peeled fully-peeled sorted 
80c05ceeca626396d5f08b8a267dcec8be80a8b0 refs/heads/main

================
File: constants/defaults.ts
================
// src/constants/defaults.ts
import type { GlobalProfit } from '@/types'

export const initialGlobalProfit: GlobalProfit = {
  rt: 30,
  ow: 20,
}

export const DEFAULT_INFO: string[] = [
  'Impuestos de los USA incluidos',
  '• $27 impuestos de salida de Cuba',
  '• $35 Tasa Sanitaria',
  '• $9 Cargo por Reserva',
  '• $25 Recarga de Combustible',
  '(cobrado en aeropuerto)',
]

================
File: contexts/AuthContext.tsx
================
'use client'

import { createContext, useContext, useEffect, useState } from 'react'
import { User, onAuthStateChanged } from 'firebase/auth'
import { auth } from '@/lib/firebaseConfig'
import { useRouter } from 'next/navigation'
import { destroyCookie, setCookie } from 'nookies'

interface AuthContextType {
  user: User | null
  loading: boolean
  isAdmin: boolean
  signOut: () => Promise<void>
}

const AuthContext = createContext<AuthContextType>({
  user: null,
  loading: true,
  isAdmin: false,
  signOut: async () => {},
})

export function AuthProvider({ children }: { children: React.ReactNode }) {
  const [user, setUser] = useState<User | null>(null)
  const [loading, setLoading] = useState(true)
  const [isAdmin, setIsAdmin] = useState(false)
  const router = useRouter()

  useEffect(() => {
    const unsubscribe = onAuthStateChanged(auth, async (currentUser) => {
      if (currentUser) {
        const tokenResult = await currentUser.getIdTokenResult()
        const token = await currentUser.getIdToken()

        setIsAdmin(!!tokenResult.claims.admin)
        setUser(currentUser)

        setCookie(null, 'firebaseToken', token, {
          maxAge: 30 * 24 * 60 * 60,
          path: '/',
        })
      } else {
        setUser(null)
        setIsAdmin(false)
        destroyCookie(null, 'firebaseToken')
      }
      setLoading(false)
    })

    return () => unsubscribe()
  }, [])

  const signOut = async () => {
    try {
      await auth.signOut()
      destroyCookie(null, 'firebaseToken')
      router.push('/')
    } catch (error) {
      console.error('Sign out error:', error)
    }
  }

  return (
    <AuthContext.Provider value={{ user, loading, isAdmin, signOut }}>
      {children}
    </AuthContext.Provider>
  )
}

export const useAuth = () => useContext(AuthContext)

================
File: data/airportCodes.ts
================
// src/data/airportCodes.ts

export const airportNames: { [code: string]: string } = {
  MIA: 'Miami',
  HAV: 'La Habana',
  CMW: 'Camagüey',
  HOG: 'Holguín',
  SNU: 'Santa Clara',
  SCU: 'Santiago de Cuba',
  RSW: 'Fort Myers',
  TPA: 'Tampa',
}

export const airportCities: { [code: string]: string } = {
  MIA: 'Miami, FL',
  HAV: 'La Habana, Cuba',
  CMW: 'Camagüey, Cuba',
  HOG: 'Holguín, Cuba',
  SNU: 'Santa Clara, Cuba',
  SCU: 'Santiago de Cuba, Cuba',
  RSW: 'Fort Myers, FL',
  TPA: 'Tampa, FL',
}

export const cubanAirports = ['HAV', 'CMW', 'HOG', 'SNU', 'SCU']
export const floridaAirports = ['MIA', 'RSW', 'TPA']

================
File: data/charterData.ts
================
import type { CharterData } from '@/types/charter'
import { DEFAULT_INFO } from '@/constants/defaults'

export const initialCharterData: CharterData[] = [
  {
    name: 'Enjoy',
    destinations: [
      {
        destination: 'MIA-HAV',
        flightDays: ['Viernes y Sábado'],
        flightTimes: [
          { ida: '06:00', regreso: '09:30' },
          { ida: '18:00', regreso: '21:30' },
        ],
        periods: [
          {
            label: 'Marzo 1-15',
            rt: 349,
            ow: 269,
            profitOverride: {
              rt: 40,
              ow: 30,
            },
          },
          {
            label: 'Marzo 16-31',
            rt: 399,
            ow: 289,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.40/lb',
          'Maletas adicionales: $2.70/lb',
          'Cargo por chequeo: $26 por pieza',
        ],
        additionalInfo: DEFAULT_INFO,
      },
    ],
  },
  {
    name: 'Xael',
    destinations: [
      {
        destination: 'MIA-HAV',
        flightDays: ['Domingo a Jueves'],
        flightTimes: [
          { ida: '05:45', regreso: '08:00' },
          { ida: '19:30', regreso: '21:30' },
        ],
        periods: [
          {
            label: 'Marzo 1-15',
            rt: 299,
            ow: 229,
          },
          {
            label: 'Marzo 16-31',
            rt: 359,
            ow: 249,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.00/lb',
          'Maletas adicionales: $2.00/lb',
          'Cargo por chequeo: $25 por pieza',
        ],
        additionalInfo: DEFAULT_INFO,
      },
    ],
  },
  {
    name: 'Cubazul',
    destinations: [
      {
        destination: 'MIA-HAV',
        flightDays: ['Lunes a Viernes'],
        flightTimes: [
          { ida: '07:00', regreso: '10:30' },
          { ida: '16:00', regreso: '19:30' },
        ],
        periods: [
          {
            label: 'Marzo 1-15',
            rt: 329,
            ow: 249,
          },
          {
            label: 'Marzo 16-31',
            rt: 379,
            ow: 269,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.20/lb',
          'Maletas adicionales: $2.40/lb',
          'Cargo por chequeo: $25 por pieza',
        ],
        additionalInfo: DEFAULT_INFO,
      },
    ],
  },
  {
    name: 'Invicta',
    destinations: [
      {
        destination: 'MIA-HAV',
        flightDays: ['Martes y Jueves'],
        flightTimes: [
          { ida: '08:00', regreso: '11:30' },
          { ida: '17:00', regreso: '20:30' },
        ],
        periods: [
          {
            label: 'Marzo 1-15',
            rt: 339,
            ow: 259,
          },
          {
            label: 'Marzo 16-31',
            rt: 389,
            ow: 279,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.30/lb',
          'Maletas adicionales: $2.50/lb',
          'Cargo por chequeo: $25 por pieza',
        ],
        additionalInfo: DEFAULT_INFO,
      },
    ],
  },
  {
    name: 'Havana Air',
    destinations: [
      {
        destination: 'MIA-HAV',
        flightDays: ['Miércoles y Sábado'],
        flightTimes: [
          { ida: '09:00', regreso: '12:30' },
          { ida: '18:00', regreso: '21:30' },
        ],
        periods: [
          {
            label: 'Marzo 1-15',
            rt: 359,
            ow: 279,
          },
          {
            label: 'Marzo 16-31',
            rt: 409,
            ow: 299,
          },
        ],
        baggageInfo: [
          'Primeras dos maletas: $1.35/lb',
          'Maletas adicionales: $2.60/lb',
          'Cargo por chequeo: $26 por pieza',
        ],
        additionalInfo: DEFAULT_INFO,
      },
    ],
  },
]

================
File: functions/.eslintrc.js
================
module.exports = {
  env: {
    es6: true,
    node: true,
  },
  parserOptions: {
    ecmaVersion: 2018,
  },
  extends: [
    "eslint:recommended",
    "google",
    "plugin:prettier/recommended", // Integrates Prettier with ESLint
  ],
  plugins: ["prettier"], // Adds Prettier as a plugin
  rules: {
    "no-restricted-globals": ["error", "name", "length"],
    "prefer-arrow-callback": "error",
    quotes: ["error", "double", { allowTemplateLiterals: true }],
    "prettier/prettier": "error", // Shows Prettier errors as ESLint errors
  },
  overrides: [
    {
      files: ["**/*.spec.*"],
      env: {
        mocha: true,
      },
      rules: {},
    },
  ],
  globals: {},
}

================
File: functions/.gitignore
================
node_modules/
*.local

================
File: functions/.prettierrc
================
{
  "semi": false,
  "singleQuote": false,
  "tabWidth": 2,
  "trailingComma": "es5"
}

================
File: functions/index.js
================
// functions/index.js

const functions = require("firebase-functions")
const admin = require("firebase-admin")

// Initialize Firebase Admin SDK
admin.initializeApp()

// Cloud Function to set admin claim
exports.addAdminRole = functions.https.onCall(async (data, context) => {
  // Check if the request is coming from an authenticated admin
  if (!context.auth.token.admin) {
    return { error: "Only admins can add other admins" }
  }

  try {
    // Set the admin claim for the specified user UID
    await admin.auth().setCustomUserClaims(data.uid, { admin: true })
    return { message: `Admin claim set for user with UID: ${data.uid}` }
  } catch (error) {
    console.error("Error setting admin claim:", error)
    return { error: "Failed to set admin claim" }
  }
})

================
File: functions/package.json
================
{
  "name": "functions",
  "description": "Cloud Functions for Firebase",
  "scripts": {
    "lint": "eslint . --ext .js",
    "serve": "firebase emulators:start --only functions",
    "shell": "firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log",
    "format": "prettier --write ."
  },
  "engines": {
    "node": "18"
  },
  "main": "index.js",
  "dependencies": {
    "firebase-admin": "^12.6.0",
    "firebase-functions": "^6.0.1"
  },
  "devDependencies": {
    "eslint": "^8.15.0",
    "eslint-config-google": "^0.14.0",
    "firebase-functions-test": "^3.1.0"
  },
  "private": true
}

================
File: hooks/useAuth.ts
================
// app/hooks/useAuth.ts
import { useState, useEffect } from 'react'
import { onAuthStateChanged, User } from 'firebase/auth'
import { auth } from '../lib/firebaseConfig'

export function useAuth() {
  const [user, setUser] = useState<User | null | undefined>(undefined) // Add undefined for initial loading state

  useEffect(() => {
    const unsubscribe = onAuthStateChanged(auth, (currentUser) => {
      setUser(currentUser) // Set the user when state changes
    })
    return () => unsubscribe()
  }, [])

  return user
}

================
File: lib/config/xael-config.ts
================
export const XAEL_CONFIG = {
  credentials: {
    username: process.env.XAEL_USERNAME || '',
    password: process.env.XAEL_PASSWORD || '',
  },
  baseUrl: 'https://xaelsuite.com',
  endpoints: {
    login: '/login.aspx',
    newReservation: '/Reservations/NewReservation.aspx',
    flightSchedule: '/Reservations/FlightSchedule.aspx',
  },
  selectors: {
    loginForm: {
      username: '#txtUserName',
      password: '#txtPassword',
      submitButton: '#btnLogin',
    },
    searchForm: {
      origin: '#DropDownList_Origin',
      destination: '#DropDownList_Dest',
      date: '#DatePicker_Travel',
      searchButton: '#ButtonInquiry',
    },
    results: {
      flightGrid: '.flight-grid',
      flightRow: '.flight-grid tr',
      availabilityCell: 'td:nth-child(4)',
    },
  },
}

================
File: lib/services/sessionService.ts
================
import { auth } from '@/lib/firebaseConfig'
import { User } from 'firebase/auth'
import { setCookie, destroyCookie } from 'nookies'

export class SessionService {
  private static instance: SessionService

  private constructor() {}

  static getInstance(): SessionService {
    if (!SessionService.instance) {
      SessionService.instance = new SessionService()
    }
    return SessionService.instance
  }

  async createSession(user: User): Promise<void> {
    try {
      const token = await user.getIdToken()

      // Set session cookie
      setCookie(null, 'session', token, {
        maxAge: 30 * 24 * 60 * 60, // 30 days
        path: '/',
        secure: process.env.NODE_ENV === 'production',
        sameSite: 'strict',
      })
    } catch (error) {
      console.error('Error creating session:', error)
      throw error
    }
  }

  destroySession(): void {
    try {
      // Sign out from Firebase
      auth.signOut()

      // Remove session cookie
      destroyCookie(null, 'session', {
        path: '/',
      })
    } catch (error) {
      console.error('Error destroying session:', error)
      throw error
    }
  }

  async refreshSession(user: User): Promise<void> {
    await this.createSession(user)
  }
}

================
File: lib/services/xael-service.ts
================
import { Browser, Page } from 'puppeteer'
import puppeteer from 'puppeteer'
import { FlightAvailability, FlightSchedule, FlightPrice } from '@/types/flight'

interface XaelCredentials {
  username: string
  password: string
}

interface XaelFlightData {
  flightNumber: string
  departure: string
  arrival: string
  seatsAvailable: number
  price: {
    regular: number
    firstClass?: number
  }
}

export class XaelService {
  private browser: Browser | null = null
  private page: Page | null = null
  private isLoggedIn: boolean = false

  constructor(private credentials: XaelCredentials) {}

  private async initialize() {
    if (!this.browser) {
      this.browser = await puppeteer.launch({
        headless: true, // Set to false for debugging
      })
    }
  }

  private async handleModal() {
    if (!this.page) return

    try {
      // Wait for potential modal with a short timeout
      await this.page.waitForSelector('div[role="dialog"]', { timeout: 3000 })

      // If modal exists, try different potential close buttons
      const closeButtons = await this.page.$$(
        [
          'button[class*="close"]',
          'button[class*="modal-close"]',
          'button[aria-label="Close"]',
          '.modal-close-button',
          '.close-button',
        ].join(',')
      )

      if (closeButtons.length > 0) {
        await closeButtons[0].click()
        // Wait for modal to disappear
        await this.page.waitForSelector('div[role="dialog"]', {
          hidden: true,
          timeout: 3000,
        })
      }
    } catch (error) {
      // No modal found or timeout, continue normally
      console.log('No modal found or already closed')
    }
  }

  async login() {
    try {
      await this.initialize()
      if (!this.browser) throw new Error('Browser not initialized')

      this.page = await this.browser.newPage()

      // Navigate to XAEL login page
      await this.page.goto('https://xaelsuite.com/login.aspx')

      // Handle any initial modal
      await this.handleModal()

      // Fill login form
      await this.page.type('#txtUserName', this.credentials.username)
      await this.page.type('#txtPassword', this.credentials.password)
      await this.page.click('#btnLogin')

      // Wait for navigation
      await this.page.waitForNavigation()

      // Handle potential post-login modal
      await this.handleModal()

      // Check if login was successful
      const isLoggedIn = await this.page.evaluate(() => {
        return !document.querySelector('.login-error')
      })

      if (!isLoggedIn) {
        throw new Error('Login failed')
      }

      this.isLoggedIn = true
    } catch (error) {
      console.error('XAEL login error:', error)
      throw error
    }
  }

  async getAvailability(
    from: string,
    to: string,
    date: Date
  ): Promise<FlightAvailability[]> {
    try {
      if (!this.isLoggedIn) {
        await this.login()
      }

      if (!this.page) throw new Error('Page not initialized')

      // Navigate to flight search page
      await this.page.goto(
        'https://xaelsuite.com/Reservations/NewReservation.aspx'
      )

      // Handle any modal that might appear
      await this.handleModal()

      // Fill search form
      await this.page.select('#DropDownList_Origin', from)
      await this.page.select('#DropDownList_Dest', to)
      await this.page.type(
        '#DatePicker_Travel',
        date.toISOString().split('T')[0]
      )

      // Handle any modal that might appear before search
      await this.handleModal()

      await this.page.click('#ButtonInquiry')

      // Wait for results and extract data
      await this.page.waitForSelector('.flight-grid')

      // Handle any modal that might appear after search
      await this.handleModal()

      const flights = await this.page.evaluate(() => {
        const rows = document.querySelectorAll('.flight-grid tr')
        const flightData: XaelFlightData[] = []

        rows.forEach((row) => {
          const cells = row.querySelectorAll('td')
          if (cells.length >= 4) {
            flightData.push({
              flightNumber: cells[0].textContent?.trim() || '',
              departure: cells[1].textContent?.trim() || '',
              arrival: cells[2].textContent?.trim() || '',
              seatsAvailable: parseInt(cells[3].textContent?.trim() || '0', 10),
              price: {
                regular: parseFloat(
                  cells[4].textContent?.replace('$', '').trim() || '0'
                ),
                firstClass: cells[5]?.textContent
                  ? parseFloat(cells[5].textContent.replace('$', '').trim())
                  : undefined,
              },
            })
          }
        })

        return flightData
      })

      // Transform XAEL data to our format
      return flights.map((flight: XaelFlightData) => ({
        date: date.toISOString(),
        seatsTotal: 10,
        seatsAvailable: flight.seatsAvailable,
        status:
          flight.seatsAvailable > 3
            ? 'AVAILABLE'
            : flight.seatsAvailable > 0
              ? 'LIMITED'
              : 'SOLD_OUT',
        schedule: {
          flightNumber: flight.flightNumber,
          departure: flight.departure,
          arrival: flight.arrival,
        },
        pricing: {
          regular: {
            base: flight.price.regular,
            tax: flight.price.regular * 0.0725,
            total: flight.price.regular * 1.0725,
          },
          ...(flight.price.firstClass && {
            firstClass: {
              base: flight.price.firstClass,
              tax: flight.price.firstClass * 0.0725,
              total: flight.price.firstClass * 1.0725,
            },
          }),
        },
      }))
    } catch (error) {
      console.error('Error fetching XAEL availability:', error)
      throw error
    }
  }

  async cleanup() {
    if (this.browser) {
      await this.browser.close()
      this.browser = null
      this.page = null
      this.isLoggedIn = false
    }
  }
}

================
File: lib/firebase.ts
================
import { initializeApp, getApp, getApps } from 'firebase/app'
import { getFirestore } from 'firebase/firestore'
import { getAuth } from 'firebase/auth'
import { getStorage } from 'firebase/storage'

const firebaseConfig = {
  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,
  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,
  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,
  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,
  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,
  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,
  measurementId: process.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID,
}

// Initialize Firebase
const app = !getApps().length ? initializeApp(firebaseConfig) : getApp()
const db = getFirestore(app)
const auth = getAuth(app)
const storage = getStorage(app)

export { app, db, auth, storage }

================
File: lib/firebaseAdmin.ts
================
import * as admin from 'firebase-admin'

if (!admin.apps.length) {
  try {
    const privateKey = process.env.FIREBASE_ADMIN_PRIVATE_KEY?.replace(
      /\\n/g,
      '\n'
    )

    if (
      !privateKey ||
      !process.env.FIREBASE_ADMIN_PROJECT_ID ||
      !process.env.FIREBASE_ADMIN_CLIENT_EMAIL
    ) {
      throw new Error('Missing Firebase Admin configuration')
    }

    admin.initializeApp({
      credential: admin.credential.cert({
        projectId: process.env.FIREBASE_ADMIN_PROJECT_ID,
        clientEmail: process.env.FIREBASE_ADMIN_CLIENT_EMAIL,
        privateKey: privateKey,
      }),
    })
  } catch (error) {
    console.error('Firebase admin initialization error:', error)
  }
}

export const adminAuth = admin.auth()
export const adminDb = admin.firestore()

================
File: lib/firebaseConfig.ts
================
import { initializeApp, getApps } from 'firebase/app'
import { getAuth, setPersistence, browserLocalPersistence } from 'firebase/auth'
import { getFirestore } from 'firebase/firestore'

const firebaseConfig = {
  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,
  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,
  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,
  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,
  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,
  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,
}

// Initialize Firebase only if it hasn't been initialized
const app = !getApps().length ? initializeApp(firebaseConfig) : getApps()[0]
const auth = getAuth(app)
const db = getFirestore(app)

// Set authentication persistence
setPersistence(auth, browserLocalPersistence).catch((error) => {
  console.error('Firebase persistence error:', error)
})

export { auth, db }

================
File: lib/firestore-setup.ts
================
import { db } from './firebaseConfig'
import { collection, addDoc, setDoc, doc } from 'firebase/firestore'

// Initial data for services
const initialServices = [
  { id: 'flights', title: 'Flights', content: '' },
  {
    id: 'shipping',
    title: 'Shipping',
    content: 'Send packages to Cuba easily.',
  },
  {
    id: 'rentals',
    title: 'Car Rentals',
    content: 'Book the best rental cars.',
  },
  {
    id: 'hotels',
    title: 'Hotels',
    content: 'Find affordable hotels in Cuba.',
  },
  {
    id: 'tours',
    title: 'Tours',
    content: 'Discover exciting tour packages.',
  },
]

// Initial data for charters
const initialCharters = [
  {
    id: 'xael',
    title: 'XAEL Charters',
    flights: [
      { route: 'Miami - Havana (Mon-Thu)', price: '$289' },
      { route: 'Miami - Havana (Fri-Sat)', price: '$319' },
      { route: 'Miami - Camagüey (Fri)', price: '$339' },
      { route: 'One Way (OW): Miami - Cuba', price: '$219' },
    ],
  },
  { id: 'cubazul', title: 'Cubazul', flights: [] },
  { id: 'invicta', title: 'Invicta', flights: [] },
  { id: 'havanaair', title: 'HavanaAir', flights: [] },
  { id: 'enjoy', title: 'Enjoy', flights: [] },
]

// Function to initialize Firestore collections
export async function initializeFirestore() {
  try {
    // Initialize services collection
    for (const service of initialServices) {
      await setDoc(doc(db, 'services', service.id), {
        title: service.title,
        content: service.content,
      })
    }

    // Initialize charters collection
    for (const charter of initialCharters) {
      await setDoc(doc(db, 'charters', charter.id), {
        title: charter.title,
        flights: charter.flights,
      })
    }

    console.log('Firestore collections initialized successfully')
  } catch (error) {
    console.error('Error initializing Firestore:', error)
  }
}

================
File: lib/firestore-utils.ts
================
import { db } from './firebaseConfig'
import {
  collection,
  doc,
  getDoc,
  getDocs,
  setDoc,
  updateDoc,
  deleteDoc,
  query,
  where,
} from 'firebase/firestore'

// Types
export interface Service {
  id: string
  title: string
  content: string
}

export interface Flight {
  route: string
  price: string
}

export interface Charter {
  id: string
  title: string
  flights: Flight[]
}

// Service operations
export const serviceOperations = {
  async getAll(): Promise<Service[]> {
    const servicesSnapshot = await getDocs(collection(db, 'services'))
    return servicesSnapshot.docs.map(
      (doc) =>
        ({
          id: doc.id,
          ...doc.data(),
        }) as Service
    )
  },

  async getById(id: string): Promise<Service | null> {
    const serviceDoc = await getDoc(doc(db, 'services', id))
    return serviceDoc.exists()
      ? ({ id: serviceDoc.id, ...serviceDoc.data() } as Service)
      : null
  },

  async update(id: string, data: Partial<Service>): Promise<void> {
    await updateDoc(doc(db, 'services', id), data)
  },

  async create(service: Omit<Service, 'id'>): Promise<string> {
    const docRef = doc(collection(db, 'services'))
    await setDoc(docRef, service)
    return docRef.id
  },
}

// Charter operations
export const charterOperations = {
  async getAll(): Promise<Charter[]> {
    const chartersSnapshot = await getDocs(collection(db, 'charters'))
    return chartersSnapshot.docs.map(
      (doc) =>
        ({
          id: doc.id,
          ...doc.data(),
        }) as Charter
    )
  },

  async getById(id: string): Promise<Charter | null> {
    const charterDoc = await getDoc(doc(db, 'charters', id))
    return charterDoc.exists()
      ? ({ id: charterDoc.id, ...charterDoc.data() } as Charter)
      : null
  },

  async update(id: string, data: Partial<Charter>): Promise<void> {
    await updateDoc(doc(db, 'charters', id), data)
  },

  async updateFlights(id: string, flights: Flight[]): Promise<void> {
    await updateDoc(doc(db, 'charters', id), { flights })
  },
}

================
File: lib/flight-service.ts
================
import { db } from '@/lib/firebaseConfig'
import { collection, getDocs, query, where } from 'firebase/firestore'
import type { Charter, SearchParams, FlightAvailability } from '@/types/flight'

class FlightService {
  private cache: Map<string, FlightAvailability> = new Map()

  async searchFlights(params: SearchParams) {
    try {
      // Get all charters
      const chartersRef = collection(db, 'charters')
      const chartersSnap = await getDocs(chartersRef)
      const charters = chartersSnap.docs.map((doc) => ({
        id: doc.id,
        ...doc.data(),
      })) as Charter[]

      // For each charter, get availability
      const results = await Promise.all(
        charters.map(async (charter) => {
          const availability = await this.getCharterAvailability(
            charter,
            params
          )
          return {
            charter,
            availability,
          }
        })
      )

      return results
    } catch (error) {
      console.error('Error searching flights:', error)
      throw error
    }
  }

  private async getCharterAvailability(
    charter: Charter,
    params: SearchParams
  ): Promise<FlightAvailability | null> {
    // This will be replaced with actual charter system integration
    const cacheKey = `${charter.id}-${params.destination}-${params.departureDate}`

    if (this.cache.has(cacheKey)) {
      return this.cache.get(cacheKey)!
    }

    // Generate random flight number
    const flightNumber = `${charter.id.toUpperCase()}${Math.floor(
      Math.random() * 1000
    )
      .toString()
      .padStart(3, '0')}`

    // Generate random price
    const basePrice = Math.floor(Math.random() * (400 - 250) + 250)
    const tax = basePrice * 0.0725
    const total = basePrice + tax

    // For now, return dummy data that matches FlightAvailability type
    const availability: FlightAvailability = {
      date: params.departureDate.toISOString(),
      seatsTotal: 10,
      seatsAvailable: Math.floor(Math.random() * 10),
      status: 'AVAILABLE' as const,
      schedule: {
        flightNumber,
        departure: '08:00',
        arrival: '09:30',
      },
      pricing: {
        regular: {
          base: basePrice,
          tax,
          total,
        },
        firstClass: {
          base: basePrice * 1.5,
          tax: basePrice * 1.5 * 0.0725,
          total: basePrice * 1.5 * 1.0725,
        },
      },
    }

    // Update status based on seats available
    if (availability.seatsAvailable === 0) {
      availability.status = 'SOLD_OUT'
    } else if (availability.seatsAvailable <= 3) {
      availability.status = 'LIMITED'
    }

    this.cache.set(cacheKey, availability)
    return availability
  }

  // Add method to clear cache
  clearCache() {
    this.cache.clear()
  }

  // Add method to get cached data
  getCachedData() {
    return Array.from(this.cache.entries()).map(([key, value]) => ({
      key,
      value,
    }))
  }
}

export const flightService = new FlightService()

================
File: lib/utils.ts
================
import { clsx, type ClassValue } from 'clsx'
import { twMerge } from 'tailwind-merge'

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}

================
File: lib/verifyToken.js
================
// lib/verifyToken.js

import { adminAuth } from './firebaseAdmin'

export async function verifyIdToken(token) {
  try {
    const decodedToken = await adminAuth.verifyIdToken(token)
    return decodedToken
  } catch (error) {
    console.error('Error verifying token:', error)
    return null
  }
}

================
File: public/file.svg
================
<svg fill="none" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.5 13.5V5.41a1 1 0 0 0-.3-.7L9.8.29A1 1 0 0 0 9.08 0H1.5v13.5A2.5 2.5 0 0 0 4 16h8a2.5 2.5 0 0 0 2.5-2.5m-1.5 0v-7H8v-5H3v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1M9.5 5V2.12L12.38 5zM5.13 5h-.62v1.25h2.12V5zm-.62 3h7.12v1.25H4.5zm.62 3h-.62v1.25h7.12V11z" clip-rule="evenodd" fill="#666" fill-rule="evenodd"/></svg>

================
File: public/globe.svg
================
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><g clip-path="url(#a)"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.27 14.1a6.5 6.5 0 0 0 3.67-3.45q-1.24.21-2.7.34-.31 1.83-.97 3.1M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.48-1.52a7 7 0 0 1-.96 0H7.5a4 4 0 0 1-.84-1.32q-.38-.89-.63-2.08a40 40 0 0 0 3.92 0q-.25 1.2-.63 2.08a4 4 0 0 1-.84 1.31zm2.94-4.76q1.66-.15 2.95-.43a7 7 0 0 0 0-2.58q-1.3-.27-2.95-.43a18 18 0 0 1 0 3.44m-1.27-3.54a17 17 0 0 1 0 3.64 39 39 0 0 1-4.3 0 17 17 0 0 1 0-3.64 39 39 0 0 1 4.3 0m1.1-1.17q1.45.13 2.69.34a6.5 6.5 0 0 0-3.67-3.44q.65 1.26.98 3.1M8.48 1.5l.01.02q.41.37.84 1.31.38.89.63 2.08a40 40 0 0 0-3.92 0q.25-1.2.63-2.08a4 4 0 0 1 .85-1.32 7 7 0 0 1 .96 0m-2.75.4a6.5 6.5 0 0 0-3.67 3.44 29 29 0 0 1 2.7-.34q.31-1.83.97-3.1M4.58 6.28q-1.66.16-2.95.43a7 7 0 0 0 0 2.58q1.3.27 2.95.43a18 18 0 0 1 0-3.44m.17 4.71q-1.45-.12-2.69-.34a6.5 6.5 0 0 0 3.67 3.44q-.65-1.27-.98-3.1" fill="#666"/></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h16v16H0z"/></clipPath></defs></svg>

================
File: public/next.svg
================
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 394 80"><path fill="#000" d="M262 0h68.5v12.7h-27.2v66.6h-13.6V12.7H262V0ZM149 0v12.7H94v20.4h44.3v12.6H94v21h55v12.6H80.5V0h68.7zm34.3 0h-17.8l63.8 79.4h17.9l-32-39.7 32-39.6h-17.9l-23 28.6-23-28.6zm18.3 56.7-9-11-27.1 33.7h17.8l18.3-22.7z"/><path fill="#000" d="M81 79.3 17 0H0v79.3h13.6V17l50.2 62.3H81Zm252.6-.4c-1 0-1.8-.4-2.5-1s-1.1-1.6-1.1-2.6.3-1.8 1-2.5 1.6-1 2.6-1 1.8.3 2.5 1a3.4 3.4 0 0 1 .6 4.3 3.7 3.7 0 0 1-3 1.8zm23.2-33.5h6v23.3c0 2.1-.4 4-1.3 5.5a9.1 9.1 0 0 1-3.8 3.5c-1.6.8-3.5 1.3-5.7 1.3-2 0-3.7-.4-5.3-1s-2.8-1.8-3.7-3.2c-.9-1.3-1.4-3-1.4-5h6c.1.8.3 1.6.7 2.2s1 1.2 1.6 1.5c.7.4 1.5.5 2.4.5 1 0 1.8-.2 2.4-.6a4 4 0 0 0 1.6-1.8c.3-.8.5-1.8.5-3V45.5zm30.9 9.1a4.4 4.4 0 0 0-2-3.3 7.5 7.5 0 0 0-4.3-1.1c-1.3 0-2.4.2-3.3.5-.9.4-1.6 1-2 1.6a3.5 3.5 0 0 0-.3 4c.3.5.7.9 1.3 1.2l1.8 1 2 .5 3.2.8c1.3.3 2.5.7 3.7 1.2a13 13 0 0 1 3.2 1.8 8.1 8.1 0 0 1 3 6.5c0 2-.5 3.7-1.5 5.1a10 10 0 0 1-4.4 3.5c-1.8.8-4.1 1.2-6.8 1.2-2.6 0-4.9-.4-6.8-1.2-2-.8-3.4-2-4.5-3.5a10 10 0 0 1-1.7-5.6h6a5 5 0 0 0 3.5 4.6c1 .4 2.2.6 3.4.6 1.3 0 2.5-.2 3.5-.6 1-.4 1.8-1 2.4-1.7a4 4 0 0 0 .8-2.4c0-.9-.2-1.6-.7-2.2a11 11 0 0 0-2.1-1.4l-3.2-1-3.8-1c-2.8-.7-5-1.7-6.6-3.2a7.2 7.2 0 0 1-2.4-5.7 8 8 0 0 1 1.7-5 10 10 0 0 1 4.3-3.5c2-.8 4-1.2 6.4-1.2 2.3 0 4.4.4 6.2 1.2 1.8.8 3.2 2 4.3 3.4 1 1.4 1.5 3 1.5 5h-5.8z"/></svg>

================
File: public/vercel.svg
================
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1155 1000"><path d="m577.3 0 577.4 1000H0z" fill="#fff"/></svg>

================
File: public/window.svg
================
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.5 2.5h13v10a1 1 0 0 1-1 1h-11a1 1 0 0 1-1-1zM0 1h16v11.5a2.5 2.5 0 0 1-2.5 2.5h-11A2.5 2.5 0 0 1 0 12.5zm3.75 4.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5M7 4.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m1.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5" fill="#666"/></svg>

================
File: scripts/init-firestore.js
================
const { initializeApp } = require('firebase/app')
const { getFirestore, collection, doc, setDoc } = require('firebase/firestore')
require('dotenv').config({ path: '.env.local' })

// Firebase configuration
const firebaseConfig = {
  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,
  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,
  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,
  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,
  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,
  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,
}

// Initialize Firebase
const app = initializeApp(firebaseConfig)
const db = getFirestore(app)

// Initial data
const initialServices = [
  {
    id: 'flights',
    data: {
      title: 'Flights',
      content: '',
      createdAt: new Date().toISOString(),
    },
  },
  {
    id: 'shipping',
    data: {
      title: 'Shipping',
      content: 'Send packages to Cuba easily.',
      createdAt: new Date().toISOString(),
    },
  },
  {
    id: 'rentals',
    data: {
      title: 'Car Rentals',
      content: 'Book the best rental cars.',
      createdAt: new Date().toISOString(),
    },
  },
  {
    id: 'hotels',
    data: {
      title: 'Hotels',
      content: 'Find affordable hotels in Cuba.',
      createdAt: new Date().toISOString(),
    },
  },
  {
    id: 'tours',
    data: {
      title: 'Tours',
      content: 'Discover exciting tour packages.',
      createdAt: new Date().toISOString(),
    },
  },
]

const initialCharters = [
  {
    id: 'xael',
    data: {
      title: 'XAEL Charters',
      flights: [
        { route: 'Miami - Havana (Mon-Thu)', price: '$289' },
        { route: 'Miami - Havana (Fri-Sat)', price: '$319' },
        { route: 'Miami - Camagüey (Fri)', price: '$339' },
        { route: 'One Way (OW): Miami - Cuba', price: '$219' },
      ],
      createdAt: new Date().toISOString(),
    },
  },
  {
    id: 'cubazul',
    data: {
      title: 'Cubazul',
      flights: [],
      createdAt: new Date().toISOString(),
    },
  },
  {
    id: 'invicta',
    data: {
      title: 'Invicta',
      flights: [],
      createdAt: new Date().toISOString(),
    },
  },
  {
    id: 'havanaair',
    data: {
      title: 'HavanaAir',
      flights: [],
      createdAt: new Date().toISOString(),
    },
  },
  {
    id: 'enjoy',
    data: {
      title: 'Enjoy',
      flights: [],
      createdAt: new Date().toISOString(),
    },
  },
]

async function initializeFirestore() {
  try {
    console.log('Starting Firestore initialization...')

    // Initialize services collection
    console.log('Initializing services...')
    for (const service of initialServices) {
      try {
        await setDoc(doc(db, 'services', service.id), service.data)
        console.log(`✓ Service ${service.id} initialized successfully`)
      } catch (error) {
        console.error(`Error initializing service ${service.id}:`, error)
      }
    }

    // Initialize charters collection
    console.log('\nInitializing charters...')
    for (const charter of initialCharters) {
      try {
        await setDoc(doc(db, 'charters', charter.id), charter.data)
        console.log(`✓ Charter ${charter.id} initialized successfully`)
      } catch (error) {
        console.error(`Error initializing charter ${charter.id}:`, error)
      }
    }

    console.log('\n✓ Firestore collections initialized successfully')
    process.exit(0)
  } catch (error) {
    console.error('Error initializing Firestore:', error)
    process.exit(1)
  }
}

// Verify environment variables
const requiredEnvVars = [
  'NEXT_PUBLIC_FIREBASE_API_KEY',
  'NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN',
  'NEXT_PUBLIC_FIREBASE_PROJECT_ID',
  'NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET',
  'NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID',
  'NEXT_PUBLIC_FIREBASE_APP_ID',
]

const missingEnvVars = requiredEnvVars.filter(
  (varName) => !process.env[varName]
)

if (missingEnvVars.length > 0) {
  console.error('Missing required environment variables:', missingEnvVars)
  process.exit(1)
}

// Run initialization
console.log('Firebase Config:', firebaseConfig)
initializeFirestore()

================
File: scripts/init-firestore.ts
================
import { initializeFirestore } from '../lib/firestore-setup'

async function runInitialization() {
  try {
    await initializeFirestore()
    process.exit(0)
  } catch (error) {
    console.error('Initialization failed:', error)
    process.exit(1)
  }
}

runInitialization()

================
File: scripts/set-admin.ts
================
import { fileURLToPath } from 'url'
import { dirname, resolve } from 'path'
import { config } from 'dotenv'
import { cert, initializeApp } from 'firebase-admin/app'
import { getAuth } from 'firebase-admin/auth'

// Load environment variables from .env.local
const __filename = fileURLToPath(import.meta.url)
const __dirname = dirname(__filename)
config({ path: resolve(__dirname, '../.env.local') })

// Initialize Firebase Admin with service account
const serviceAccount = {
  projectId: process.env.FIREBASE_ADMIN_PROJECT_ID,
  clientEmail: process.env.FIREBASE_ADMIN_CLIENT_EMAIL,
  privateKey: process.env.FIREBASE_ADMIN_PRIVATE_KEY?.replace(/\\n/g, '\n'),
}

// Initialize the app
initializeApp({
  credential: cert(serviceAccount),
  projectId: serviceAccount.projectId,
})

async function setAdminClaim() {
  try {
    const userEmail = 'ventas@caribefly.com'
    const auth = getAuth()

    // Get the user by email
    const user = await auth.getUserByEmail(userEmail)

    // Set admin claim
    await auth.setCustomUserClaims(user.uid, { admin: true })

    console.log(`Successfully set admin claim for user: ${userEmail}`)
    process.exit(0)
  } catch (error) {
    console.error('Error setting admin claim:', error)
    process.exit(1)
  }
}

// Run the function
setAdminClaim()

================
File: types/admin.ts
================
// types/admin.ts
import type { Charter, Flight } from './flight'

export interface AdminCharter {
  id: string
  title: string
  flights: Flight[]
}

// Convert between admin and full charter types
export const toAdminCharter = (charter: Charter): AdminCharter => {
  return {
    id: charter.id,
    title: charter.title,
    flights: charter.flights || [],
  }
}

export const toFullCharter = (adminCharter: AdminCharter): Charter => {
  return {
    id: adminCharter.id,
    title: adminCharter.title,
    system: 'custom',
    flights: adminCharter.flights,
    // These are optional in the Charter interface, so we can omit them
    routes: [],
    pricing: {},
  }
}

================
File: types/charter.ts
================
// src/types/index.ts

/**
 * Flight time information for a specific route
 * @property ida - Departure time in 24-hour format (HH:mm)
 * @property regreso - Return time in 24-hour format (HH:mm)
 */
export interface FlightTime {
  ida: string
  regreso: string
}

/**
 * Period-specific pricing and information
 * @property label - Period description (e.g., "March 1-15", "Holiday Season")
 * @property rt - Round trip base price in USD
 * @property ow - One way base price in USD
 * @property profitOverride - Optional profit overrides for this period
 */
export interface PeriodData {
  label: string
  rt?: number
  ow?: number
  profitOverride?: {
    rt?: number
    ow?: number
  }
}

/**
 * Destination-specific information and pricing
 * @property destination - Airport code (e.g., "MIA-HAV")
 * @property flightDays - Days of the week flights operate
 * @property flightTimes - Departure and return times
 * @property periods - Pricing periods
 * @property baggageInfo - Baggage allowance information
 * @property additionalInfo - Additional flight information
 */
export interface DestinationData {
  destination: string
  flightDays: string[]
  flightTimes: FlightTime[]
  periods: PeriodData[]
  baggageInfo: string[]
  additionalInfo: string[]
}

/**
 * Charter company information and routes
 * @property name - Charter company name
 * @property destinations - Available destinations and their details
 */
export interface CharterData {
  name: string
  destinations: DestinationData[]
}

/**
 * Global profit settings
 * @property rt - Default round trip profit margin in USD
 * @property ow - Default one way profit margin in USD
 */
export interface GlobalProfit {
  rt: number
  ow: number
}

/**
 * Editor storage data
 * @property charters - List of charter companies and their data
 * @property globalProfit - Default profit margins
 * @property agencyLogo - Base64 encoded agency logo
 * @property promotionalImage - Base64 encoded promotional image
 * @property lastUpdated - ISO date string of last update
 * @property selectedDestination - Currently selected destination
 * @property selectedCharterIndex - Index of selected charter
 */
export interface StorageData {
  charters: CharterData[]
  globalProfit: GlobalProfit
  agencyLogo?: string
  promotionalImage?: string
  lastUpdated: string
  selectedDestination: string
  selectedCharterIndex: number
}

/**
 * Toast notification type
 */
export type NotificationType = 'success' | 'error' | 'warning'

/**
 * Notification data
 * @property type - Type of notification
 * @property message - Notification message
 */
export interface NotificationData {
  type: NotificationType
  message: string
}

/**
 * Price display configuration
 * @property showBase - Show base price
 * @property showOverride - Show override price
 */
export interface PriceDisplayConfig {
  showBase?: boolean
  showOverride?: boolean
}

/**
 * Chart configuration
 * @property charters - List of charters to display
 * @property globalProfit - Global profit settings
 * @property additionalInfo - Additional information to display
 */
export interface ChartConfig {
  charters: CharterData[]
  globalProfit: GlobalProfit
  additionalInfo: string[]
}

/**
 * Editor state interface
 * @property selectedDestination - Currently selected destination
 * @property selectedCharterIndex - Index of selected charter
 * @property currentDestinationData - Currently selected destination data
 * @property isEditing - Whether editor is in edit mode
 */
export interface EditorState {
  selectedDestination: string
  selectedCharterIndex: number
  currentDestinationData?: DestinationData
  isEditing: boolean
}

/**
 * File upload configuration
 * @property accept - Accepted file types
 * @property maxSize - Maximum file size in bytes
 * @property aspectRatio - Required aspect ratio for images
 */
export interface FileUploadConfig {
  accept: string
  maxSize: number
  aspectRatio?: number
}

================
File: types/dashboard.ts
================
export interface DashboardMetrics {
  bookings: number
  revenue: number
  visitors: number
}

export interface DashboardData {
  totalFlights: number
  activePromotions: number
  activeAnnouncements: number
  recentBookings: number
  metrics: {
    daily: DashboardMetrics
    weekly: DashboardMetrics
    monthly: DashboardMetrics
  }
}

export interface Announcement {
  id: string
  title: string
  content: string
  type: 'info' | 'warning' | 'alert'
  priority: 'high' | 'normal' | 'low'
  validFrom: Date
  validUntil: Date
  active: boolean
  order: number // Added this field
}

export interface Promotion {
  id: string
  title: string
  imageUrl: string
  description: string
  validFrom: Date
  validUntil: Date
  active: boolean
  order: number
  charter?: string
  type: 'standard' | 'featured' | 'banner'
}

export interface WidgetSettings {
  autoUpdate?: boolean
  refreshInterval?: number
  displayLimit?: number
  layout?: 'grid' | 'list' | 'carousel'
  sources?: Record<string, boolean>
  style?: string
  position?: string
  showIcon?: boolean
  dismissible?: boolean
  persistent?: boolean
}

export interface Widget {
  id: string
  type: 'priceChart' | 'promotionImage' | 'announcement' | 'info'
  title: string
  content: any
  settings?: WidgetSettings
  order: number
}

export interface FlightTab {
  id: string
  title: string
  description?: string
  order: number
  widgets: Widget[]
  active: boolean
}

interface SubTab {
  id: string
  title: string
  order: number
  widgets: Widget[]
}

interface TabSection {
  id: string
  title: string
  subTabs: SubTab[]
}

// Price chart specific types
interface ChartPrice {
  charter: string
  route: string
  price: number
  lastUpdated: Date
  source: 'manual' | 'automated'
}

interface PriceChartWidget extends Widget {
  type: 'priceChart'
  content: {
    prices: ChartPrice[]
    updateFrequency: number // in minutes
  }
}

interface PromotionWidget extends Widget {
  type: 'promotionImage'
  content: {
    imageUrl: string
    link?: string
    validUntil?: Date
  }
}

interface AdminCharter {
  id: string
  title: string
  flights: Flight[]
}

interface Flight {
  route: string
  price: string
}

================
File: types/firebase.ts
================
import { Timestamp } from 'firebase/firestore'

export interface TabData {
  charters: Charter[]
  promotions: Promotion[]
  announcements: Announcement[]
}

export interface Charter {
  id: string
  title: string
  description: string
  price: number
  origin: string
  destination: string
  departureDate: Timestamp
  returnDate?: Timestamp
  availableSeats: number
  imageUrl?: string
  status: 'active' | 'cancelled' | 'completed'
}

export interface Promotion {
  id: string
  title: string
  description: string
  startDate: Timestamp
  endDate: Timestamp
  discountPercentage: number
  imageUrl?: string
  status: 'active' | 'expired' | 'upcoming'
}

export interface Announcement {
  id: string
  title: string
  content: string
  publishDate: Timestamp
  expiryDate?: Timestamp
  priority: 'high' | 'medium' | 'low'
  status: 'active' | 'archived'
}

================
File: types/flight.ts
================
export interface FlightRoute {
  from: {
    code: string
    city: string
  }
  to: {
    code: string
    city: string
  }
}

export interface Service {
  id: string
  title: string
  content: string
}

export interface FlightSchedule {
  flightNumber: string
  departure: string
  arrival: string
  daysOfOperation: string[]
}

export interface FlightPrice {
  regular: {
    base: number
    tax: number
    total: number
  }
  firstClass?: {
    base: number
    tax: number
    total: number
  }
}

export interface FlightAvailability {
  date: string
  seatsTotal: number
  seatsAvailable: number
  status: 'AVAILABLE' | 'LIMITED' | 'SOLD_OUT'
  schedule: {
    flightNumber: string
    departure: string
    arrival: string
  }
  pricing: {
    regular: {
      base: number
      tax: number
      total: number
    }
    firstClass?: {
      base: number
      tax: number
      total: number
    }
  }
}

export interface Charter {
  id: string
  title: string
  flights: Flight[]
  system?: string
  routes?: Array<{
    from: {
      code: string
      city: string
    }
    to: {
      code: string
      city: string
    }
  }>
  pricing?: Record<
    string,
    {
      regular: {
        base: number
        tax: number
        total: number
      }
      firstClass?: {
        base: number
        tax: number
        total: number
      }
    }
  >
}

export interface Flight {
  route: string
  price: string
}

export interface SearchParams {
  origin: string
  destination: string
  departureDate: Date
  returnDate?: Date
  passengers: number
  tripType: 'oneway' | 'roundtrip'
}

export interface FilterOptions {
  charter?: string
  maxPrice?: number
  departureTime?: 'morning' | 'afternoon' | 'evening'
  availabilityStatus?: 'AVAILABLE' | 'LIMITED' | 'SOLD_OUT'
}

export type SortOption = 'price' | 'departure' | 'availability' | 'charter'
export type SortDirection = 'asc' | 'desc'

================
File: types/index.ts
================
export * from './admin'
export * from './charter'
export * from './common'
export * from './dashboard'
export * from './flight'

================
File: .eslintrc.json
================
{
  "extends": ["next/core-web-vitals", "prettier"],
  "plugins": ["prettier"],
  "rules": {
    "prettier/prettier": "error"
  }
}

================
File: .firebaserc
================
{
  "projects": {
    "default": "caribefly-5148a"
  }
}

================
File: .gitignore
================
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/versions

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# env files (can opt-in for commiting if needed)
.env*

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts
caribefly-5148a-firebase-adminsdk-*.json

================
File: .prettierrc
================
{
  "semi": false,
  "singleQuote": true,
  "printWidth": 80,
  "tabWidth": 2,
  "trailingComma": "es5"
}

================
File: commands.txt
================
npx prettier --write .

================
File: firebase.json
================
{
  "functions": [
    {
      "source": "functions",
      "codebase": "default",
      "ignore": [
        "node_modules",
        ".git",
        "firebase-debug.log",
        "firebase-debug.*.log",
        "*.local"
      ],
      "predeploy": ["npm --prefix \"$RESOURCE_DIR\" run lint"]
    }
  ]
}

================
File: firestore.rules
================
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /{document=**} {
      allow read, write: if true;  // Warning: This is for development only. Update with proper rules for production.
    }
  }
}

================
File: middleware.ts
================
import { NextResponse } from 'next/server'
import type { NextRequest } from 'next/server'

// Define protected routes
const routes = {
  admin: ['/admin/dashboard', '/admin/charter-editor'],
  auth: ['/admin/auth/login'],
  public: ['/'],
}

export async function middleware(request: NextRequest) {
  const session = request.cookies.get('firebaseToken')?.value
  const path = request.nextUrl.pathname

  // Check route type
  const isAdminRoute = routes.admin.some((route) => path.startsWith(route))
  const isAuthRoute = routes.auth.some((route) => path.startsWith(route))

  // If no session and trying to access admin route
  if (!session && isAdminRoute) {
    return NextResponse.redirect(new URL('/admin/auth/login', request.url))
  }

  // If has session and trying to access auth routes
  if (session && isAuthRoute) {
    return NextResponse.redirect(new URL('/admin/dashboard', request.url))
  }

  return NextResponse.next()
}

export const config = {
  matcher: ['/admin/:path*'],
}

================
File: next.config.js
================
/** @type {import('next').NextConfig} */
const nextConfig = {
  reactStrictMode: true,
}

export default nextConfig

================
File: next.config.ts
================
import type { NextConfig } from 'next'

const nextConfig: NextConfig = {
  /* config options here */
}

export default nextConfig

================
File: package.json
================
{
  "name": "caribefly",
  "version": "0.1.0",
  "private": true,
  "type": "module",
  "scripts": {
    "dev": "next dev --turbopack",
    "build": "next build",
    "start": "next start",
    "init-db": "ts-node scripts/init-firestore.js",
    "set-admin": "node --loader ts-node/esm scripts/set-admin.ts",
    "lint": "next lint"
  },
  "dependencies": {
    "@firebase/firestore": "^4.7.4",
    "axios": "^1.7.7",
    "date-fns": "^4.1.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "html-to-image": "^1.11.11",
    "next": "15.0.2",
    "nookies": "^2.5.2",
    "puppeteer": "^23.7.0",
    "react": "19.0.0-rc-02c0e824-20241028",
    "react-dom": "19.0.0-rc-02c0e824-20241028",
    "react-icons": "^5.3.0",
    "recharts": "^2.13.3"
  },
  "devDependencies": {
    "@types/node": "^20.17.6",
    "@types/puppeteer": "^5.4.7",
    "@types/react": "^18",
    "@types/react-dom": "^18",
    "@typescript-eslint/eslint-plugin": "^8.12.2",
    "@typescript-eslint/parser": "^8.12.2",
    "autoprefixer": "^10.4.20",
    "dotenv": "^16.4.5",
    "eslint": "^8.57.1",
    "eslint-config-next": "15.0.2",
    "eslint-config-prettier": "^9.1.0",
    "eslint-plugin-import": "^2.31.0",
    "eslint-plugin-prettier": "^5.2.1",
    "postcss": "^8.4.47",
    "prettier": "^3.3.3",
    "tailwindcss": "^3.4.14",
    "tailwindcss-animate": "^1.0.7",
    "ts-node": "^10.9.2",
    "typescript": "^5.6.3"
  }
}

================
File: postcss.config.js
================
// postcss.config.js
export default {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}

================
File: postcss.config.mjs
================
/** @type {import('postcss-load-config').Config} */
const config = {
  plugins: {
    tailwindcss: {},
  },
}

export default config

================
File: README.md
================
This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).

## Getting Started

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.

================
File: setCustomClaims.js
================
//setCustomClaims.js
const admin = require('firebase-admin')
const serviceAccount = require('./caribefly-5148a-firebase-adminsdk-75ry4-1c1090f554.json') // Update the path

// Initialize the Firebase Admin SDK
admin.initializeApp({
  credential: admin.credential.cert(serviceAccount),
})

async function setAdminRole(uid) {
  try {
    // Set the 'admin' custom claim for the user with the given UID
    await admin.auth().setCustomUserClaims(uid, { admin: true })
    console.log(`Successfully set admin claim for user with UID: ${uid}`)
  } catch (error) {
    console.error('Error setting custom claims:', error)
  }
}

// Run the function with the UID of the user you want to set as an admin
// Replace 'USER_UID' with the actual Firebase UID of the user
setAdminRole('soEdBAe29nP1y0a4Sf1yBeMLn573')

================
File: tailwind.config.js
================
/** @type {import('tailwindcss').Config} */
export default {
  darkMode: ['class'],
  content: [
    './app/**/*.{js,ts,jsx,tsx}',
    './components/**/*.{js,ts,jsx,tsx}',
    './app/admin/charter-editor/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    extend: {
      colors: {
        background: 'hsl(var(--background))',
        foreground: 'hsl(var(--foreground))',
        card: {
          DEFAULT: 'hsl(var(--card))',
          foreground: 'hsl(var(--card-foreground))',
        },
        popover: {
          DEFAULT: 'hsl(var(--popover))',
          foreground: 'hsl(var(--popover-foreground))',
        },
        primary: {
          DEFAULT: 'hsl(var(--primary))',
          foreground: 'hsl(var(--primary-foreground))',
        },
        secondary: {
          DEFAULT: 'hsl(var(--secondary))',
          foreground: 'hsl(var(--secondary-foreground))',
        },
        muted: {
          DEFAULT: 'hsl(var(--muted))',
          foreground: 'hsl(var(--muted-foreground))',
        },
        accent: {
          DEFAULT: 'hsl(var(--accent))',
          foreground: 'hsl(var(--accent-foreground))',
        },
        destructive: {
          DEFAULT: 'hsl(var(--destructive))',
          foreground: 'hsl(var(--destructive-foreground))',
        },
        border: 'hsl(var(--border))',
        input: 'hsl(var(--input))',
        ring: 'hsl(var(--ring))',
        chart: {
          1: 'hsl(var(--chart-1))',
          2: 'hsl(var(--chart-2))',
          3: 'hsl(var(--chart-3))',
          4: 'hsl(var(--chart-4))',
          5: 'hsl(var(--chart-5))',
        },
      },
      borderRadius: {
        lg: 'var(--radius)',
        md: 'calc(var(--radius) - 2px)',
        sm: 'calc(var(--radius) - 4px)',
      },
    },
  },
  plugins: [require('tailwindcss-animate')],
}

================
File: tailwind.config.ts
================
import type { Config } from 'tailwindcss'

const config: Config = {
  content: [
    './pages/**/*.{js,ts,jsx,tsx,mdx}',
    './components/**/*.{js,ts,jsx,tsx,mdx}',
    './app/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    extend: {
      colors: {
        background: 'var(--background)',
        foreground: 'var(--foreground)',
      },
    },
  },
  plugins: [],
}
export default config

================
File: tsconfig.json
================
{
  "compilerOptions": {
    "target": "es5",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "forceConsistentCasingInFileNames": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "node",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}
